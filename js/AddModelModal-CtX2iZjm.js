var j=Object.defineProperty;var x=Object.getOwnPropertySymbols;var z=Object.prototype.hasOwnProperty,G=Object.prototype.propertyIsEnumerable;var U=(m,p,s)=>p in m?j(m,p,{enumerable:!0,configurable:!0,writable:!0,value:s}):m[p]=s,F=(m,p)=>{for(var s in p||(p={}))z.call(p,s)&&U(m,s,p[s]);if(x)for(var s of x(p))G.call(p,s)&&U(m,s,p[s]);return m};var O=(m,p,s)=>new Promise((h,y)=>{var M=u=>{try{f(s.next(u))}catch(t){y(t)}},c=u=>{try{f(s.throw(u))}catch(t){y(t)}},f=u=>u.done?h(u.value):Promise.resolve(u.value).then(M,c);f((s=s.apply(m,p)).next())});import{$ as r,bQ as C,M as $,R as V,_ as J}from"./bootstrap-Bf65uz2I.js";import"./css-gf8D6QlL.js";import{E as Q}from"./el-dialog-CAR1-R4U.js";import"./el-overlay-Zuw8glOl.js";/* empty css                */import{E as H,a as g}from"./el-form-item-8FQp7Cs4.js";import"./css-C9o_OfXA.js";/* empty css               */import{g as W,r as X,s as Y,h as Z,a as ee}from"./model-ability-utils-DYGAejac.js";import{ElInput as b}from"./index-BjDsryRX.js";import{E as le}from"./index-DGdiZ7pE.js";import{ElButton as A}from"./index-oBOAcXl-.js";import{k as ae,r as v,w as oe,G as te,B as _,n as N,E as d,J as i,u as l,p as re,I as D,q as se,m as ie,F as de,N as pe,s as ue,L as I,y as E}from"../jse/index-index-D3Xb8oT_.js";import"./index-B3qAv2kq.js";import"./aria-DEUWDJ1E.js";import"./refs-D6FW0B1r.js";import"./event-BB_Ol6Sd.js";import"./index-Bxb6QITi.js";import"./index-Dg3fRnQE.js";import"./vnode-DysYOGZN.js";import"./scroll-C2492Iw_.js";import"./use-form-common-props-IzjzSHax.js";import"./castArray-BBset58W.js";import"./_baseClone-trfKWgGN.js";import"./index-bT9OJj6t.js";import"./_overRest-Bb9G3v08.js";import"./index-C33Sf0pH.js";import"./use-form-item-DVWmmqeW.js";import"./index-m1ZP1zbM.js";const me={class:"model-ability"},ne=ae({__name:"AddModelModal",props:{providerId:{type:String,default:""}},emits:["reload"],setup(m,{expose:p,emit:s}){var B;const h=m,y=s,M=v((B=h.providerId)!=null?B:"");oe(()=>h.providerId,a=>{a&&(M.value=a)},{immediate:!0});const c=v(),f=v(!0),u=v(!1),t=te({modelType:"",title:"",modelName:"",groupName:"",providerId:"",provider:"",apiKey:"",endpoint:"",requestPath:"",supportThinking:!1,supportTool:!1,supportImage:!1,supportAudio:!1,supportFree:!1,supportVideo:!1,supportImageB64Only:!1,supportToolMessage:!1,options:{llmEndpoint:"",chatPath:"",embedPath:"",rerankPath:""}}),k=v(W()),w=()=>{Y(k.value,t)},K=a=>{Z(a,t)};p({openAddDialog(a){f.value=!0,c.value&&c.value.resetFields(),Object.assign(t,{id:"",modelType:a,title:"",modelName:"",groupName:"",provider:"",endPoint:"",providerId:"",supportThinking:!1,supportTool:!1,supportAudio:!1,supportVideo:!1,supportImage:!1,supportImageB64Only:!1,supportFree:!1,supportToolMessage:!0,options:{llmEndpoint:"",chatPath:"",embedPath:"",rerankPath:""}}),n.value=!1,X(k.value),w(),u.value=!0},openEditDialog(a){var o,e,q,S;u.value=!0,f.value=!1,Object.assign(t,{id:a.id,modelType:a.modelType||"",title:a.title||"",modelName:a.modelName||"",groupName:a.groupName||"",provider:a.provider||"",endpoint:a.endpoint||"",requestPath:a.requestPath||"",supportThinking:a.supportThinking||!1,supportAudio:a.supportAudio||!1,supportImage:a.supportImage||!1,supportImageB64Only:a.supportImageB64Only||!1,supportVideo:a.supportVideo||!1,supportTool:a.supportTool||!1,supportFree:a.supportFree||!1,supportToolMessage:a.supportToolMessage||!1,options:{llmEndpoint:((o=a.options)==null?void 0:o.llmEndpoint)||"",chatPath:((e=a.options)==null?void 0:e.chatPath)||"",embedPath:((q=a.options)==null?void 0:q.embedPath)||"",rerankPath:((S=a.options)==null?void 0:S.rerankPath)||""}}),n.value=!1,w()}});const P=()=>{u.value=!1},L={title:[{required:!0,message:r("message.required"),trigger:"blur"}],modelName:[{required:!0,message:r("message.required"),trigger:"blur"}],groupName:[{required:!0,message:r("message.required"),trigger:"blur"}],provider:[{required:!0,message:r("message.required"),trigger:"blur"}]},T=v(!1),R=()=>O(null,null,function*(){T.value=!0;const a=ee(k.value);try{yield c.value.validate();const o=F(F({},t),a);if(f.value){o.providerId=M.value;const e=yield $.post("/api/v1/model/save",o);e.errorCode===0?(V.success(e.message),y("reload"),P()):V.error(e.message||r("ui.actionMessage.operationFailed"))}else{const e=yield $.post("/api/v1/model/update",o);e.errorCode===0?(V.success(e.message),y("reload"),P()):V.error(e.message||r("ui.actionMessage.operationFailed"))}}catch(o){console.error("Save model error:",o),V.error(r("ui.actionMessage.operationFailed"))}finally{T.value=!1}}),n=v(!1);return(a,o)=>(N(),_(l(Q),{modelValue:u.value,"onUpdate:modelValue":o[7]||(o[7]=e=>u.value=e),draggable:"",title:f.value?l(r)("button.add"):l(r)("button.edit"),"before-close":P,"close-on-click-modal":!1,"align-center":"",width:"482"},{footer:d(()=>[i(l(A),{onClick:P},{default:d(()=>[I(E(l(r)("button.cancel")),1)]),_:1}),i(l(A),{type:"primary",onClick:R,loading:T.value,disabled:T.value},{default:d(()=>[I(E(l(r)("button.save")),1)]),_:1},8,["loading","disabled"])]),default:d(()=>[i(l(H),{"label-width":"100px",ref_key:"formDataRef",ref:c,model:t,"status-icon":"",rules:L},{default:d(()=>[i(l(g),{prop:"title",label:l(r)("llm.title")},{default:d(()=>[i(l(b),{modelValue:t.title,"onUpdate:modelValue":o[0]||(o[0]=e=>t.title=e),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1},8,["label"]),i(l(g),{prop:"modelName",label:l(r)("llm.llmModel")},{default:d(()=>[i(l(b),{modelValue:t.modelName,"onUpdate:modelValue":o[1]||(o[1]=e=>t.modelName=e),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1},8,["label"]),i(l(g),{prop:"groupName",label:l(r)("llm.groupName")},{default:d(()=>[i(l(b),{modelValue:t.groupName,"onUpdate:modelValue":o[2]||(o[2]=e=>t.groupName=e),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1},8,["label"]),i(l(g),{prop:"ability",label:l(r)("llm.ability")},{default:d(()=>[se("div",me,[(N(!0),ie(de,null,pe(k.value,e=>(N(),_(l(le),{class:ue(["model-ability-tag",{"tag-selected":e.selected}]),key:e.value,type:e.selected?e.activeType:e.defaultType,onClick:q=>K(e)},{default:d(()=>[I(E(e.label),1)]),_:2},1032,["type","onClick","class"]))),128))])]),_:1},8,["label"]),n.value?re("",!0):(N(),_(l(g),{key:0,label:" "},{default:d(()=>[i(l(A),{onClick:o[3]||(o[3]=e=>n.value=!n.value),type:"primary"},{default:d(()=>[I(E(n.value?l(r)("button.hide"):l(r)("button.more")),1)]),_:1})]),_:1})),D(i(l(g),{prop:"apiKey",label:l(r)("llmProvider.apiKey")},{default:d(()=>[i(l(b),{modelValue:t.apiKey,"onUpdate:modelValue":o[4]||(o[4]=e=>t.apiKey=e),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1},8,["label"]),[[C,n.value]]),D(i(l(g),{prop:"endpoint",label:l(r)("llmProvider.endpoint")},{default:d(()=>[i(l(b),{modelValue:t.endpoint,"onUpdate:modelValue":o[5]||(o[5]=e=>t.endpoint=e),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1},8,["label"]),[[C,n.value]]),D(i(l(g),{prop:"requestPath",label:l(r)("llm.requestPath")},{default:d(()=>[i(l(b),{modelValue:t.requestPath,"onUpdate:modelValue":o[6]||(o[6]=e=>t.requestPath=e),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1},8,["label"]),[[C,n.value]])]),_:1},8,["model"])]),_:1},8,["modelValue","title"]))}}),Re=J(ne,[["__scopeId","data-v-a61d0692"]]);export{Re as default};
