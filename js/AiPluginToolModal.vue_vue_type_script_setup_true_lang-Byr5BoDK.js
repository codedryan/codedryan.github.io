var j=Object.defineProperty,A=Object.defineProperties;var B=Object.getOwnPropertyDescriptors;var y=Object.getOwnPropertySymbols;var q=Object.prototype.hasOwnProperty,w=Object.prototype.propertyIsEnumerable;var M=(i,l,t)=>l in i?j(i,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[l]=t,V=(i,l)=>{for(var t in l||(l={}))q.call(l,t)&&M(i,t,l[t]);if(y)for(var t of y(l))w.call(l,t)&&M(i,t,l[t]);return i},_=(i,l)=>A(i,B(l));import{$ as r,M as G,R as L}from"./bootstrap-Bf65uz2I.js";import"./css-gf8D6QlL.js";import{E as R}from"./el-dialog-CAR1-R4U.js";import"./el-overlay-Zuw8glOl.js";/* empty css                */import{E as S,a as E}from"./el-form-item-8FQp7Cs4.js";import"./css-C9o_OfXA.js";import{ElInput as N}from"./index-BjDsryRX.js";import{ElButton as k}from"./index-oBOAcXl-.js";import{k as $,G as P,r as f,o as T,B as H,n as J,E as d,J as n,u as e,L as x,y as h}from"../jse/index-index-D3Xb8oT_.js";const oe=$({__name:"AiPluginToolModal",props:{pluginId:{type:String,default:""}},emits:["reload"],setup(i,{expose:l,emit:t}){const v=i,C=t,o=P({pluginId:"",name:"",englishName:"",description:""}),m=f(),g=f(!1),c=f(!0),p=f(!1),F=/^[\w-]{1,64}$/,D=f({name:[{required:!0,message:r("message.required"),trigger:"blur"}],englishName:[{required:!0,message:r("message.englishNameRule"),trigger:"blur",pattern:F}]});function O(u){var a;try{(a=m.value)==null||a.resetFields(),u&&u.id?(c.value=!1,Object.assign(o,_(V({},u),{pluginId:v.pluginId}))):(c.value=!0,Object.assign(o,{pluginId:v.pluginId,name:"",description:""})),g.value=!0}catch(s){console.error("打开对话框错误:",s)}}function U(){m.value&&m.value.validate(u=>{if(!u)return;p.value=!0;const a=c.value?"api/v1/pluginItem/tool/save":"api/v1/pluginItem/tool/update",s=V({},o);G.post(a,s).then(I=>{p.value=!1,I.errorCode===0&&(L.success(r("message.saveOkMessage")),b(),C("reload"))}).catch(I=>{console.error("API请求错误:",I),p.value=!1})})}function b(){try{m.value&&m.value.resetFields(),Object.assign(o,{pluginId:v.pluginId,name:"",description:""}),c.value=!0,g.value=!1}catch(u){console.error("关闭对话框错误:",u),g.value=!1}}return T(()=>{Object.assign(o,{pluginId:v.pluginId,name:"",description:""})}),l({openDialog:O}),(u,a)=>(J(),H(e(R),{modelValue:g.value,"onUpdate:modelValue":a[3]||(a[3]=s=>g.value=s),draggable:"",title:c.value?e(r)("button.add"):e(r)("button.edit"),"before-close":b,"close-on-click-modal":!1,width:"600px",onClosed:b},{footer:d(()=>[n(e(k),{onClick:b,disabled:p.value},{default:d(()=>[x(h(e(r)("button.cancel")),1)]),_:1},8,["disabled"]),n(e(k),{type:"primary",loading:p.value,disabled:p.value,onClick:U},{default:d(()=>[x(h(e(r)("button.save")),1)]),_:1},8,["loading","disabled"])]),default:d(()=>[n(e(S),{ref_key:"saveForm",ref:m,model:o,rules:D.value,"label-width":"80px","status-icon":""},{default:d(()=>[n(e(E),{label:e(r)("pluginItem.name"),prop:"name"},{default:d(()=>[n(e(N),{modelValue:o.name,"onUpdate:modelValue":a[0]||(a[0]=s=>o.name=s),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1},8,["label"]),n(e(E),{label:e(r)("pluginItem.englishName"),prop:"englishName"},{default:d(()=>[n(e(N),{modelValue:o.englishName,"onUpdate:modelValue":a[1]||(a[1]=s=>o.englishName=s),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1},8,["label"]),n(e(E),{label:e(r)("pluginItem.description"),prop:"description"},{default:d(()=>[n(e(N),{modelValue:o.description,"onUpdate:modelValue":a[2]||(a[2]=s=>o.description=s),modelModifiers:{trim:!0},type:"textarea",rows:4},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"]))}});export{oe as _};
