import{_ as gt,M as Ft}from"./bootstrap-Bf65uz2I.js";import"./index-Dv97N9Ru.js";import{bg as vt,bw as At,bq as zt,bu as Wt,d as Rt,aJ as Dt,Z as Ot,h as Pt,b1 as Lt,k as _t,y as Bt,b7 as Xt,aB as Yt,aw as ht,ak as Gt,p as Ht,aR as ct}from"./universalTransition-D5im4pU2.js";import{c as qt,e as Zt,d as nt}from"./api-C8gsTHlO.js";import{r as mt,w as Nt,o as wt,a as $t,m as pt,n as yt,z as Vt,k as Ut,q as Jt,J as Kt}from"../jse/index-index-D3Xb8oT_.js";vt([At,zt]);vt(Wt);qt({type:"series.wordCloud",visualStyleAccessPath:"textStyle",visualStyleMapper:function(d){return{fill:d.get("color")}},visualDrawType:"fill",optionUpdated:function(){var d=this.option;d.gridSize=Math.max(Math.floor(d.gridSize),4)},getInitialData:function(d,r){var a=Rt(d.data,{coordDimensions:["value"]}),s=new Dt(a,this);return s.initData(d.data),s},defaultOption:{maskImage:null,shape:"circle",keepAspect:!1,left:"center",top:"center",width:"70%",height:"80%",sizeRange:[12,60],rotationRange:[-90,90],rotationStep:45,gridSize:8,drawOutOfBound:!1,shrinkToFit:!1,textStyle:{fontWeight:"normal"}}});Zt({type:"wordCloud",render:function(d,r,a){var s=this.group;s.removeAll();var t=d.getData(),h=d.get("gridSize");d.layoutInstance.ondraw=function(u,i,x,E){var P=t.getItemModel(x),X=P.getModel("textStyle"),I=new Ot({style:nt(X),scaleX:1/E.info.mu,scaleY:1/E.info.mu,x:(E.gx+E.info.gw/2)*h,y:(E.gy+E.info.gh/2)*h,rotation:E.rot});I.setStyle({x:E.info.fillTextOffsetX,y:E.info.fillTextOffsetY+i*.5,text:u,verticalAlign:"middle",fill:t.getItemVisual(x,"style").fill,fontSize:i}),s.add(I),t.setItemGraphicEl(x,I),I.ensureState("emphasis").style=nt(P.getModel(["emphasis","textStyle"]),{state:"emphasis"}),I.ensureState("blur").style=nt(P.getModel(["blur","textStyle"]),{state:"blur"}),Pt(I,P.get(["emphasis","focus"]),P.get(["emphasis","blurScope"])),I.stateTransition={duration:d.get("animation")?d.get(["stateAnimation","duration"]):0,easing:d.get(["stateAnimation","easing"])},I.__highDownDispatcher=!0},this._model=d},remove:function(){this.group.removeAll(),this._model.layoutInstance.dispose()},dispose:function(){this._model.layoutInstance.dispose()}});window.setImmediate||(window.setImmediate=function(){return window.msSetImmediate||window.webkitSetImmediate||window.mozSetImmediate||window.oSetImmediate||function(){if(!window.postMessage||!window.addEventListener)return null;var a=[void 0],s="zero-timeout-message",t=function(u){var i=a.length;return a.push(u),window.postMessage(s+i.toString(36),"*"),i};return window.addEventListener("message",function(u){if(!(typeof u.data!="string"||u.data.substr(0,s.length)!==s)){u.stopImmediatePropagation();var i=parseInt(u.data.substr(s.length),36);a[i]&&(a[i](),a[i]=void 0)}},!0),window.clearImmediate=function(u){a[u]&&(a[u]=void 0)},t}()||function(a){window.setTimeout(a,0)}}());window.clearImmediate||(window.clearImmediate=function(){return window.msClearImmediate||window.webkitClearImmediate||window.mozClearImmediate||window.oClearImmediate||function(a){window.clearTimeout(a)}}());var st=function(){var r=document.createElement("canvas");if(!r||!r.getContext)return!1;var a=r.getContext("2d");return!(!a||!a.getImageData||!a.fillText||!Array.prototype.some||!Array.prototype.push)}(),ot=function(){if(st){for(var r=document.createElement("canvas").getContext("2d"),a=20,s,t;a;){if(r.font=a.toString(10)+"px sans-serif",r.measureText("Ｗ").width===s&&r.measureText("m").width===t)return a+1;s=r.measureText("Ｗ").width,t=r.measureText("m").width,a--}return 0}}(),Qt=function(d){if(Array.isArray(d)){var r=d.slice();return r.splice(0,2),r}else return[]},jt=function(r){for(var a,s,t=r.length;t;)a=Math.floor(Math.random()*t),s=r[--t],r[t]=r[a],r[a]=s;return r},q={},U=function(r,a){if(!st)return;var s=Math.floor(Math.random()*Date.now());Array.isArray(r)||(r=[r]),r.forEach(function(g,e){if(typeof g=="string"){if(r[e]=document.getElementById(g),!r[e])throw new Error("The element id specified is not found.")}else if(!g.tagName&&!g.appendChild)throw new Error("You must pass valid HTML elements, or ID of the element.")});var t={list:[],fontFamily:'"Trebuchet MS", "Heiti TC", "微軟正黑體", "Arial Unicode MS", "Droid Fallback Sans", sans-serif',fontWeight:"normal",color:"random-dark",minSize:0,weightFactor:1,clearCanvas:!0,backgroundColor:"#fff",gridSize:8,drawOutOfBound:!1,shrinkToFit:!1,origin:null,drawMask:!1,maskColor:"rgba(255,0,0,0.3)",maskGapWidth:.3,layoutAnimation:!0,wait:0,abortThreshold:0,abort:function(){},minRotation:-Math.PI/2,maxRotation:Math.PI/2,rotationStep:.1,shuffle:!0,rotateRatio:.1,shape:"circle",ellipticity:.65,classes:null,hover:null,click:null};if(a)for(var h in a)h in t&&(t[h]=a[h]);if(typeof t.weightFactor!="function"){var u=t.weightFactor;t.weightFactor=function(e){return e*u}}if(typeof t.shape!="function")switch(t.shape){case"circle":default:t.shape="circle";break;case"cardioid":t.shape=function(e){return 1-Math.sin(e)};break;case"diamond":t.shape=function(e){var n=e%(2*Math.PI/4);return 1/(Math.cos(n)+Math.sin(n))};break;case"square":t.shape=function(e){return Math.min(1/Math.abs(Math.cos(e)),1/Math.abs(Math.sin(e)))};break;case"triangle-forward":t.shape=function(e){var n=e%(2*Math.PI/3);return 1/(Math.cos(n)+Math.sqrt(3)*Math.sin(n))};break;case"triangle":case"triangle-upright":t.shape=function(e){var n=(e+Math.PI*3/2)%(2*Math.PI/3);return 1/(Math.cos(n)+Math.sqrt(3)*Math.sin(n))};break;case"pentagon":t.shape=function(e){var n=(e+.955)%(2*Math.PI/5);return 1/(Math.cos(n)+.726543*Math.sin(n))};break;case"star":t.shape=function(e){var n=(e+.955)%(2*Math.PI/10);return(e+.955)%(2*Math.PI/5)-2*Math.PI/10>=0?1/(Math.cos(2*Math.PI/10-n)+3.07768*Math.sin(2*Math.PI/10-n)):1/(Math.cos(n)+3.07768*Math.sin(n))};break}t.gridSize=Math.max(Math.floor(t.gridSize),4);var i=t.gridSize,x=i-t.maskGapWidth,E=Math.abs(t.maxRotation-t.minRotation),P=Math.min(t.maxRotation,t.minRotation),X=t.rotationStep,I,C,F,_,A,D,Y;function lt(g,e){return"hsl("+(Math.random()*360).toFixed()+","+(Math.random()*30+70).toFixed()+"%,"+(Math.random()*(e-g)+g).toFixed()+"%)"}switch(t.color){case"random-dark":Y=function(){return lt(10,50)};break;case"random-light":Y=function(){return lt(50,90)};break;default:typeof t.color=="function"&&(Y=t.color);break}var Z;typeof t.fontWeight=="function"&&(Z=t.fontWeight);var J=null;typeof t.classes=="function"&&(J=t.classes);var K=!1,$=[],Q,dt=function(e){var n=e.currentTarget,o=n.getBoundingClientRect(),f,l;e.touches?(f=e.touches[0].clientX,l=e.touches[0].clientY):(f=e.clientX,l=e.clientY);var c=f-o.left,M=l-o.top,m=Math.floor(c*(n.width/o.width||1)/i),w=Math.floor(M*(n.height/o.height||1)/i);return $[m]?$[m][w]:null},ut=function(e){var n=dt(e);if(Q!==n){if(Q=n,!n){t.hover(void 0,void 0,e);return}t.hover(n.item,n.dimension,e)}},j=function(e){var n=dt(e);n&&(t.click(n.item,n.dimension,e),e.preventDefault())},tt=[],xt=function(e){if(tt[e])return tt[e];var n=e*8,o=n,f=[];for(e===0&&f.push([_[0],_[1],0]);o--;){var l=1;t.shape!=="circle"&&(l=t.shape(o/n*2*Math.PI)),f.push([_[0]+e*l*Math.cos(-o/n*2*Math.PI),_[1]+e*l*Math.sin(-o/n*2*Math.PI)*t.ellipticity,o/n*2*Math.PI])}return tt[e]=f,f},et=function(){return t.abortThreshold>0&&new Date().getTime()-D>t.abortThreshold},St=function(){return t.rotateRatio===0||Math.random()>t.rotateRatio?0:E===0?P:P+Math.round(Math.random()*E/X)*X},Mt=function(e,n,o,f){var l=t.weightFactor(n);if(l<=t.minSize)return!1;var c=1;l<ot&&(c=function(){for(var it=2;it*l<ot;)it+=2;return it}());var M;Z?M=Z(e,n,l,f):M=t.fontWeight;var m=document.createElement("canvas"),w=m.getContext("2d",{willReadFrequently:!0});w.font=M+" "+(l*c).toString(10)+"px "+t.fontFamily;var z=w.measureText(e).width/c,p=Math.max(l*c,w.measureText("m").width,w.measureText("Ｗ").width)/c,y=z+p*2,k=p*3,W=Math.ceil(y/i),R=Math.ceil(k/i);y=W*i,k=R*i;var T=-z/2,v=-p*.4,S=Math.ceil((y*Math.abs(Math.sin(o))+k*Math.abs(Math.cos(o)))/i),b=Math.ceil((y*Math.abs(Math.cos(o))+k*Math.abs(Math.sin(o)))/i),O=b*i,H=S*i;m.setAttribute("width",O),m.setAttribute("height",H),w.scale(1/c,1/c),w.translate(O*c/2,H*c/2),w.rotate(-o),w.font=M+" "+(l*c).toString(10)+"px "+t.fontFamily,w.fillStyle="#000",w.textBaseline="middle",w.fillText(e,T*c,(v+l*.5)*c);var V=w.getImageData(0,0,O,H).data;if(et())return!1;for(var ft=[],G=b,B,at,rt,L=[S/2,b/2,S/2,b/2];G--;)for(B=S;B--;){rt=i;t:for(;rt--;)for(at=i;at--;)if(V[((B*i+rt)*O+(G*i+at))*4+3]){ft.push([G,B]),G<L[3]&&(L[3]=G),G>L[1]&&(L[1]=G),B<L[0]&&(L[0]=B),B>L[2]&&(L[2]=B);break t}}return{mu:c,occupied:ft,bounds:L,gw:b,gh:S,fillTextOffsetX:T,fillTextOffsetY:v,fillTextWidth:z,fillTextHeight:p,fontSize:l}},Tt=function(e,n,o,f,l){for(var c=l.length;c--;){var M=e+l[c][0],m=n+l[c][1];if(M>=C||m>=F||M<0||m<0){if(!t.drawOutOfBound)return!1;continue}if(!I[M][m])return!1}return!0},It=function(e,n,o,f,l,c,M,m,w,z){var p=o.fontSize,y;Y?y=Y(f,l,p,c,M,z):y=t.color;var k;Z?k=Z(f,l,p,z):k=t.fontWeight;var W;J?W=J(f,l,p,z):W=t.classes,r.forEach(function(R){if(R.getContext){var T=R.getContext("2d"),v=o.mu;T.save(),T.scale(1/v,1/v),T.font=k+" "+(p*v).toString(10)+"px "+t.fontFamily,T.fillStyle=y,T.translate((e+o.gw/2)*i*v,(n+o.gh/2)*i*v),m!==0&&T.rotate(-m),T.textBaseline="middle",T.fillText(f,o.fillTextOffsetX*v,(o.fillTextOffsetY+p*.5)*v),T.restore()}else{var S=document.createElement("span"),b="";b="rotate("+-m/Math.PI*180+"deg) ",o.mu!==1&&(b+="translateX(-"+o.fillTextWidth/4+"px) scale("+1/o.mu+")");var O={position:"absolute",display:"block",font:k+" "+p*o.mu+"px "+t.fontFamily,left:(e+o.gw/2)*i+o.fillTextOffsetX+"px",top:(n+o.gh/2)*i+o.fillTextOffsetY+"px",width:o.fillTextWidth+"px",height:o.fillTextHeight+"px",lineHeight:p+"px",whiteSpace:"nowrap",transform:b,webkitTransform:b,msTransform:b,transformOrigin:"50% 40%",webkitTransformOrigin:"50% 40%",msTransformOrigin:"50% 40%"};y&&(O.color=y),S.textContent=f;for(var H in O)S.style[H]=O[H];if(w)for(var V in w)S.setAttribute(V,w[V]);W&&(S.className+=W),R.appendChild(S)}})},Ct=function(e,n,o,f,l){if(!(e>=C||n>=F||e<0||n<0)){if(I[e][n]=!1,o){var c=r[0].getContext("2d");c.fillRect(e*i,n*i,x,x)}K&&($[e][n]={item:l,dimension:f})}},kt=function(e,n,o,f,l,c){var M=l.occupied,m=t.drawMask,w;m&&(w=r[0].getContext("2d"),w.save(),w.fillStyle=t.maskColor);var z;if(K){var p=l.bounds;z={x:(e+p[3])*i,y:(n+p[0])*i,w:(p[1]-p[3]+1)*i,h:(p[2]-p[0]+1)*i}}for(var y=M.length;y--;){var k=e+M[y][0],W=n+M[y][1];k>=C||W>=F||k<0||W<0||Ct(k,W,m,z,c)}m&&w.restore()},bt=function g(e,n){if(n>20)return null;var o,f,l;Array.isArray(e)?(o=e[0],f=e[1]):(o=e.word,f=e.weight,l=e.attributes);var c=St(),M=Qt(e),m=Mt(o,f,c,M);if(!m||et())return!1;if(!t.drawOutOfBound&&!t.shrinkToFit){var w=m.bounds;if(w[1]-w[3]+1>C||w[2]-w[0]+1>F)return!1}for(var z=A+1,p=function(R){var T=Math.floor(R[0]-m.gw/2),v=Math.floor(R[1]-m.gh/2),S=m.gw,b=m.gh;return Tt(T,v,S,b,m.occupied)?(It(T,v,m,o,f,A-z,R[2],c,l,M),kt(T,v,S,b,m,e),{gx:T,gy:v,rot:c,info:m}):!1};z--;){var y=xt(A-z);t.shuffle&&(y=[].concat(y),jt(y));for(var k=0;k<y.length;k++){var W=p(y[k]);if(W)return W}}return t.shrinkToFit?(Array.isArray(e)?e[1]=e[1]*3/4:e.weight=e.weight*3/4,g(e,n+1)):null},N=function(e,n,o){if(n)return!r.some(function(f){var l=new CustomEvent(e,{detail:o||{}});return!f.dispatchEvent(l)},this);r.forEach(function(f){var l=new CustomEvent(e,{detail:o||{}});f.dispatchEvent(l)},this)},Et=function(){var e=r[0];if(e.getContext)C=Math.ceil(e.width/i),F=Math.ceil(e.height/i);else{var n=e.getBoundingClientRect();C=Math.ceil(n.width/i),F=Math.ceil(n.height/i)}if(N("wordcloudstart",!0)){_=t.origin?[t.origin[0]/i,t.origin[1]/i]:[C/2,F/2],A=Math.floor(Math.sqrt(C*C+F*F)),I=[];var o,f,l;if(!e.getContext||t.clearCanvas)for(r.forEach(function(v){if(v.getContext){var S=v.getContext("2d");S.fillStyle=t.backgroundColor,S.clearRect(0,0,C*(i+1),F*(i+1)),S.fillRect(0,0,C*(i+1),F*(i+1))}else v.textContent="",v.style.backgroundColor=t.backgroundColor,v.style.position="relative"}),o=C;o--;)for(I[o]=[],f=F;f--;)I[o][f]=!0;else{var c=document.createElement("canvas").getContext("2d");c.fillStyle=t.backgroundColor,c.fillRect(0,0,1,1);var M=c.getImageData(0,0,1,1).data,m=e.getContext("2d").getImageData(0,0,C*i,F*i).data;o=C;for(var w,z;o--;)for(I[o]=[],f=F;f--;){z=i;t:for(;z--;)for(w=i;w--;)for(l=4;l--;)if(m[((f*i+z)*C*i+(o*i+w))*4+l]!==M[l]){I[o][f]=!1;break t}I[o][f]!==!1&&(I[o][f]=!0)}m=c=M=void 0}if(t.hover||t.click){for(K=!0,o=C+1;o--;)$[o]=[];t.hover&&e.addEventListener("mousemove",ut),t.click&&(e.addEventListener("click",j),e.addEventListener("touchstart",j),e.addEventListener("touchend",function(v){v.preventDefault()}),e.style.webkitTapHighlightColor="rgba(0, 0, 0, 0)"),e.addEventListener("wordcloudstart",function v(){e.removeEventListener("wordcloudstart",v),e.removeEventListener("mousemove",ut),e.removeEventListener("click",j),Q=void 0})}l=0;var p,y,k=!0;t.layoutAnimation?t.wait!==0?(p=window.setTimeout,y=window.clearTimeout):(p=window.setImmediate,y=window.clearImmediate):(p=function(v){v()},y=function(){k=!1});var W=function(S,b){r.forEach(function(O){O.addEventListener(S,b)},this)},R=function(S,b){r.forEach(function(O){O.removeEventListener(S,b)},this)},T=function v(){R("wordcloudstart",v),y(q[s])};W("wordcloudstart",T),q[s]=(t.layoutAnimation?p:setTimeout)(function v(){if(k){if(l>=t.list.length){y(q[s]),N("wordcloudstop",!1),R("wordcloudstart",T),delete q[s];return}D=new Date().getTime();var S=bt(t.list[l],0),b=!N("wordclouddrawn",!0,{item:t.list[l],drawn:S});if(et()||b){y(q[s]),t.abort(),N("wordcloudabort",!1),N("wordcloudstop",!1),R("wordcloudstart",T);return}l++,q[s]=p(v,t.wait)}},t.wait)}};Et()};U.isSupported=st;U.minFontSize=ot;if(!U.isSupported)throw new Error("Sorry your browser not support wordCloud");function te(d){for(var r=d.getContext("2d"),a=r.getImageData(0,0,d.width,d.height),s=r.createImageData(a),t=0,h=0,u=0;u<a.data.length;u+=4){var i=a.data[u+3];if(i>128){var x=a.data[u]+a.data[u+1]+a.data[u+2];t+=x,++h}}for(var E=t/h,u=0;u<a.data.length;u+=4){var x=a.data[u]+a.data[u+1]+a.data[u+2],i=a.data[u+3];i<128||x>E?(s.data[u]=0,s.data[u+1]=0,s.data[u+2]=0,s.data[u+3]=0):(s.data[u]=255,s.data[u+1]=255,s.data[u+2]=255,s.data[u+3]=255)}r.putImageData(s,0,0)}Lt(function(d,r){d.eachSeriesByType("wordCloud",function(a){var s=_t(a.getBoxLayoutParams(),{width:r.getWidth(),height:r.getHeight()}),t=a.get("keepAspect"),h=a.get("maskImage"),u=h?h.width/h.height:1;t&&ee(s,u);var i=a.getData(),x=document.createElement("canvas");x.width=s.width,x.height=s.height;var E=x.getContext("2d");if(h)try{E.drawImage(h,0,0,x.width,x.height),te(x)}catch(A){console.error("Invalid mask image"),console.error(A.toString())}var P=a.get("sizeRange"),X=a.get("rotationRange"),I=i.getDataExtent("value"),C=Math.PI/180,F=a.get("gridSize");U(x,{list:i.mapArray("value",function(A,D){var Y=i.getItemModel(D);return[i.getName(D),Y.get("textStyle.fontSize",!0)||Bt(A,I,P),D]}).sort(function(A,D){return D[1]-A[1]}),fontFamily:a.get("textStyle.fontFamily")||a.get("emphasis.textStyle.fontFamily")||d.get("textStyle.fontFamily"),fontWeight:a.get("textStyle.fontWeight")||a.get("emphasis.textStyle.fontWeight")||d.get("textStyle.fontWeight"),gridSize:F,ellipticity:s.height/s.width,minRotation:X[0]*C,maxRotation:X[1]*C,clearCanvas:!h,rotateRatio:1,rotationStep:a.get("rotationStep")*C,drawOutOfBound:a.get("drawOutOfBound"),shrinkToFit:a.get("shrinkToFit"),layoutAnimation:a.get("layoutAnimation"),shuffle:!1,shape:a.get("shape")});function _(A){var D=A.detail.item;A.detail.drawn&&a.layoutInstance.ondraw&&(A.detail.drawn.gx+=s.x/F,A.detail.drawn.gy+=s.y/F,a.layoutInstance.ondraw(D[0],D[1],D[2],A.detail.drawn))}x.addEventListener("wordclouddrawn",_),a.layoutInstance&&a.layoutInstance.dispose(),a.layoutInstance={ondraw:null,dispose:function(){x.removeEventListener("wordclouddrawn",_),x.addEventListener("wordclouddrawn",function(A){A.preventDefault()})}}})});Xt(function(d){var r=(d||{}).series;!Yt(r)&&(r=r?[r]:[]);var a=["shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY"];ht(r,function(t){if(t&&t.type==="wordCloud"){var h=t.textStyle||{};s(h.normal),s(h.emphasis)}});function s(t){t&&ht(a,function(h){t.hasOwnProperty(h)&&(t["text"+Gt(h)]=t[h])})}});function ee(d,r){var a=d.width,s=d.height;a>s*r?(d.x+=(a-s*r)/2,d.width=s*r):(d.y+=(s-a/r)/2,d.height=a/r)}const ae={__name:"EchartsWordCloud",props:{data:{type:Array,required:!0,default:()=>[]},width:{type:String,default:"800px"},height:{type:String,default:"600px"},shape:{type:String,default:"circle"},sizeRange:{type:Array,default:()=>[12,60]}},emits:["wordClick"],setup(d,{emit:r}){const a=d,s=r,t=mt(null);let h=null;const u=()=>{if(!t.value||a.data.length===0)return;h&&ct(h),h=Ht(t.value);const x={tooltip:{trigger:"item"},series:[{type:"wordCloud",gridSize:10,sizeRange:a.sizeRange,rotationRange:[-90,90],shape:a.shape,width:"100%",height:"100%",textStyle:{color:()=>`rgb(${Math.random()*255},${Math.random()*255},${Math.random()*255})`},emphasis:{textStyle:{shadowBlur:10}},data:a.data,onClick:E=>{s("wordClick",E.name)}}]};h.setOption(x)};Nt(()=>a.data,()=>{u()},{deep:!0});const i=()=>{h&&h.resize()};return wt(()=>{u(),window.addEventListener("resize",i)}),$t(()=>{window.removeEventListener("resize",i),h&&(ct(h),h=null)}),(x,E)=>(yt(),pt("div",{ref_key:"cloudRef",ref:t,class:"word-cloud",style:Vt({width:d.width,height:d.height})},null,4))}},re=gt(ae,[["__scopeId","data-v-498f3521"]]),ie={class:"sensitive-word-page"},ne={class:"container-word-cloud"},oe=Ut({__name:"SensitiveWordCloud",setup(d){const r=mt([]);wt(()=>{a()});const a=()=>{Ft.get("/api/v1/sensitiveWordTriggerLog/getWordCloudData").then(s=>{r.value=s.data})};return(s,t)=>(yt(),pt("div",ie,[Jt("div",ne,[Kt(re,{data:r.value,width:"900px",height:"700px",shape:"cardioid"},null,8,["data"])])]))}}),ce=gt(oe,[["__scopeId","data-v-e969b377"]]);export{ce as default};
