var L=Object.defineProperty;var T=Object.getOwnPropertySymbols;var J=Object.prototype.hasOwnProperty,G=Object.prototype.propertyIsEnumerable;var O=(c,u,v)=>u in c?L(c,u,{enumerable:!0,configurable:!0,writable:!0,value:v}):c[u]=v,Q=(c,u)=>{for(var v in u||(u={}))J.call(u,v)&&O(c,v,u[v]);if(T)for(var v of T(u))G.call(u,v)&&O(c,v,u[v]);return c};import{$ as B,R as W,_ as X}from"./bootstrap-Bf65uz2I.js";import{E as x}from"./el-avatar-BVPcm0Px.js";import"./css-gf8D6QlL.js";import"./css-_QzOlLq8.js";import{E as Y,a as Z}from"./el-collapse-item-DRoc9NR8.js";import{E as I}from"./el-dialog-CAR1-R4U.js";import"./el-overlay-Zuw8glOl.js";/* empty css                */import{H as ee}from"./HeaderSearch-Dj9rqjlr.js";import{_ as te}from"./PageData.vue_vue_type_script_setup_true_lang-DfbAOXk_.js";import{E as b}from"./index-Bpv3aWiu.js";import{ElCheckbox as w}from"./index-p7kg-xKH.js";import{ElButton as $}from"./index-oBOAcXl-.js";import{k as ae,r as E,B as k,n as i,E as d,q as a,J as f,m as p,F as M,N as D,u as o,p as j,L as C,y as m,s as le}from"../jse/index-index-D3Xb8oT_.js";const se={class:"el-dialog__title mb-4"},ne={class:"select-modal-container p-5"},oe={key:0,class:"container-second"},ie={class:"title-right-container"},ce={class:"desc"},re={key:0},de={class:"content-title-wrapper"},ue={class:"content-left-container"},ve={class:"title-right-container"},fe={class:"desc"},pe={key:1},me={class:"content-title-wrapper"},he={class:"content-left-container"},_e={class:"title-right-container"},ge={class:"desc"},ye={key:1,class:"container-second"},Se={class:"content-title-wrapper"},ke={class:"content-sec-left-container"},Ce={class:"title-sec-right-container"},Ee={class:"desc"},xe=ae({__name:"CommonSelectDataModal",props:{title:{type:String,default:""},width:{type:String,default:"80%"},extraQueryParams:{type:Object,default:()=>({})},searchParams:{type:Array,default:()=>[]},titleKey:{type:String,default:"name"},pageUrl:{type:String,default:""},hasParent:{type:Boolean,default:!1},isSelectMcp:{type:Boolean,default:!1},singleSelect:{type:Boolean,default:!1},footerButtons:{type:Array,default:()=>[]}},emits:["getData","buttonClick"],setup(c,{expose:u,emit:v}){const g=c,q=v,y=E(!1),V=E(),A=E(!1),h=E([]),r=E({});u({openDialog(e){h.value=e?[...e]:[],y.value=!0},openMcpDialog(e){h.value=[],r.value=structuredClone(e),y.value=!0}});const P=e=>h.value.includes(e),N=(e,l)=>{var s;return!!((s=r.value[e])!=null&&s.some(t=>t.name===l))},U=(e,l,s,t)=>{var _,n;t?(r.value[e]||(r.value[e]=[]),(_=r.value[e])!=null&&_.some(K=>K.name===l)||(n=r.value[e])==null||n.push({name:l,description:s})):r.value[e]&&(r.value[e]=r.value[e].filter(S=>S.name!==l),r.value[e].length===0&&delete r.value[e])},R=(e,l)=>{l?g.singleSelect?h.value=[e]:h.value.includes(e)||h.value.push(e):g.singleSelect||(h.value=h.value.filter(s=>s!==e))},z=()=>{const e=[];return Object.entries(r.value).forEach(([l,s])=>{const t=s.map(_=>[_.name,_.description]);e.push({[l]:t})}),e},F=()=>{if(!(g.isSelectMcp?Object.keys(r.value).some(s=>{var t;return((t=r.value[s])!=null?t:[]).length>0}):h.value.length>0)){W.error(B("message.selectTip"));return}const l=g.isSelectMcp?z():h.value;return q("getData",l),y.value=!1,l},H=e=>{var s;const l={};g.searchParams.forEach(t=>{l[t]=e}),(s=V.value)==null||s.setQuery(Q({isQueryOr:!0},l))};return(e,l)=>(i(),k(o(I),{modelValue:y.value,"onUpdate:modelValue":l[1]||(l[1]=s=>y.value=s),draggable:"","close-on-click-modal":!1,width:g.width,"align-center":""},{header:d(()=>[a("div",null,[a("p",se,m(g.title),1),f(ee,{onSearch:H})])]),footer:d(()=>[f(o($),{onClick:l[0]||(l[0]=s=>y.value=!1)},{default:d(()=>[C(m(o(B)("button.cancel")),1)]),_:1}),f(o($),{type:"primary",onClick:F,loading:A.value},{default:d(()=>[C(m(o(B)("button.confirm")),1)]),_:1},8,["loading"])]),default:d(()=>[a("div",ne,[f(te,{ref_key:"pageDataRef",ref:V,"page-url":c.pageUrl,"page-size":10,"extra-query-params":c.extraQueryParams},{default:d(({pageList:s})=>[c.hasParent?(i(),p("div",oe,[(i(!0),p(M,null,D(s,(t,_)=>(i(),k(o(Y),{accordion:"",key:_},{default:d(()=>[f(o(Z),null,{title:d(({isActive:n})=>[a("div",{class:le(["title-wrapper",[{"is-active":n}]])},[a("div",null,[t.icon?(i(),k(o(x),{key:0,src:t.icon},null,8,["src"])):(i(),k(o(x),{key:1,src:"/favicon.png",shape:"circle"}))]),a("div",ie,[f(o(b),{truncated:"",class:"title"},{default:d(()=>[C(m(t[c.titleKey]),1)]),_:2},1024),a("div",ce,m(t.description),1)])],2)]),default:d(()=>[c.isSelectMcp?j("",!0):(i(),p("div",re,[(i(!0),p(M,null,D(t.tools,n=>(i(),p("div",{key:n.id},[a("div",de,[a("div",ue,[a("div",ve,[f(o(b),{truncated:"",class:"title"},{default:d(()=>[C(m(n.name),1)]),_:2},1024),a("div",fe,m(n.description),1)])]),a("div",null,[f(o(w),{"model-value":P(n.id),onChange:S=>R(n.id,S)},null,8,["model-value","onChange"])])])]))),128))])),c.isSelectMcp?(i(),p("div",pe,[(i(!0),p(M,null,D(t.tools,n=>(i(),p("div",{key:n.name},[a("div",me,[a("div",he,[a("div",_e,[f(o(b),{truncated:"",class:"title"},{default:d(()=>[C(m(n.name),1)]),_:2},1024),a("div",ge,m(n.description),1)])]),a("div",null,[f(o(w),{"model-value":N(t.id,n.name),onChange:S=>U(t.id,n.name,n.description,S)},null,8,["model-value","onChange"])])])]))),128))])):j("",!0)]),_:2},1024)]),_:2},1024))),128))])):(i(),p("div",ye,[(i(!0),p(M,null,D(s,(t,_)=>(i(),p("div",{key:_},[a("div",Se,[a("div",ke,[a("div",null,[t.icon?(i(),k(o(x),{key:0,src:t.icon},null,8,["src"])):(i(),k(o(x),{key:1,src:"/favicon.png",shape:"circle"}))]),a("div",Ce,[f(o(b),{truncated:"",class:"title"},{default:d(()=>[C(m(t.title),1)]),_:2},1024),a("div",Ee,m(t.description),1)])]),a("div",null,[f(o(w),{"model-value":P(t.id),onChange:n=>R(t.id,n)},null,8,["model-value","onChange"])])])]))),128))]))]),_:1},8,["page-url","extra-query-params"])])]),_:1},8,["modelValue","width"]))}}),Ne=X(xe,[["__scopeId","data-v-b6423691"]]);export{Ne as C};
