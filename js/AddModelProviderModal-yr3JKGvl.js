var U=(E,y,s)=>new Promise((g,v)=>{var f=e=>{try{m(s.next(e))}catch(p){v(p)}},P=e=>{try{m(s.throw(e))}catch(p){v(p)}},m=e=>e.done?g(e.value):Promise.resolve(e.value).then(f,P);m((s=s.apply(E,y)).next())});import{$ as i,M as N,R as _,_ as q}from"./bootstrap-Bf65uz2I.js";import"./css-gf8D6QlL.js";import{E as w}from"./el-dialog-CAR1-R4U.js";import"./el-overlay-Zuw8glOl.js";/* empty css                */import{E as L,a as u}from"./el-form-item-8FQp7Cs4.js";import"./css-C9o_OfXA.js";/* empty css                  *//* empty css               *//* empty css                     *//* empty css                  */import{U as I}from"./UploadAvatar-a3x1lqjM.js";import{p as x}from"./providerList-IOY-GpS5.js";import{ElInput as b}from"./index-BjDsryRX.js";import{E as O,a as R}from"./index-DcZY4wgD.js";import{ElButton as C}from"./index-oBOAcXl-.js";import{k as S,r as V,G as $,B as D,n as h,E as d,J as r,u as l,m as j,F as G,N as J,L as T,y as A}from"../jse/index-index-D3Xb8oT_.js";import"./index-B3qAv2kq.js";import"./aria-DEUWDJ1E.js";import"./refs-D6FW0B1r.js";import"./event-BB_Ol6Sd.js";import"./index-Bxb6QITi.js";import"./index-Dg3fRnQE.js";import"./vnode-DysYOGZN.js";import"./scroll-C2492Iw_.js";import"./use-form-common-props-IzjzSHax.js";import"./castArray-BBset58W.js";import"./_baseClone-trfKWgGN.js";import"./el-image-viewer-DlaFkWIK.js";import"./debounce-AsHllEOy.js";import"./toNumber-CvayJyp9.js";import"./index-C33Sf0pH.js";import"./css-BA5xAVBz.js";import"./index-e0qsk5Ci.js";import"./cloneDeep-Orislllf.js";import"./index-bT9OJj6t.js";import"./_overRest-Bb9G3v08.js";import"./use-form-item-DVWmmqeW.js";import"./index-m1ZP1zbM.js";import"./index-CMBjNRIa.js";import"./index-CbSmxnRE.js";import"./util-B2mB0_6C.js";import"./index-DGdiZ7pE.js";import"./useProps-DNCnrLfW.js";import"./_baseFindIndex-D7XfJLKM.js";import"./_baseIteratee-rJjBrWyx.js";import"./strings-CGsg9AfI.js";import"./clamp-CeuJyDnc.js";import"./index-pv0R11Cf.js";const z=S({__name:"AddModelProviderModal",emits:["reload"],setup(E,{expose:y,emit:s}){const g=s,v=V();y({openAddDialog(){var t;(t=v.value)==null||t.resetFields(),m.value=!0},openEditDialog(t){m.value=!0,P.value=!1,Object.assign(e,t)}});const f=V(x),P=V(!0),m=V(!1),e=$({id:"",icon:"",providerName:"",providerType:"",apiKey:"",endpoint:"",chatPath:"",embedPath:"",rerankPath:""}),p=()=>{m.value=!1},B={providerName:[{required:!0,message:i("message.required"),trigger:"blur"}],providerType:[{required:!0,message:i("message.required"),trigger:"blur"}]},c=V(!1),F=()=>U(null,null,function*(){c.value=!0;try{if(!P.value){N.post("/api/v1/modelProvider/update",e).then(t=>{t.errorCode===0&&(_.success(t.message),g("reload"),p())});return}yield v.value.validate(),N.post("/api/v1/modelProvider/save",e).then(t=>{t.errorCode===0&&(_.success(t.message),g("reload"),p())})}finally{c.value=!1}}),K=t=>{var o,k,M;const a=x.find(n=>n.value===t);a&&(e.providerName=a.label,e.endpoint=(o=f.value.find(n=>n.value===t))==null?void 0:o.options.llmEndpoint,e.chatPath=(k=f.value.find(n=>n.value===t))==null?void 0:k.options.chatPath,e.embedPath=(M=f.value.find(n=>n.value===t))==null?void 0:M.options.embedPath)};return(t,a)=>(h(),D(l(w),{modelValue:m.value,"onUpdate:modelValue":a[8]||(a[8]=o=>m.value=o),draggable:"",title:P.value?l(i)("button.add"):l(i)("button.edit"),"before-close":p,"close-on-click-modal":!1,"align-center":"",width:"482"},{footer:d(()=>[r(l(C),{onClick:p},{default:d(()=>[T(A(l(i)("button.cancel")),1)]),_:1}),r(l(C),{type:"primary",onClick:F,loading:c.value,disabled:c.value},{default:d(()=>[T(A(l(i)("button.save")),1)]),_:1},8,["loading","disabled"])]),default:d(()=>[r(l(L),{"label-width":"100px",ref_key:"formDataRef",ref:v,model:e,"status-icon":"",rules:B},{default:d(()=>[r(l(u),{prop:"icon",style:{display:"flex","align-items":"center"},label:l(i)("llmProvider.icon")},{default:d(()=>[r(I,{modelValue:e.icon,"onUpdate:modelValue":a[0]||(a[0]=o=>e.icon=o)},null,8,["modelValue"])]),_:1},8,["label"]),r(l(u),{prop:"providerName",label:l(i)("llmProvider.providerName")},{default:d(()=>[r(l(b),{modelValue:e.providerName,"onUpdate:modelValue":a[1]||(a[1]=o=>e.providerName=o),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1},8,["label"]),r(l(u),{prop:"providerType",label:l(i)("llmProvider.apiType")},{default:d(()=>[r(l(O),{modelValue:e.providerType,"onUpdate:modelValue":a[2]||(a[2]=o=>e.providerType=o),onChange:K},{default:d(()=>[(h(!0),j(G,null,J(f.value,o=>(h(),D(l(R),{key:o.value,label:o.label,value:o.value||""},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),r(l(u),{prop:"apiKey",label:l(i)("llmProvider.apiKey")},{default:d(()=>[r(l(b),{modelValue:e.apiKey,"onUpdate:modelValue":a[3]||(a[3]=o=>e.apiKey=o),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1},8,["label"]),r(l(u),{prop:"endpoint",label:l(i)("llmProvider.endpoint")},{default:d(()=>[r(l(b),{modelValue:e.endpoint,"onUpdate:modelValue":a[4]||(a[4]=o=>e.endpoint=o),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1},8,["label"]),r(l(u),{prop:"chatPath",label:l(i)("llmProvider.chatPath")},{default:d(()=>[r(l(b),{modelValue:e.chatPath,"onUpdate:modelValue":a[5]||(a[5]=o=>e.chatPath=o),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1},8,["label"]),r(l(u),{prop:"rerankPath",label:l(i)("llmProvider.rerankPath")},{default:d(()=>[r(l(b),{modelValue:e.rerankPath,"onUpdate:modelValue":a[6]||(a[6]=o=>e.rerankPath=o),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1},8,["label"]),r(l(u),{prop:"embedPath",label:l(i)("llmProvider.embedPath")},{default:d(()=>[r(l(b),{modelValue:e.embedPath,"onUpdate:modelValue":a[7]||(a[7]=o=>e.embedPath=o),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["modelValue","title"]))}}),je=q(z,[["__scopeId","data-v-4abbd7e0"]]);export{je as default};
