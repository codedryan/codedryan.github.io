var ye=Object.defineProperty;var le=Object.getOwnPropertySymbols;var Se=Object.prototype.hasOwnProperty,ve=Object.prototype.propertyIsEnumerable;var re=(e,a,n)=>a in e?ye(e,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[a]=n,U=(e,a)=>{for(var n in a||(a={}))Se.call(a,n)&&re(e,n,a[n]);if(le)for(var n of le(a))ve.call(a,n)&&re(e,n,a[n]);return e};var se=(e,a,n)=>new Promise((l,o)=>{var c=p=>{try{u(n.next(p))}catch(s){o(s)}},d=p=>{try{u(n.throw(p))}catch(s){o(s)}},u=p=>p.done?l(p.value):Promise.resolve(p.value).then(c,d);u((n=n.apply(e,a)).next())});import{s as xe}from"./chunk-SKB7J2MH-BlwHRDiW-CSCNhoIh.js";import{_ as C,F as ie,G as oe,K as be,e as we,l as Q,aO as P,d as j,b as Ce,a as Te,q as Le,t as $e,g as Fe,s as _e,H as ke,aP as Ae,z as Ne}from"./mermaid.core-CAqkCmS1-CM8NaR-l.js";import{p as Me}from"./chunk-353BL4L5-Dn_Y_Yna-BqbWy4Jb.js";import{p as ze}from"./treemap-75Q7IDZK-B2atdfMH-poOAsgcV.js";import{b as I}from"./defaultLocale-DVr69WTU-BKARdtRu.js";import{o as Z}from"./ordinal-DSZU4PqD-DOFoVEQk.js";import"../jse/index-index-D3Xb8oT_.js";import"./bootstrap-Bf65uz2I.js";import"./_baseUniq-BXtq6_NW-DmcqD6K1.js";import"./min-BngCxx8g-CaLr7yid.js";import"./clone-CEJtuQzg-DHIwSYDi.js";import"./init-ZxktEp_H-Gi6I4Gst.js";var J;function Ve(e){var a=0,n=e.children,l=n&&n.length;if(!l)a=1;else for(;--l>=0;)a+=n[l].value;e.value=a}function De(){return this.eachAfter(Ve)}function Pe(e,a){let n=-1;for(const l of this)e.call(a,l,++n,this);return this}function Be(e,a){for(var n=this,l=[n],o,c,d=-1;n=l.pop();)if(e.call(a,n,++d,this),o=n.children)for(c=o.length-1;c>=0;--c)l.push(o[c]);return this}function Re(e,a){for(var n=this,l=[n],o=[],c,d,u,p=-1;n=l.pop();)if(o.push(n),c=n.children)for(d=0,u=c.length;d<u;++d)l.push(c[d]);for(;n=o.pop();)e.call(a,n,++p,this);return this}function Ee(e,a){let n=-1;for(const l of this)if(e.call(a,l,++n,this))return l}function We(e){return this.eachAfter(function(a){for(var n=+e(a.data)||0,l=a.children,o=l&&l.length;--o>=0;)n+=l[o].value;a.value=n})}function He(e){return this.eachBefore(function(a){a.children&&a.children.sort(e)})}function Ie(e){for(var a=this,n=Oe(a,e),l=[a];a!==n;)a=a.parent,l.push(a);for(var o=l.length;e!==n;)l.splice(o,0,e),e=e.parent;return l}function Oe(e,a){if(e===a)return e;var n=e.ancestors(),l=a.ancestors(),o=null;for(e=n.pop(),a=l.pop();e===a;)o=e,e=n.pop(),a=l.pop();return o}function Ge(){for(var e=this,a=[e];e=e.parent;)a.push(e);return a}function qe(){return Array.from(this)}function Xe(){var e=[];return this.eachBefore(function(a){a.children||e.push(a)}),e}function je(){var e=this,a=[];return e.each(function(n){n!==e&&a.push({source:n.parent,target:n})}),a}function*Ye(){var e=this,a,n=[e],l,o,c;do for(a=n.reverse(),n=[];e=a.pop();)if(yield e,l=e.children)for(o=0,c=l.length;o<c;++o)n.push(l[o]);while(n.length)}function ee(e,a){e instanceof Map?(e=[void 0,e],a===void 0&&(a=Ze)):a===void 0&&(a=Ue);for(var n=new Y(e),l,o=[n],c,d,u,p;l=o.pop();)if((d=a(l.data))&&(p=(d=Array.from(d)).length))for(l.children=d,u=p-1;u>=0;--u)o.push(c=d[u]=new Y(d[u])),c.parent=l,c.depth=l.depth+1;return n.eachBefore(Qe)}function Ke(){return ee(this).eachBefore(Je)}function Ue(e){return e.children}function Ze(e){return Array.isArray(e)?e[1]:null}function Je(e){e.data.value!==void 0&&(e.value=e.data.value),e.data=e.data.data}function Qe(e){var a=0;do e.height=a;while((e=e.parent)&&e.height<++a)}function Y(e){this.data=e,this.depth=this.height=0,this.parent=null}Y.prototype=ee.prototype={constructor:Y,count:De,each:Pe,eachAfter:Re,eachBefore:Be,find:Ee,sum:We,sort:He,path:Ie,ancestors:Ge,descendants:qe,leaves:Xe,links:je,copy:Ke,[Symbol.iterator]:Ye};function et(e){if(typeof e!="function")throw new Error;return e}function O(){return 0}function G(e){return function(){return e}}function tt(e){e.x0=Math.round(e.x0),e.y0=Math.round(e.y0),e.x1=Math.round(e.x1),e.y1=Math.round(e.y1)}function at(e,a,n,l,o){for(var c=e.children,d,u=-1,p=c.length,s=e.value&&(l-a)/e.value;++u<p;)d=c[u],d.y0=n,d.y1=o,d.x0=a,d.x1=a+=d.value*s}function nt(e,a,n,l,o){for(var c=e.children,d,u=-1,p=c.length,s=e.value&&(o-n)/e.value;++u<p;)d=c[u],d.x0=a,d.x1=l,d.y0=n,d.y1=n+=d.value*s}var lt=(1+Math.sqrt(5))/2;function rt(e,a,n,l,o,c){for(var d=[],u=a.children,p,s,h=0,g=0,r=u.length,y,S,v=a.value,f,x,A,k,V,R,N;h<r;){y=o-n,S=c-l;do f=u[g++].value;while(!f&&g<r);for(x=A=f,R=Math.max(S/y,y/S)/(v*e),N=f*f*R,V=Math.max(A/N,N/x);g<r;++g){if(f+=s=u[g].value,s<x&&(x=s),s>A&&(A=s),N=f*f*R,k=Math.max(A/N,N/x),k>V){f-=s;break}V=k}d.push(p={value:f,dice:y<S,children:u.slice(h,g)}),p.dice?at(p,n,l,o,v?l+=S*f/v:c):nt(p,n,l,v?n+=y*f/v:o,c),v-=f,h=g}return d}const st=function e(a){function n(l,o,c,d,u){rt(a,l,o,c,d,u)}return n.ratio=function(l){return e((l=+l)>1?l:1)},n}(lt);function it(){var e=st,a=!1,n=1,l=1,o=[0],c=O,d=O,u=O,p=O,s=O;function h(r){return r.x0=r.y0=0,r.x1=n,r.y1=l,r.eachBefore(g),o=[0],a&&r.eachBefore(tt),r}function g(r){var y=o[r.depth],S=r.x0+y,v=r.y0+y,f=r.x1-y,x=r.y1-y;f<S&&(S=f=(S+f)/2),x<v&&(v=x=(v+x)/2),r.x0=S,r.y0=v,r.x1=f,r.y1=x,r.children&&(y=o[r.depth+1]=c(r)/2,S+=s(r)-y,v+=d(r)-y,f-=u(r)-y,x-=p(r)-y,f<S&&(S=f=(S+f)/2),x<v&&(v=x=(v+x)/2),e(r,S,v,f,x))}return h.round=function(r){return arguments.length?(a=!!r,h):a},h.size=function(r){return arguments.length?(n=+r[0],l=+r[1],h):[n,l]},h.tile=function(r){return arguments.length?(e=et(r),h):e},h.padding=function(r){return arguments.length?h.paddingInner(r).paddingOuter(r):h.paddingInner()},h.paddingInner=function(r){return arguments.length?(c=typeof r=="function"?r:G(+r),h):c},h.paddingOuter=function(r){return arguments.length?h.paddingTop(r).paddingRight(r).paddingBottom(r).paddingLeft(r):h.paddingTop()},h.paddingTop=function(r){return arguments.length?(d=typeof r=="function"?r:G(+r),h):d},h.paddingRight=function(r){return arguments.length?(u=typeof r=="function"?r:G(+r),h):u},h.paddingBottom=function(r){return arguments.length?(p=typeof r=="function"?r:G(+r),h):p},h.paddingLeft=function(r){return arguments.length?(s=typeof r=="function"?r:G(+r),h):s},h}var ce=(J=class{constructor(){this.nodes=[],this.levels=new Map,this.outerNodes=[],this.classes=new Map,this.setAccTitle=Ce,this.getAccTitle=Te,this.setDiagramTitle=Le,this.getDiagramTitle=$e,this.getAccDescription=Fe,this.setAccDescription=_e}getNodes(){return this.nodes}getConfig(){var n;const e=ke,a=oe();return ie(U(U({},e.treemap),(n=a.treemap)!=null?n:{}))}addNode(e,a){var n;this.nodes.push(e),this.levels.set(e,a),a===0&&(this.outerNodes.push(e),(n=this.root)!=null||(this.root=e))}getRoot(){return{name:"",children:this.outerNodes}}addClass(e,a){var o;const n=(o=this.classes.get(e))!=null?o:{id:e,styles:[],textStyles:[]},l=a.replace(/\\,/g,"§§§").replace(/,/g,";").replace(/§§§/g,",").split(";");l&&l.forEach(c=>{Ae(c)&&(n!=null&&n.textStyles?n.textStyles.push(c):n.textStyles=[c]),n!=null&&n.styles?n.styles.push(c):n.styles=[c]}),this.classes.set(e,n)}getClasses(){return this.classes}getStylesForClass(e){var n;var a;return(n=(a=this.classes.get(e))==null?void 0:a.styles)!=null?n:[]}clear(){Ne(),this.nodes=[],this.levels=new Map,this.outerNodes=[],this.classes=new Map,this.root=void 0}},C(J,"TreeMapDB"),J);function de(e){if(!e.length)return[];const a=[],n=[];return e.forEach(l=>{const o={name:l.name,children:l.type==="Leaf"?void 0:[]};for(o.classSelector=l==null?void 0:l.classSelector,l!=null&&l.cssCompiledStyles&&(o.cssCompiledStyles=[l.cssCompiledStyles]),l.type==="Leaf"&&l.value!==void 0&&(o.value=l.value);n.length>0&&n[n.length-1].level>=l.level;)n.pop();if(n.length===0)a.push(o);else{const c=n[n.length-1].node;c.children?c.children.push(o):c.children=[o]}l.type!=="Leaf"&&n.push({node:o,level:l.level})}),a}C(de,"buildHierarchy");var ot=C((e,a)=>{var c,d,u,p;Me(e,a);const n=[];for(const s of(c=e.TreemapRows)!=null?c:[])s.$type==="ClassDefStatement"&&a.addClass((d=s.className)!=null?d:"",(u=s.styleText)!=null?u:"");for(const s of(p=e.TreemapRows)!=null?p:[]){const h=s.item;if(!h)continue;const g=s.indent?parseInt(s.indent):0,r=ct(h),y=h.classSelector?a.getStylesForClass(h.classSelector):[],S=y.length>0?y.join(";"):void 0,v={level:g,name:r,type:h.$type,value:h.value,classSelector:h.classSelector,cssCompiledStyles:S};n.push(v)}const l=de(n),o=C((s,h)=>{for(const g of s)a.addNode(g,h),g.children&&g.children.length>0&&o(g.children,h+1)},"addNodesRecursively");o(l,0)},"populate"),ct=C(e=>e.name?String(e.name):"","getItemName"),he={parser:{yy:void 0},parse:C(e=>se(null,null,function*(){var a;try{const l=yield ze("treemap",e);Q.debug("Treemap AST:",l);const o=(a=he.parser)==null?void 0:a.yy;if(!(o instanceof ce))throw new Error("parser.parser?.yy was not a TreemapDB. This is due to a bug within Mermaid, please report this issue at https://github.com/mermaid-js/mermaid/issues.");ot(l,o)}catch(n){throw Q.error("Error parsing treemap:",n),n}}),"parse")},dt=10,B=10,q=25,ht=C((e,a,n,l)=>{var ae,ne;const o=l.db,c=o.getConfig(),d=(ae=c.padding)!=null?ae:dt,u=o.getDiagramTitle(),p=o.getRoot(),{themeVariables:s}=oe();if(!p)return;const h=u?30:0,g=be(a),r=c.nodeWidth?c.nodeWidth*B:960,y=c.nodeHeight?c.nodeHeight*B:500,S=r,v=y+h;g.attr("viewBox",`0 0 ${S} ${v}`),we(g,v,S,c.useMaxWidth);let f;try{const t=c.valueFormat||",";if(t==="$0,0")f=C(i=>"$"+I(",")(i),"valueFormat");else if(t.startsWith("$")&&t.includes(",")){const i=/\.\d+/.exec(t),m=i?i[0]:"";f=C(w=>"$"+I(","+m)(w),"valueFormat")}else if(t.startsWith("$")){const i=t.substring(1);f=C(m=>"$"+I(i||"")(m),"valueFormat")}else f=I(t)}catch(t){Q.error("Error creating format function:",t),f=I(",")}const x=Z().range(["transparent",s.cScale0,s.cScale1,s.cScale2,s.cScale3,s.cScale4,s.cScale5,s.cScale6,s.cScale7,s.cScale8,s.cScale9,s.cScale10,s.cScale11]),A=Z().range(["transparent",s.cScalePeer0,s.cScalePeer1,s.cScalePeer2,s.cScalePeer3,s.cScalePeer4,s.cScalePeer5,s.cScalePeer6,s.cScalePeer7,s.cScalePeer8,s.cScalePeer9,s.cScalePeer10,s.cScalePeer11]),k=Z().range([s.cScaleLabel0,s.cScaleLabel1,s.cScaleLabel2,s.cScaleLabel3,s.cScaleLabel4,s.cScaleLabel5,s.cScaleLabel6,s.cScaleLabel7,s.cScaleLabel8,s.cScaleLabel9,s.cScaleLabel10,s.cScaleLabel11]);u&&g.append("text").attr("x",S/2).attr("y",h/2).attr("class","treemapTitle").attr("text-anchor","middle").attr("dominant-baseline","middle").text(u);const V=g.append("g").attr("transform",`translate(0, ${h})`).attr("class","treemapContainer"),R=ee(p).sum(t=>{var i;return(i=t.value)!=null?i:0}).sort((t,i)=>{var m,w;return((m=i.value)!=null?m:0)-((w=t.value)!=null?w:0)}),te=it().size([r,y]).paddingTop(t=>t.children&&t.children.length>0?q+B:0).paddingInner(d).paddingLeft(t=>t.children&&t.children.length>0?B:0).paddingRight(t=>t.children&&t.children.length>0?B:0).paddingBottom(t=>t.children&&t.children.length>0?B:0).round(!0)(R),ue=te.descendants().filter(t=>t.children&&t.children.length>0),E=V.selectAll(".treemapSection").data(ue).enter().append("g").attr("class","treemapSection").attr("transform",t=>`translate(${t.x0},${t.y0})`);E.append("rect").attr("width",t=>t.x1-t.x0).attr("height",q).attr("class","treemapSectionHeader").attr("fill","none").attr("fill-opacity",.6).attr("stroke-width",.6).attr("style",t=>t.depth===0?"display: none;":""),E.append("clipPath").attr("id",(t,i)=>`clip-section-${a}-${i}`).append("rect").attr("width",t=>Math.max(0,t.x1-t.x0-12)).attr("height",q),E.append("rect").attr("width",t=>t.x1-t.x0).attr("height",t=>t.y1-t.y0).attr("class",(t,i)=>`treemapSection section${i}`).attr("fill",t=>x(t.data.name)).attr("fill-opacity",.6).attr("stroke",t=>A(t.data.name)).attr("stroke-width",2).attr("stroke-opacity",.4).attr("style",t=>{if(t.depth===0)return"display: none;";const i=P({cssCompiledStyles:t.data.cssCompiledStyles});return i.nodeStyles+";"+i.borderStyles.join(";")}),E.append("text").attr("class","treemapSectionLabel").attr("x",6).attr("y",q/2).attr("dominant-baseline","middle").text(t=>t.depth===0?"":t.data.name).attr("font-weight","bold").attr("style",t=>{if(t.depth===0)return"display: none;";const i="dominant-baseline: middle; font-size: 12px; fill:"+k(t.data.name)+"; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;",m=P({cssCompiledStyles:t.data.cssCompiledStyles});return i+m.labelStyles.replace("color:","fill:")}).each(function(t){if(t.depth===0)return;const i=j(this),m=t.data.name;i.text(m);const w=t.x1-t.x0,$=6;let F;c.showValues!==!1&&t.value?F=w-10-30-10-$:F=w-$-6;const _=Math.max(15,F),b=i.node();if(b.getComputedTextLength()>_){const T="...";let L=m;for(;L.length>0;){if(L=m.substring(0,L.length-1),L.length===0){i.text(T),b.getComputedTextLength()>_&&i.text("");break}if(i.text(L+T),b.getComputedTextLength()<=_)break}}}),c.showValues!==!1&&E.append("text").attr("class","treemapSectionValue").attr("x",t=>t.x1-t.x0-10).attr("y",q/2).attr("text-anchor","end").attr("dominant-baseline","middle").text(t=>t.value?f(t.value):"").attr("font-style","italic").attr("style",t=>{if(t.depth===0)return"display: none;";const i="text-anchor: end; dominant-baseline: middle; font-size: 10px; fill:"+k(t.data.name)+"; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;",m=P({cssCompiledStyles:t.data.cssCompiledStyles});return i+m.labelStyles.replace("color:","fill:")});const pe=te.leaves(),X=V.selectAll(".treemapLeafGroup").data(pe).enter().append("g").attr("class",(t,i)=>`treemapNode treemapLeafGroup leaf${i}${t.data.classSelector?` ${t.data.classSelector}`:""}x`).attr("transform",t=>`translate(${t.x0},${t.y0})`);X.append("rect").attr("width",t=>t.x1-t.x0).attr("height",t=>t.y1-t.y0).attr("class","treemapLeaf").attr("fill",t=>t.parent?x(t.parent.data.name):x(t.data.name)).attr("style",t=>P({cssCompiledStyles:t.data.cssCompiledStyles}).nodeStyles).attr("fill-opacity",.3).attr("stroke",t=>t.parent?x(t.parent.data.name):x(t.data.name)).attr("stroke-width",3),X.append("clipPath").attr("id",(t,i)=>`clip-${a}-${i}`).append("rect").attr("width",t=>Math.max(0,t.x1-t.x0-4)).attr("height",t=>Math.max(0,t.y1-t.y0-4)),X.append("text").attr("class","treemapLabel").attr("x",t=>(t.x1-t.x0)/2).attr("y",t=>(t.y1-t.y0)/2).attr("style",t=>{const i="text-anchor: middle; dominant-baseline: middle; font-size: 38px;fill:"+k(t.data.name)+";",m=P({cssCompiledStyles:t.data.cssCompiledStyles});return i+m.labelStyles.replace("color:","fill:")}).attr("clip-path",(t,i)=>`url(#clip-${a}-${i})`).text(t=>t.data.name).each(function(t){const i=j(this),m=t.x1-t.x0,w=t.y1-t.y0,$=i.node(),F=4,D=m-2*F,_=w-2*F;if(D<10||_<10){i.style("display","none");return}let b=parseInt(i.style("font-size"),10);const M=8,T=28,L=.6,z=6,W=2;for(;$.getComputedTextLength()>D&&b>M;)b--,i.style("font-size",`${b}px`);let H=Math.max(z,Math.min(T,Math.round(b*L))),K=b+W+H;for(;K>_&&b>M&&(b--,H=Math.max(z,Math.min(T,Math.round(b*L))),!(H<z&&b===M));)i.style("font-size",`${b}px`),K=b+W+H;i.style("font-size",`${b}px`),($.getComputedTextLength()>D||b<M||_<b)&&i.style("display","none")}),c.showValues!==!1&&X.append("text").attr("class","treemapValue").attr("x",i=>(i.x1-i.x0)/2).attr("y",function(i){return(i.y1-i.y0)/2}).attr("style",i=>{const m="text-anchor: middle; dominant-baseline: hanging; font-size: 28px;fill:"+k(i.data.name)+";",w=P({cssCompiledStyles:i.data.cssCompiledStyles});return m+w.labelStyles.replace("color:","fill:")}).attr("clip-path",(i,m)=>`url(#clip-${a}-${m})`).text(i=>i.value?f(i.value):"").each(function(i){const m=j(this),w=this.parentNode;if(!w){m.style("display","none");return}const $=j(w).select(".treemapLabel");if($.empty()||$.style("display")==="none"){m.style("display","none");return}const F=parseFloat($.style("font-size")),D=28,_=.6,b=6,M=2,T=Math.max(b,Math.min(D,Math.round(F*_)));m.style("font-size",`${T}px`);const z=(i.y1-i.y0)/2+F/2+M;m.attr("y",z);const W=i.x1-i.x0,me=i.y1-i.y0-4,ge=W-2*4;m.node().getComputedTextLength()>ge||z+T>me||T<b?m.style("display","none"):m.style("display",null)});const fe=(ne=c.diagramPadding)!=null?ne:8;xe(g,fe,"flowchart",(c==null?void 0:c.useMaxWidth)||!1)},"draw"),ut=C(function(e,a){return a.db.getClasses()},"getClasses"),pt={draw:ht,getClasses:ut},ft={sectionStrokeColor:"black",sectionStrokeWidth:"1",sectionFillColor:"#efefef",leafStrokeColor:"black",leafStrokeWidth:"1",leafFillColor:"#efefef",labelColor:"black",labelFontSize:"12px",valueFontSize:"10px",valueColor:"black",titleColor:"black",titleFontSize:"14px"},mt=C(({treemap:e}={})=>{const a=ie(ft,e);return`
  .treemapNode.section {
    stroke: ${a.sectionStrokeColor};
    stroke-width: ${a.sectionStrokeWidth};
    fill: ${a.sectionFillColor};
  }
  .treemapNode.leaf {
    stroke: ${a.leafStrokeColor};
    stroke-width: ${a.leafStrokeWidth};
    fill: ${a.leafFillColor};
  }
  .treemapLabel {
    fill: ${a.labelColor};
    font-size: ${a.labelFontSize};
  }
  .treemapValue {
    fill: ${a.valueColor};
    font-size: ${a.valueFontSize};
  }
  .treemapTitle {
    fill: ${a.titleColor};
    font-size: ${a.titleFontSize};
  }
  `},"getStyles"),gt=mt,Nt={parser:he,get db(){return new ce},renderer:pt,styles:gt};export{Nt as diagram};
