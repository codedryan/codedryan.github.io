var Il=Object.defineProperty,Vl=Object.defineProperties;var Ol=Object.getOwnPropertyDescriptors;var mt=Object.getOwnPropertySymbols;var wl=Object.prototype.hasOwnProperty,Tl=Object.prototype.propertyIsEnumerable;var vt=(e,a,o)=>a in e?Il(e,a,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[a]=o,Q=(e,a)=>{for(var o in a||(a={}))wl.call(a,o)&&vt(e,o,a[o]);if(mt)for(var o of mt(a))Tl.call(a,o)&&vt(e,o,a[o]);return e},ee=(e,a)=>Vl(e,Ol(a));import{an as Xe,ao as ye,bm as Mt,df as Cl,aG as El,bB as ht,bn as A,bq as Ml,ce as Nl,bA as kl,bo as Je,ax as P,bs as Nt,dg as Rl,bv as kt,bx as Rt,c2 as Y,br as Ll,dh as zl,cf as $l,di as Dl,c1 as ie,dj as Bl,d as je,cI as ve,X as he,dk as Fl,bQ as Hl,V as Al,aq as Pl}from"./bootstrap-Bf65uz2I.js";import{b as Ee,c as Wl,E as Kl}from"./index-CMBjNRIa.js";import{t as gt,E as Ul}from"./index-DGdiZ7pE.js";import{k as Re,m as K,n as E,y as q,z as ge,s as I,x as W,q as N,i as Lt,r as M,c as m,w as ae,u as Me,J as U,D as bt,aj as be,aF as Gl,G as Ze,b as le,d as Ne,ag as yt,o as jl,A as X,T as ke,H as Ql,I as Qe,E as R,a7 as ql,ap as Zl,aq as Xl,p as J,B as te,F as St,N as It,L as Vt,V as qe,ae as Ot,X as Jl}from"../jse/index-index-D3Xb8oT_.js";import{d as Yl,u as Le,M as xl,f as _l,a as ea,B as ta}from"./useProps-DNCnrLfW.js";import{u as la}from"./index-bT9OJj6t.js";import{C as zt,U as $t}from"./event-BB_Ol6Sd.js";import{c as aa,i as wt,F as na}from"./fixed-size-list-CZoudG9a.js";import{A as Tt,C as Ct,E as oa,f as sa,g as ia,D as ra}from"./use-wheel-C9oFsIdW.js";import{u as ua,a as da}from"./use-form-item-DVWmmqeW.js";import{a as ca,u as fa}from"./index-m1ZP1zbM.js";import{e as pa}from"./strings-CGsg9AfI.js";import{u as ma}from"./use-form-common-props-IzjzSHax.js";import{C as va}from"./index-pv0R11Cf.js";import{u as ha}from"./index-Bxb6QITi.js";import"./index-B3qAv2kq.js";import"./aria-DEUWDJ1E.js";import"./_baseFindIndex-D7XfJLKM.js";import"./_baseIteratee-rJjBrWyx.js";import"./_overRest-Bb9G3v08.js";import"./util-B2mB0_6C.js";import"./raf-BVBe43_O.js";const ga=Re({props:{item:{type:Object,required:!0},style:{type:Object},height:Number},setup(){return{ns:ye("select")}}});function ba(e,a,o,s,c,u){return E(),K("div",{class:I(e.ns.be("group","title")),style:ge(ee(Q({},e.style),{lineHeight:`${e.height}px`}))},q(e.item.label),7)}var ya=Xe(ga,[["render",ba],["__file","group-item.vue"]]);function Sa(e,{emit:a}){return{hoverItem:()=>{e.disabled||a("hover",e.index)},selectOptionClick:()=>{e.disabled||a("select",e.item,e.index)}}}const Ia=Mt(Q(Q({allowCreate:Boolean,autocomplete:{type:A(String),default:"none"},automaticDropdown:Boolean,clearable:Boolean,clearIcon:{type:ht,default:Nl},effect:{type:A(String),default:"light"},collapseTags:Boolean,collapseTagsTooltip:Boolean,maxCollapseTags:{type:Number,default:1},defaultFirstOption:Boolean,disabled:Boolean,estimatedOptionHeight:{type:Number,default:void 0},filterable:Boolean,filterMethod:{type:A(Function)},height:{type:Number,default:274},itemHeight:{type:Number,default:34},id:String,loading:Boolean,loadingText:String,modelValue:{type:A([Array,String,Number,Boolean,Object]),default:void 0},multiple:Boolean,multipleLimit:{type:Number,default:0},name:String,noDataText:String,noMatchText:String,remoteMethod:{type:A(Function)},reserveKeyword:{type:Boolean,default:!0},options:{type:A(Array),required:!0},placeholder:{type:String},teleported:Ee.teleported,persistent:{type:Boolean,default:!0},popperClass:Ee.popperClass,popperStyle:Ee.popperStyle,popperOptions:{type:A(Object),default:()=>({})},remote:Boolean,debounce:{type:Number,default:300},size:Ml,props:{type:A(Object),default:()=>Yl},valueKey:{type:String,default:"value"},scrollbarAlwaysOn:Boolean,validateEvent:{type:Boolean,default:!0},offset:{type:Number,default:12},showArrow:{type:Boolean,default:!0},placement:{type:A(String),values:Wl,default:"bottom-start"},fallbackPlacements:{type:A(Array),default:["bottom-start","top-start","right","left"]},tagType:ee(Q({},gt.type),{default:"info"}),tagEffect:ee(Q({},gt.effect),{default:"light"}),tabindex:{type:[String,Number],default:0},appendTo:Ee.appendTo,fitInputWidth:{type:[Boolean,Number],default:!0,validator(e){return kl(e)||Je(e)}},suffixIcon:{type:ht,default:El}},Cl),la(["ariaLabel"]))),Va=Mt({data:Array,disabled:Boolean,hovering:Boolean,item:{type:A(Object),required:!0},index:Number,style:Object,selected:Boolean,created:Boolean}),Oa={[$t]:e=>!0,[zt]:e=>!0,"remove-tag":e=>!0,"visible-change":e=>!0,focus:e=>e instanceof FocusEvent,blur:e=>e instanceof FocusEvent,clear:()=>!0},wa={hover:e=>Je(e),select:(e,a)=>!0},Ye=Symbol("ElSelectV2Injection"),Ta=Re({props:Va,emits:wa,setup(e,{emit:a}){const o=Lt(Ye),s=ye("select"),{hoverItem:c,selectOptionClick:u}=Sa(e,{emit:a}),{getLabel:f}=Le(o.props),v=o.contentId;return{ns:s,contentId:v,hoverItem:c,selectOptionClick:u,getLabel:f}}});function Ca(e,a,o,s,c,u){return E(),K("li",{id:`${e.contentId}-${e.index}`,role:"option","aria-selected":e.selected,"aria-disabled":e.disabled||void 0,style:ge(e.style),class:I([e.ns.be("dropdown","item"),e.ns.is("selected",e.selected),e.ns.is("disabled",e.disabled),e.ns.is("created",e.created),e.ns.is("hovering",e.hovering)]),onMousemove:e.hoverItem,onClick:P(e.selectOptionClick,["stop"])},[W(e.$slots,"default",{item:e.item,index:e.index,disabled:e.disabled},()=>[N("span",null,q(e.getLabel(e.item)),1)])],46,["id","aria-selected","aria-disabled","onMousemove","onClick"])}var Ea=Xe(Ta,[["render",Ca],["__file","option-item.vue"]]);const re=(e,a,o)=>{const{itemSize:s}=e,{items:c,lastVisitedIndex:u}=o;if(a>u){let f=0;if(u>=0){const v=c[u];f=v.offset+v.size}for(let v=u+1;v<=a;v++){const b=s(v);c[v]={offset:f,size:b},f+=b}o.lastVisitedIndex=a}return c[a]},Ma=(e,a,o)=>{const{items:s,lastVisitedIndex:c}=a;return(c>0?s[c].offset:0)>=o?Dt(e,a,0,c,o):Na(e,a,Math.max(0,c),o)},Dt=(e,a,o,s,c)=>{for(;o<=s;){const u=o+Math.floor((s-o)/2),f=re(e,u,a).offset;if(f===c)return u;f<c?o=u+1:f>c&&(s=u-1)}return Math.max(0,o-1)},Na=(e,a,o,s)=>{const{total:c}=e;let u=1;for(;o<c&&re(e,o,a).offset<s;)o+=u,u*=2;return Dt(e,a,Math.floor(o/2),Math.min(o,c-1),s)},Et=({total:e},{items:a,estimatedItemSize:o,lastVisitedIndex:s})=>{let c=0;if(s>=e&&(s=e-1),s>=0){const v=a[s];c=v.offset+v.size}const f=(e-s-1)*o;return c+f},ka=aa({name:"ElDynamicSizeList",getItemOffset:(e,a,o)=>re(e,a,o).offset,getItemSize:(e,a,{items:o})=>o[a].size,getEstimatedTotalSize:Et,getOffset:(e,a,o,s,c)=>{const{height:u,layout:f,width:v}=e,b=wt(f)?v:u,y=re(e,a,c),S=Et(e,c),g=Math.max(0,Math.min(S-b,y.offset)),O=Math.max(0,y.offset-b+y.size);switch(o===ia&&(s>=O-b&&s<=g+b?o=Tt:o=Ct),o){case sa:return g;case oa:return O;case Ct:return Math.round(O+(g-O)/2);case Tt:default:return s>=O&&s<=g?s:s<O?O:g}},getStartIndexForOffset:(e,a,o)=>Ma(e,o,a),getStopIndexForStartIndex:(e,a,o,s)=>{const{height:c,total:u,layout:f,width:v}=e,b=wt(f)?v:c,y=re(e,a,s),S=o+b;let g=y.offset+y.size,O=a;for(;O<u-1&&g<S;)O++,g+=re(e,O,s).size;return O},initCache({estimatedItemSize:e=ra},a){const o={items:{},estimatedItemSize:e,lastVisitedIndex:-1};return o.clearCacheAfterIndex=(s,c=!0)=>{var u,f;o.lastVisitedIndex=Math.min(o.lastVisitedIndex,s-1),(u=a.exposed)==null||u.getItemStyleCache(-1),c&&((f=a.proxy)==null||f.$forceUpdate())},o},clearCache:!1,validateProps:({itemSize:e})=>{}}),Ra={loading:Boolean,data:{type:Array,required:!0},hoveringIndex:Number,width:Number,id:String,ariaLabel:String};var La=Re({name:"ElSelectDropdown",props:Ra,setup(e,{slots:a,expose:o}){const s=Lt(Ye),c=ye("select"),{getLabel:u,getValue:f,getDisabled:v}=Le(s.props),b=M([]),y=M(),S=m(()=>e.data.length);ae(()=>S.value,()=>{var p,h;(h=(p=s.tooltipRef.value)==null?void 0:p.updatePopper)==null||h.call(p)});const g=m(()=>Nt(s.props.estimatedOptionHeight)),O=m(()=>g.value?{itemSize:s.props.itemHeight}:{estimatedSize:s.props.estimatedOptionHeight,itemSize:p=>b.value[p]}),d=(p=[],h)=>{const{props:{valueKey:k}}=s;return be(h)?p&&p.some(D=>Gl(Y(D,k))===Y(h,k)):p.includes(h)},V=(p,h)=>{if(be(h)){const{valueKey:k}=s.props;return Y(p,k)===Y(h,k)}else return p===h},l=(p,h)=>s.props.multiple?d(p,f(h)):V(p,f(h)),x=(p,h)=>{const{disabled:k,multiple:D,multipleLimit:B}=s.props;return k||!h&&(D?B>0&&p.length>=B:!1)},ne=p=>e.hoveringIndex===p;o({listRef:y,isSized:g,isItemDisabled:x,isItemHovering:ne,isItemSelected:l,scrollToItem:p=>{const h=y.value;h&&h.scrollToItem(p)},resetScrollTop:()=>{const p=y.value;p&&p.resetScrollTop()}});const de=p=>{const{index:h,data:k,style:D}=p,B=Me(g),{itemSize:L,estimatedSize:j}=Me(O),{modelValue:H}=s.props,{onSelect:ce,onHover:se}=s,z=k[h];if(z.type==="Group")return U(ya,{item:z,style:D,height:B?L:j},null);const w=l(H,z),T=x(H,w),De=ne(h);return U(Ea,bt(p,{selected:w,disabled:v(z)||T,created:!!z.created,hovering:De,item:z,onSelect:ce,onHover:se}),{default:Be=>{var _;return((_=a.default)==null?void 0:_.call(a,Be))||U("span",null,[u(z)])}})},{onKeyboardNavigate:G,onKeyboardSelect:ze}=s,$e=()=>{G("forward")},Z=()=>{G("backward")},Ie=p=>{const h=kt(p),{tab:k,esc:D,down:B,up:L,enter:j,numpadEnter:H}=Rt;switch([D,B,L,j,H].includes(h)&&(p.preventDefault(),p.stopPropagation()),h){case k:case D:break;case B:$e();break;case L:Z();break;case j:case H:ze();break}};return()=>{var p,h,k,D;const{data:B,width:L}=e,{height:j,multiple:H,scrollbarAlwaysOn:ce}=s.props,se=m(()=>Rl?!0:ce),z=Me(g)?na:ka;return U("div",{class:[c.b("dropdown"),c.is("multiple",H)],style:{width:`${L}px`}},[(p=a.header)==null?void 0:p.call(a),((h=a.loading)==null?void 0:h.call(a))||((k=a.empty)==null?void 0:k.call(a))||U(z,bt({ref:y},Me(O),{className:c.be("dropdown","list"),scrollbarAlwaysOn:se.value,data:B,height:j,width:L,total:B.length,innerElement:"ul",innerProps:{id:e.id,role:"listbox","aria-label":e.ariaLabel,"aria-orientation":"vertical"},onKeydown:Ie}),{default:w=>U(de,w,null)}),(D=a.footer)==null?void 0:D.call(a)])}}});function za(e,a){const{aliasProps:o,getLabel:s,getValue:c}=Le(e),u=M(0),f=M(),v=m(()=>e.allowCreate&&e.filterable);ae(()=>e.options,d=>{const V=new Set(d.map(l=>s(l)));a.createdOptions=a.createdOptions.filter(l=>!V.has(s(l)))});function b(d){const V=l=>s(l)===d;return e.options&&e.options.some(V)||a.createdOptions.some(V)}function y(d){v.value&&(e.multiple&&d.created?u.value++:f.value=d)}function S(d){if(v.value)if(d&&d.length>0){if(b(d)){a.createdOptions=a.createdOptions.filter(l=>s(l)!==a.previousQuery);return}const V={[o.value.value]:d,[o.value.label]:d,created:!0,[o.value.disabled]:!1};a.createdOptions.length>=u.value?a.createdOptions[u.value]=V:a.createdOptions.push(V)}else if(e.multiple)a.createdOptions.length=u.value;else{const V=f.value;a.createdOptions.length=0,V&&V.created&&a.createdOptions.push(V)}}function g(d){if(!v.value||!d||!d.created||d.created&&e.reserveKeyword&&a.inputValue===s(d))return;const V=a.createdOptions.findIndex(l=>c(l)===c(d));~V&&(a.createdOptions.splice(V,1),u.value--)}function O(){v.value&&(a.createdOptions.length=0,u.value=0)}return{createNewOption:S,removeNewOption:g,selectNewOption:y,clearAllNewOption:O}}const $a=(e,a)=>{const{t:o}=Ll(),s=ye("select"),c=ye("input"),{form:u,formItem:f}=ua(),{inputId:v}=da(e,{formItemContext:f}),{aliasProps:b,getLabel:y,getValue:S,getDisabled:g,getOptions:O}=Le(e),{valueOnClear:d,isEmptyValue:V}=zl(e),l=Ze({inputValue:"",cachedOptions:[],createdOptions:[],hoveringIndex:-1,inputHovering:!1,selectionWidth:0,collapseItemWidth:0,previousQuery:null,previousValue:void 0,selectedLabel:"",menuVisibleOnFocus:!1,isBeforeHide:!1}),x=M(-1),ne=M(!1),Se=M(),oe=M(),ue=M(),de=M(),G=M(),ze=M(),$e=M(),Z=M(),Ie=M(),p=M(),{isComposing:h,handleCompositionStart:k,handleCompositionEnd:D,handleCompositionUpdate:B}=ca({afterComposition:t=>ft(t)}),L=m(()=>e.disabled||!!(u!=null&&u.disabled)),{wrapperRef:j,isFocused:H,handleBlur:ce}=fa(G,{disabled:L,afterFocus(){e.automaticDropdown&&!T.value&&(T.value=!0,l.menuVisibleOnFocus=!0)},beforeBlur(t){var n,i;return((n=ue.value)==null?void 0:n.isFocusInsideContent(t))||((i=de.value)==null?void 0:i.isFocusInsideContent(t))},afterBlur(){var t;T.value=!1,l.menuVisibleOnFocus=!1,e.validateEvent&&((t=f==null?void 0:f.validate)==null||t.call(f,"blur").catch(n=>je(n)))}}),se=m(()=>et("")),z=m(()=>e.loading?!1:e.options.length>0||l.createdOptions.length>0),w=M([]),T=M(!1),De=m(()=>{var t;return(t=u==null?void 0:u.statusIcon)!=null?t:!1}),Be=m(()=>{const t=w.value.length*e.itemHeight;return t>e.height?e.height:t}),_=m(()=>e.multiple?le(e.modelValue)&&e.modelValue.length>0:!V(e.modelValue)),Bt=m(()=>e.clearable&&!L.value&&_.value&&(H.value||l.inputHovering)),xe=m(()=>e.remote&&e.filterable?"":e.suffixIcon),Ft=m(()=>xe.value&&s.is("reverse",T.value)),Fe=m(()=>(f==null?void 0:f.validateState)||""),Ht=m(()=>{if(Fe.value)return $l[Fe.value]}),_e=m(()=>e.remote?e.debounce:0),At=m(()=>e.remote&&!l.inputValue&&!z.value),Pt=m(()=>e.loading?e.loadingText||o("el.select.loading"):e.filterable&&l.inputValue&&z.value&&w.value.length===0?e.noMatchText||o("el.select.noMatch"):z.value?null:e.noDataText||o("el.select.noData")),Wt=m(()=>e.filterable&&Ne(e.filterMethod)),Kt=m(()=>e.filterable&&e.remote&&Ne(e.remoteMethod)),et=t=>{const n=new RegExp(pa(t),"i"),i=r=>Wt.value||Kt.value?!0:t?n.test(y(r)||""):!0;return e.loading?[]:[...l.createdOptions,...e.options].reduce((r,C)=>{const F=O(C);if(le(F)){const me=F.filter(i);me.length>0&&r.push({label:y(C),type:"Group"},...me)}else(e.remote||i(C))&&r.push(C);return r},[])},tt=()=>{w.value=et(l.inputValue)},Ve=m(()=>{const t=new Map;return se.value.forEach((n,i)=>{t.set($(S(n)),{option:n,index:i})}),t}),Oe=m(()=>{const t=new Map;return w.value.forEach((n,i)=>{t.set($(S(n)),{option:n,index:i})}),t}),Ut=m(()=>w.value.every(t=>g(t))),lt=ma(),Gt=m(()=>lt.value==="small"?"small":"default"),fe=()=>{var t;if(Je(e.fitInputWidth)){x.value=e.fitInputWidth;return}const n=((t=Se.value)==null?void 0:t.offsetWidth)||200;!e.fitInputWidth&&z.value?X(()=>{x.value=Math.max(n,jt())}):x.value=n},jt=()=>{var t,n;const r=document.createElement("canvas").getContext("2d"),C=s.be("dropdown","item"),me=(((n=(t=Z.value)==null?void 0:t.listRef)==null?void 0:n.innerRef)||document).querySelector(`.${C}`);if(me===null||r===null)return 0;const Ce=getComputedStyle(me),gl=Number.parseFloat(Ce.paddingLeft)+Number.parseFloat(Ce.paddingRight);return r.font=`bold ${Ce.font.replace(new RegExp(`\\b${Ce.fontWeight}\\b`),"")}`,w.value.reduce((bl,yl)=>{const Sl=r.measureText(y(yl));return Math.max(Sl.width,bl)},0)+gl},Qt=()=>{if(!oe.value)return 0;const t=window.getComputedStyle(oe.value);return Number.parseFloat(t.gap||"6px")},qt=m(()=>{const t=Qt(),n=e.filterable?t+xl:0;return{maxWidth:`${p.value&&e.maxCollapseTags===1?l.selectionWidth-l.collapseItemWidth-t-n:l.selectionWidth-n}px`}}),Zt=m(()=>({maxWidth:`${l.selectionWidth}px`})),Xt=m(()=>le(e.modelValue)?e.modelValue.length===0&&!l.inputValue:e.filterable?!l.inputValue:!0),Jt=m(()=>{var t;const n=(t=e.placeholder)!=null?t:o("el.select.placeholder");return e.multiple||!_.value?n:l.selectedLabel}),Yt=m(()=>{var t,n;return(n=(t=ue.value)==null?void 0:t.popperRef)==null?void 0:n.contentRef}),xt=m(()=>{if(e.multiple){const t=e.modelValue.length;if(e.modelValue.length>0&&Oe.value.has(e.modelValue[t-1])){const{index:n}=Oe.value.get(e.modelValue[t-1]);return n}}else if(!V(e.modelValue)&&Oe.value.has(e.modelValue)){const{index:t}=Oe.value.get(e.modelValue);return t}return-1}),_t=m({get(){return T.value&&(e.loading||!At.value)&&(!ne.value||!Dl(l.previousQuery))},set(t){T.value=t}}),el=m(()=>e.multiple?e.collapseTags?l.cachedOptions.slice(0,e.maxCollapseTags):l.cachedOptions:[]),tl=m(()=>e.multiple?e.collapseTags?l.cachedOptions.slice(e.maxCollapseTags):[]:[]),{createNewOption:at,removeNewOption:He,selectNewOption:nt,clearAllNewOption:Ae}=za(e,l),Pe=()=>{L.value||(l.menuVisibleOnFocus?l.menuVisibleOnFocus=!1:T.value=!T.value)},ot=()=>{l.inputValue.length>0&&!T.value&&(T.value=!0),at(l.inputValue),X(()=>{We(l.inputValue)})},st=Bl(()=>{ot(),ne.value=!1},_e),We=t=>{l.previousQuery===t||h.value||(l.previousQuery=t,e.filterable&&Ne(e.filterMethod)?e.filterMethod(t):e.filterable&&e.remote&&Ne(e.remoteMethod)&&e.remoteMethod(t),e.defaultFirstOption&&(e.filterable||e.remote)&&w.value.length?X(ll):X(pl))},ll=()=>{const t=w.value.filter(r=>!r.disabled&&r.type!=="Group"),n=t.find(r=>r.created),i=t[0];l.hoveringIndex=Ke(w.value,n||i)},al=t=>{ve(e.modelValue,t)||a(zt,t)},pe=t=>{a($t,t),al(t),l.previousValue=e.multiple?String(t):t,X(()=>{if(e.multiple&&le(e.modelValue)){const n=l.cachedOptions.slice(),i=e.modelValue.map(r=>pt(r,n));ve(l.cachedOptions,i)||(l.cachedOptions=i)}else Te(!0)})},Ke=(t=[],n)=>{if(!be(n))return t.indexOf(n);const i=e.valueKey;let r=-1;return t.some((C,F)=>Y(C,i)===Y(n,i)?(r=F,!0):!1),r},$=t=>be(t)?Y(t,e.valueKey):t,it=()=>{fe()},rt=()=>{l.selectionWidth=Number.parseFloat(window.getComputedStyle(oe.value).width)},nl=()=>{l.collapseItemWidth=p.value.getBoundingClientRect().width},Ue=()=>{var t,n;(n=(t=ue.value)==null?void 0:t.updatePopper)==null||n.call(t)},ut=()=>{var t,n;(n=(t=de.value)==null?void 0:t.updatePopper)==null||n.call(t)},dt=t=>{const n=S(t);if(e.multiple){let i=e.modelValue.slice();const r=Ke(i,n);r>-1?(i=[...i.slice(0,r),...i.slice(r+1)],l.cachedOptions.splice(r,1),He(t)):(e.multipleLimit<=0||i.length<e.multipleLimit)&&(i=[...i,n],l.cachedOptions.push(t),nt(t)),pe(i),t.created&&We(""),e.filterable&&!e.reserveKeyword&&(l.inputValue="")}else l.selectedLabel=y(t),!ve(e.modelValue,n)&&pe(n),T.value=!1,nt(t),t.created||Ae();we()},ol=(t,n)=>{let i=e.modelValue.slice();const r=Ke(i,S(n));r>-1&&!L.value&&(i=[...e.modelValue.slice(0,r),...e.modelValue.slice(r+1)],l.cachedOptions.splice(r,1),pe(i),a("remove-tag",S(n)),He(n)),t.stopPropagation(),we()},we=()=>{var t;(t=G.value)==null||t.focus()},sl=()=>{var t;if(T.value){T.value=!1,X(()=>{var n;return(n=G.value)==null?void 0:n.blur()});return}(t=G.value)==null||t.blur()},il=()=>{l.inputValue.length>0?l.inputValue="":T.value=!1},rl=t=>_l(t,n=>!l.cachedOptions.some(i=>S(i)===n&&g(i))),ul=t=>{const n=kt(t);if(e.multiple&&n!==Rt.delete&&l.inputValue.length===0){t.preventDefault();const i=e.modelValue.slice(),r=rl(i);if(r<0)return;const C=i[r];i.splice(r,1);const F=l.cachedOptions[r];l.cachedOptions.splice(r,1),He(F),pe(i),a("remove-tag",C)}},dl=()=>{let t;le(e.modelValue)?t=[]:t=d.value,l.selectedLabel="",T.value=!1,pe(t),a("clear"),Ae(),we()},ct=(t,n=void 0)=>{const i=w.value;if(!["forward","backward"].includes(t)||L.value||i.length<=0||Ut.value||h.value)return;if(!T.value)return Pe();Nt(n)&&(n=l.hoveringIndex);let r=-1;t==="forward"?(r=n+1,r>=i.length&&(r=0)):t==="backward"&&(r=n-1,(r<0||r>=i.length)&&(r=i.length-1));const C=i[r];if(g(C)||C.type==="Group")return ct(t,r);l.hoveringIndex=r,Ge(r)},cl=()=>{if(T.value)~l.hoveringIndex&&w.value[l.hoveringIndex]&&dt(w.value[l.hoveringIndex]);else return Pe()},fl=t=>{l.hoveringIndex=t!=null?t:-1},pl=()=>{e.multiple?l.hoveringIndex=w.value.findIndex(t=>e.modelValue.some(n=>$(n)===$(S(t)))):l.hoveringIndex=w.value.findIndex(t=>$(S(t))===$(e.modelValue))},ft=t=>{if(l.inputValue=t.target.value,e.remote)ne.value=!0,st();else return ot()},ml=t=>{if(T.value=!1,H.value){const n=new FocusEvent("blur",t);ce(n)}},vl=()=>(l.isBeforeHide=!1,X(()=>{~xt.value&&Ge(l.hoveringIndex)})),Ge=t=>{Z.value.scrollToItem(t)},pt=(t,n)=>{const i=$(t);if(Ve.value.has(i)){const{option:r}=Ve.value.get(i);return r}if(n&&n.length){const r=n.find(C=>$(S(C))===i);if(r)return r}return{[b.value.value]:t,[b.value.label]:t}},hl=t=>{var n,i;return(i=(n=Ve.value.get(S(t)))==null?void 0:n.index)!=null?i:-1},Te=(t=!1)=>{if(e.multiple)if(e.modelValue.length>0){const n=l.cachedOptions.slice();l.cachedOptions.length=0,l.previousValue=e.modelValue.toString();for(const i of e.modelValue){const r=pt(i,n);l.cachedOptions.push(r)}}else l.cachedOptions=[],l.previousValue=void 0;else if(_.value){l.previousValue=e.modelValue;const n=w.value,i=n.findIndex(r=>$(S(r))===$(e.modelValue));~i?l.selectedLabel=y(n[i]):(!l.selectedLabel||t)&&(l.selectedLabel=$(e.modelValue))}else l.selectedLabel="",l.previousValue=void 0;Ae(),fe()};return ae(()=>e.fitInputWidth,()=>{fe()}),ae(T,t=>{t?(e.persistent||fe(),We("")):(l.inputValue="",l.previousQuery=null,l.isBeforeHide=!0,at("")),a("visible-change",t)}),ae(()=>e.modelValue,(t,n)=>{var i;(!t||le(t)&&t.length===0||e.multiple&&!ve(t.toString(),l.previousValue)||!e.multiple&&$(t)!==$(l.previousValue))&&Te(!0),!ve(t,n)&&e.validateEvent&&((i=f==null?void 0:f.validate)==null||i.call(f,"change").catch(C=>je(C)))},{deep:!0}),ae(()=>e.options,()=>{const t=G.value;(!t||t&&document.activeElement!==t)&&Te()},{deep:!0,flush:"post"}),ae(()=>w.value,()=>(fe(),Z.value&&X(Z.value.resetScrollTop))),yt(()=>{l.isBeforeHide||tt()}),yt(()=>{const{valueKey:t,options:n}=e,i=new Map;for(const r of n){const C=S(r);let F=C;if(be(F)&&(F=Y(C,t)),i.get(F)){je("ElSelectV2","The option values you provided seem to be duplicated, which may cause some problems, please check.");break}else i.set(F,!0)}}),jl(()=>{Te()}),ie(Se,it),ie(oe,rt),ie(Z,Ue),ie(j,Ue),ie(Ie,ut),ie(p,nl),{inputId:v,collapseTagSize:Gt,currentPlaceholder:Jt,expanded:T,emptyText:Pt,popupHeight:Be,debounce:_e,allOptions:se,allOptionsValueMap:Ve,filteredOptions:w,iconComponent:xe,iconReverse:Ft,tagStyle:qt,collapseTagStyle:Zt,popperSize:x,dropdownMenuVisible:_t,hasModelValue:_,shouldShowPlaceholder:Xt,selectDisabled:L,selectSize:lt,needStatusIcon:De,showClearBtn:Bt,states:l,isFocused:H,nsSelect:s,nsInput:c,inputRef:G,menuRef:Z,tagMenuRef:Ie,tooltipRef:ue,tagTooltipRef:de,selectRef:Se,wrapperRef:j,selectionRef:oe,prefixRef:ze,suffixRef:$e,collapseItemRef:p,popperRef:Yt,validateState:Fe,validateIcon:Ht,showTagList:el,collapseTagList:tl,debouncedOnInputChange:st,deleteTag:ol,getLabel:y,getValue:S,getDisabled:g,getValueKey:$,getIndex:hl,handleClear:dl,handleClickOutside:ml,handleDel:ul,handleEsc:il,focus:we,blur:sl,handleMenuEnter:vl,handleResize:it,resetSelectionWidth:rt,updateTooltip:Ue,updateTagTooltip:ut,updateOptions:tt,toggleMenu:Pe,scrollTo:Ge,onInput:ft,onKeyboardNavigate:ct,onKeyboardSelect:cl,onSelect:dt,onHover:fl,handleCompositionStart:k,handleCompositionEnd:D,handleCompositionUpdate:B}},Da=Re({name:"ElSelectV2",components:{ElSelectMenu:La,ElTag:Ul,ElTooltip:Kl,ElIcon:Al},directives:{ClickOutside:va},props:Ia,emits:Oa,setup(e,{emit:a}){const o=m(()=>{const{modelValue:b,multiple:y}=e,S=y?[]:void 0;return le(b)?y?b:S:y?S:b}),s=$a(Ze(ee(Q({},Ot(e)),{modelValue:o})),a),{calculatorRef:c,inputStyle:u}=ea(),f=ha();Jl(Ye,{props:Ze(ee(Q({},Ot(e)),{height:s.popupHeight,modelValue:o})),expanded:s.expanded,tooltipRef:s.tooltipRef,contentId:f,onSelect:s.onSelect,onHover:s.onHover,onKeyboardNavigate:s.onKeyboardNavigate,onKeyboardSelect:s.onKeyboardSelect});const v=m(()=>e.multiple?s.states.cachedOptions.map(b=>s.getLabel(b)):s.states.selectedLabel);return ee(Q({},s),{modelValue:o,selectedLabel:v,calculatorRef:c,inputStyle:u,contentId:f,BORDER_HORIZONTAL_WIDTH:ta})}});function Ba(e,a,o,s,c,u){const f=ke("el-tag"),v=ke("el-tooltip"),b=ke("el-icon"),y=ke("el-select-menu"),S=Ql("click-outside");return Qe((E(),K("div",{ref:"selectRef",class:I([e.nsSelect.b(),e.nsSelect.m(e.selectSize)]),onMouseenter:g=>e.states.inputHovering=!0,onMouseleave:g=>e.states.inputHovering=!1},[U(v,{ref:"tooltipRef",visible:e.dropdownMenuVisible,teleported:e.teleported,"popper-class":[e.nsSelect.e("popper"),e.popperClass],"popper-style":e.popperStyle,"gpu-acceleration":!1,"stop-popper-mouse-event":!1,"popper-options":e.popperOptions,"fallback-placements":e.fallbackPlacements,effect:e.effect,placement:e.placement,pure:"",transition:`${e.nsSelect.namespace.value}-zoom-in-top`,trigger:"click",persistent:e.persistent,"append-to":e.appendTo,"show-arrow":e.showArrow,offset:e.offset,onBeforeShow:e.handleMenuEnter,onHide:g=>e.states.isBeforeHide=!1},{default:R(()=>{var g,O;return[N("div",{ref:"wrapperRef",class:I([e.nsSelect.e("wrapper"),e.nsSelect.is("focused",e.isFocused),e.nsSelect.is("hovering",e.states.inputHovering),e.nsSelect.is("filterable",e.filterable),e.nsSelect.is("disabled",e.selectDisabled)]),onClick:P(e.toggleMenu,["prevent"])},[e.$slots.prefix?(E(),K("div",{key:0,ref:"prefixRef",class:I(e.nsSelect.e("prefix"))},[W(e.$slots,"prefix")],2)):J("v-if",!0),N("div",{ref:"selectionRef",class:I([e.nsSelect.e("selection"),e.nsSelect.is("near",e.multiple&&!e.$slots.prefix&&!!e.modelValue.length)])},[e.multiple?W(e.$slots,"tag",{key:0,data:e.states.cachedOptions,deleteTag:e.deleteTag,selectDisabled:e.selectDisabled},()=>[(E(!0),K(St,null,It(e.showTagList,d=>(E(),K("div",{key:e.getValueKey(e.getValue(d)),class:I(e.nsSelect.e("selected-item"))},[U(f,{closable:!e.selectDisabled&&!e.getDisabled(d),size:e.collapseTagSize,type:e.tagType,effect:e.tagEffect,"disable-transitions":"",style:ge(e.tagStyle),onClose:V=>e.deleteTag(V,d)},{default:R(()=>[N("span",{class:I(e.nsSelect.e("tags-text"))},[W(e.$slots,"label",{index:e.getIndex(d),label:e.getLabel(d),value:e.getValue(d)},()=>[Vt(q(e.getLabel(d)),1)])],2)]),_:2},1032,["closable","size","type","effect","style","onClose"])],2))),128)),e.collapseTags&&e.modelValue.length>e.maxCollapseTags?(E(),te(v,{key:0,ref:"tagTooltipRef",disabled:e.dropdownMenuVisible||!e.collapseTagsTooltip,"fallback-placements":["bottom","top","right","left"],effect:e.effect,placement:"bottom","popper-class":e.popperClass,"popper-style":e.popperStyle,teleported:e.teleported},{default:R(()=>[N("div",{ref:"collapseItemRef",class:I(e.nsSelect.e("selected-item"))},[U(f,{closable:!1,size:e.collapseTagSize,type:e.tagType,effect:e.tagEffect,style:ge(e.collapseTagStyle),"disable-transitions":""},{default:R(()=>[N("span",{class:I(e.nsSelect.e("tags-text"))}," + "+q(e.modelValue.length-e.maxCollapseTags),3)]),_:1},8,["size","type","effect","style"])],2)]),content:R(()=>[N("div",{ref:"tagMenuRef",class:I(e.nsSelect.e("selection"))},[(E(!0),K(St,null,It(e.collapseTagList,d=>(E(),K("div",{key:e.getValueKey(e.getValue(d)),class:I(e.nsSelect.e("selected-item"))},[U(f,{class:"in-tooltip",closable:!e.selectDisabled&&!e.getDisabled(d),size:e.collapseTagSize,type:e.tagType,effect:e.tagEffect,"disable-transitions":"",onClose:V=>e.deleteTag(V,d)},{default:R(()=>[N("span",{class:I(e.nsSelect.e("tags-text"))},[W(e.$slots,"label",{index:e.getIndex(d),label:e.getLabel(d),value:e.getValue(d)},()=>[Vt(q(e.getLabel(d)),1)])],2)]),_:2},1032,["closable","size","type","effect","onClose"])],2))),128))],2)]),_:3},8,["disabled","effect","popper-class","popper-style","teleported"])):J("v-if",!0)]):J("v-if",!0),N("div",{class:I([e.nsSelect.e("selected-item"),e.nsSelect.e("input-wrapper"),e.nsSelect.is("hidden",!e.filterable)])},[Qe(N("input",{id:e.inputId,ref:"inputRef","onUpdate:modelValue":d=>e.states.inputValue=d,style:ge(e.inputStyle),autocomplete:e.autocomplete,tabindex:e.tabindex,"aria-autocomplete":"none","aria-haspopup":"listbox",autocapitalize:"off","aria-expanded":e.expanded,"aria-label":e.ariaLabel,class:I([e.nsSelect.e("input"),e.nsSelect.is(e.selectSize)]),disabled:e.selectDisabled,role:"combobox","aria-controls":e.contentId,"aria-activedescendant":e.states.hoveringIndex>=0?`${e.contentId}-${e.states.hoveringIndex}`:"",readonly:!e.filterable,spellcheck:"false",type:"text",name:e.name,onInput:e.onInput,onCompositionstart:e.handleCompositionStart,onCompositionupdate:e.handleCompositionUpdate,onCompositionend:e.handleCompositionEnd,onKeydown:[he(P(d=>e.onKeyboardNavigate("backward"),["stop","prevent"]),["up"]),he(P(d=>e.onKeyboardNavigate("forward"),["stop","prevent"]),["down"]),he(P(e.onKeyboardSelect,["stop","prevent"]),["enter"]),he(P(e.handleEsc,["stop","prevent"]),["esc"]),he(P(e.handleDel,["stop"]),["delete"])],onClick:P(e.toggleMenu,["stop"])},null,46,["id","onUpdate:modelValue","autocomplete","tabindex","aria-expanded","aria-label","disabled","aria-controls","aria-activedescendant","readonly","name","onInput","onCompositionstart","onCompositionupdate","onCompositionend","onKeydown","onClick"]),[[Fl,e.states.inputValue]]),e.filterable?(E(),K("span",{key:0,ref:"calculatorRef","aria-hidden":"true",class:I(e.nsSelect.e("input-calculator")),textContent:q(e.states.inputValue)},null,10,["textContent"])):J("v-if",!0)],2),e.shouldShowPlaceholder?(E(),K("div",{key:1,class:I([e.nsSelect.e("selected-item"),e.nsSelect.e("placeholder"),e.nsSelect.is("transparent",!e.hasModelValue||e.expanded&&!e.states.inputValue)])},[e.hasModelValue?W(e.$slots,"label",{key:0,index:(O=(g=e.allOptionsValueMap.get(e.modelValue))==null?void 0:g.index)!=null?O:-1,label:e.currentPlaceholder,value:e.modelValue},()=>[N("span",null,q(e.currentPlaceholder),1)]):(E(),K("span",{key:1},q(e.currentPlaceholder),1))],2)):J("v-if",!0)],2),N("div",{ref:"suffixRef",class:I(e.nsSelect.e("suffix"))},[e.iconComponent?Qe((E(),te(b,{key:0,class:I([e.nsSelect.e("caret"),e.nsInput.e("icon"),e.iconReverse])},{default:R(()=>[(E(),te(qe(e.iconComponent)))]),_:1},8,["class"])),[[Hl,!e.showClearBtn]]):J("v-if",!0),e.showClearBtn&&e.clearIcon?(E(),te(b,{key:1,class:I([e.nsSelect.e("caret"),e.nsInput.e("icon"),e.nsSelect.e("clear")]),onClick:P(e.handleClear,["prevent","stop"])},{default:R(()=>[(E(),te(qe(e.clearIcon)))]),_:1},8,["class","onClick"])):J("v-if",!0),e.validateState&&e.validateIcon&&e.needStatusIcon?(E(),te(b,{key:2,class:I([e.nsInput.e("icon"),e.nsInput.e("validateIcon"),e.nsInput.is("loading",e.validateState==="validating")])},{default:R(()=>[(E(),te(qe(e.validateIcon)))]),_:1},8,["class"])):J("v-if",!0)],2)],10,["onClick"])]}),content:R(()=>[U(y,{id:e.contentId,ref:"menuRef",data:e.filteredOptions,width:e.popperSize-e.BORDER_HORIZONTAL_WIDTH,"hovering-index":e.states.hoveringIndex,"scrollbar-always-on":e.scrollbarAlwaysOn,"aria-label":e.ariaLabel},ql({default:R(g=>[W(e.$slots,"default",Zl(Xl(g)))]),_:2},[e.$slots.header?{name:"header",fn:R(()=>[N("div",{class:I(e.nsSelect.be("dropdown","header")),onClick:P(()=>{},["stop"])},[W(e.$slots,"header")],10,["onClick"])])}:void 0,e.$slots.loading&&e.loading?{name:"loading",fn:R(()=>[N("div",{class:I(e.nsSelect.be("dropdown","loading"))},[W(e.$slots,"loading")],2)])}:e.loading||e.filteredOptions.length===0?{name:"empty",fn:R(()=>[N("div",{class:I(e.nsSelect.be("dropdown","empty"))},[W(e.$slots,"empty",{},()=>[N("span",null,q(e.emptyText),1)])],2)])}:void 0,e.$slots.footer?{name:"footer",fn:R(()=>[N("div",{class:I(e.nsSelect.be("dropdown","footer")),onClick:P(()=>{},["stop"])},[W(e.$slots,"footer")],10,["onClick"])])}:void 0]),1032,["id","data","width","hovering-index","scrollbar-always-on","aria-label"])]),_:3},8,["visible","teleported","popper-class","popper-style","popper-options","fallback-placements","effect","placement","transition","persistent","append-to","show-arrow","offset","onBeforeShow","onHide"])],42,["onMouseenter","onMouseleave"])),[[S,e.handleClickOutside,e.popperRef]])}var Fa=Xe(Da,[["render",Ba],["__file","select.vue"]]);const un=Pl(Fa);export{un as ElSelectV2,un as default,Ye as selectV2InjectionKey};
