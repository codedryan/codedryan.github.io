import{$ as e,M as T,R as y,_ as N}from"./bootstrap-Bf65uz2I.js";import"./css-gf8D6QlL.js";import{E as M}from"./el-dialog-CAR1-R4U.js";import"./el-overlay-Zuw8glOl.js";import{E as V}from"./el-message-box-B8o3mhYx.js";import"./css-C9o_OfXA.js";import"./css-BA5xAVBz.js";import{u as F}from"./upload-Deid_RrR.js";import{E as L}from"./index-e0qsk5Ci.js";import{ElButton as g}from"./index-oBOAcXl-.js";import{k as U,o as S,r,B as J,n as R,E as l,J as p,u as t,q as s,y as i,L as v,W as q}from"../jse/index-index-D3Xb8oT_.js";import"./index-B3qAv2kq.js";import"./aria-DEUWDJ1E.js";import"./refs-D6FW0B1r.js";import"./event-BB_Ol6Sd.js";import"./index-Bxb6QITi.js";import"./index-Dg3fRnQE.js";import"./vnode-DysYOGZN.js";import"./scroll-C2492Iw_.js";import"./index-BjDsryRX.js";import"./index-bT9OJj6t.js";import"./_overRest-Bb9G3v08.js";import"./index-C33Sf0pH.js";import"./use-form-item-DVWmmqeW.js";import"./use-form-common-props-IzjzSHax.js";import"./index-m1ZP1zbM.js";import"./validator-D2YZey62.js";import"./cloneDeep-Orislllf.js";import"./_baseClone-trfKWgGN.js";const H={class:"flex flex-col items-center"},O=["src"],W={class:"text-base font-medium"},j={class:"desc text-[13px]"},z={class:"dialog-footer"},A=U({__name:"BatchImportModal",props:{tableId:{},title:{default:"title"}},emits:["reload"],setup(h,{expose:$,emit:w}){const m=h,C=w;S(()=>{}),$({openDialog:k});const n=r(!1),u=r(!1),_=r([]),d=r(),c=r(!1);function k(){n.value=!0}function f(){_.value=[],d.value=null,n.value=!1}function B(a){return d.value=a.raw,!1}function D(){u.value=!0,T.download(`/api/v1/datacenterTable/getTemplate?tableId=${m.tableId}`).then(a=>{u.value=!1,q({fileName:"template.xlsx",source:a})})}function E(){if(!d.value){y.warning(e("datacenterTable.uploadDesc"));return}const a=new FormData;a.append("file",d.value),a.append("tableId",m.tableId),c.value=!0,T.postFile("/api/v1/datacenterTable/importData",a).then(o=>{if(c.value=!1,o.errorCode===0){const b=o.data.errorRows;let x="";for(const I of b)x+=`<p>${JSON.stringify(I)}</p><br>`;f(),V.alert(`<strong>${e("datacenterTable.totalNum")}：</strong>${o.data.totalCount}
        <strong>${e("datacenterTable.successNum")}：</strong>${o.data.successCount}
        <strong>${e("datacenterTable.failNum")}：</strong>${o.data.errorCount}<br>
        <strong>${e("datacenterTable.failList")}：</strong>${x}`,e("datacenterTable.importComplete"),{confirmButtonText:e("message.ok"),dangerouslyUseHTMLString:!0,callback:()=>{C("reload")}})}})}return(a,o)=>(R(),J(t(M),{modelValue:n.value,"onUpdate:modelValue":o[0]||(o[0]=b=>n.value=b),draggable:"",title:m.title,"before-close":f,"close-on-click-modal":!1},{footer:l(()=>[s("div",z,[p(t(g),{onClick:f},{default:l(()=>[v(i(t(e)("button.cancel")),1)]),_:1}),p(t(g),{disabled:c.value,loading:c.value,type:"primary",onClick:E},{default:l(()=>[v(i(t(e)("button.confirm")),1)]),_:1},8,["disabled","loading"])])]),default:l(()=>[p(t(L),{"file-list":_.value,drag:"",action:"#",accept:".xlsx,.xls,.csv","auto-upload":!1,"on-change":B,limit:1},{default:l(()=>[s("div",H,[s("img",{alt:"",src:t(F),class:"h-12 w-12"},null,8,O),s("div",W,i(t(e)("datacenterTable.uploadTitle")),1),s("div",j,i(t(e)("datacenterTable.uploadDesc")),1)])]),_:1},8,["file-list"]),p(t(g),{disabled:u.value,type:"primary",link:"",onClick:D},{default:l(()=>[v(i(t(e)("datacenterTable.downloadTemplate")),1)]),_:1},8,["disabled"])]),_:1},8,["modelValue","title"]))}}),$e=N(A,[["__scopeId","data-v-f359b67f"]]);export{$e as default};
