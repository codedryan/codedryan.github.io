var P=Object.defineProperty;var M=Object.getOwnPropertySymbols;var X=Object.prototype.hasOwnProperty,ee=Object.prototype.propertyIsEnumerable;var K=(g,r,u)=>r in g?P(g,r,{enumerable:!0,configurable:!0,writable:!0,value:u}):g[r]=u,N=(g,r)=>{for(var u in r||(r={}))X.call(r,u)&&K(g,u,r[u]);if(M)for(var u of M(r))ee.call(r,u)&&K(g,u,r[u]);return g};import{as as te,M as C,$ as i,aL as ae,V as oe,aW as T,Z as se,aI as R,a3 as ie,Y as le,R as $,_ as ne}from"./bootstrap-Bf65uz2I.js";import"./css-gf8D6QlL.js";import{E as re}from"./el-dialog-CAR1-R4U.js";import"./el-overlay-Zuw8glOl.js";import{E as A,a as z,b as E}from"./el-dropdown-menu-v2KdT220.js";/* empty css                  *//* empty css                     */import{E as de}from"./el-image-viewer-DlaFkWIK.js";import{E as ue}from"./el-message-box-B8o3mhYx.js";import"./css-C9o_OfXA.js";import{E as pe,a as _}from"./el-table-JPhh2aff.js";import"./css-_QzOlLq8.js";/* empty css                   *//* empty css                        *//* empty css               */import{d as ce}from"./dataset-BwduqZ0C.js";import{D as me}from"./DictSelect-DdOvS-6R.js";import{H as fe}from"./HeaderSearch-Dj9rqjlr.js";import{_ as ge}from"./PageData.vue_vue_type_script_setup_true_lang-DfbAOXk_.js";import{T as L}from"./Tag-BLqYdY0p.js";import{u as ve}from"./dict-CsbZy8Qf.js";import{_ as _e}from"./DatasetQaModal.vue_vue_type_script_setup_true_lang-Zq8YgI8Q.js";import{ElButton as f}from"./index-oBOAcXl-.js";import{k as ye,o as be,r as k,H as ke,m as y,n as m,J as t,q as p,E as s,u as e,L as c,y as n,p as w,B as S,F as xe,N as De,I as he,W as Ce}from"../jse/index-index-D3Xb8oT_.js";import"./index-B3qAv2kq.js";import"./aria-DEUWDJ1E.js";import"./refs-D6FW0B1r.js";import"./event-BB_Ol6Sd.js";import"./index-Bxb6QITi.js";import"./index-Dg3fRnQE.js";import"./vnode-DysYOGZN.js";import"./scroll-C2492Iw_.js";import"./index-CMBjNRIa.js";import"./index-bT9OJj6t.js";import"./_overRest-Bb9G3v08.js";import"./use-form-common-props-IzjzSHax.js";import"./index-CbSmxnRE.js";import"./util-B2mB0_6C.js";import"./castArray-BBset58W.js";import"./debounce-AsHllEOy.js";import"./toNumber-CvayJyp9.js";import"./index-C33Sf0pH.js";import"./index-BjDsryRX.js";import"./use-form-item-DVWmmqeW.js";import"./index-m1ZP1zbM.js";import"./validator-D2YZey62.js";import"./merge-BysAs727.js";import"./_baseClone-trfKWgGN.js";import"./isArrayLikeObject-j3RaJGb0.js";import"./_baseSlice-DZe_dRSe.js";import"./_baseIteratee-rJjBrWyx.js";import"./index-p7kg-xKH.js";import"./omit-CbyqVLxv.js";import"./index-pv0R11Cf.js";import"./raf-BVBe43_O.js";/* empty css                  */import"./index-DcZY4wgD.js";import"./index-DGdiZ7pE.js";import"./useProps-DNCnrLfW.js";import"./_baseFindIndex-D7XfJLKM.js";import"./strings-CGsg9AfI.js";import"./clamp-CeuJyDnc.js";import"./hasPermission-CIdLHqw4.js";import"./el-empty-CDAlv280.js";import"./el-pagination-W2lJTIgw.js";/* empty css                */import"./el-form-item-8FQp7Cs4.js";const qe={class:"flex h-full flex-col gap-6 p-6"},Ie={class:"flex items-center justify-between"},Te={class:"doc-knowledge-container"},$e={class:"knowledge-info-container"},we={class:"font-bold"},Qe={class:"text-[14px] text-[#75808D]"},Be={class:"ml-2"},Ee={class:"ml-2"},Le={class:"bg-background border-border flex-1 rounded-lg border p-5"},Se={key:0},Ve={class:"mb-2 flex gap-2"},Fe={class:"text-[14px] font-bold"},Me={key:0,class:"questions"},Ke={key:0,class:"question"},Ne={class:"flex items-center gap-3"},Re=ye({__name:"DatasetQaList",setup(g){be(()=>{J(),Y()});const r=te().query.id||"0",u=k(),V=k(),v=ve(),H=[],x=k({}),q=k(null),D=k(!1),Q=k(!1);function J(){v.fetchDictionary("auditStatus"),v.fetchDictionary("aiDataset"),v.fetchDictionary("qaOriginType"),v.fetchDictionary("sysAccount")}const O=l=>{u.value.setQuery({question:l,isQueryOr:!0})};function I(l){l==null||l.resetFields(),u.value.setQuery({})}function B(l){V.value.openDialog(N({},l))}function j(l){ue.confirm(i("message.deleteAlert"),i("message.noticeTitle"),{confirmButtonText:i("message.ok"),cancelButtonText:i("message.cancel"),type:"warning",beforeClose:(a,h,d)=>{a==="confirm"?(h.confirmButtonLoading=!0,C.post("/api/v1/datasetQa/remove",{id:l.id}).then(o=>{h.confirmButtonLoading=!1,o.errorCode===0&&($.success(o.message),I(),d())}).catch(()=>{h.confirmButtonLoading=!1})):d()}}).catch(()=>{})}function U(l){C.get("/api/v1/datasetQa/audit",{params:{id:l.id}}).then(a=>{a.errorCode===0&&($.success(a.message),I())})}function W(){R.back()}function Y(){C.get("/api/v1/dataset/detail",{params:{id:r}}).then(l=>{x.value=l.data})}function Z(){if(!q.value){$.error(i("message.selectKnowledge"));return}const l={dcId:q.value,datasetId:r};Q.value=!0,C.get("/api/v1/dataset/saveToDocumentCollection",{params:l}).then(a=>{a.errorCode===0&&($.success(a.message),I(),Q.value=!1,D.value=!1)})}function G(l){C.download("/api/v1/dataset/exportJsonl",{params:{id:l.id}}).then(a=>{Ce({fileName:`${l.name}.jsonl`,source:a})})}return(l,a)=>{const h=ke("access");return m(),y("div",qe,[t(e(re),{title:e(i)("dataset.MergeIntoKnowledge"),modelValue:D.value,"onUpdate:modelValue":a[3]||(a[3]=d=>D.value=d)},{footer:s(()=>[t(e(f),{onClick:a[1]||(a[1]=d=>D.value=!1)},{default:s(()=>[c(n(e(i)("button.cancel")),1)]),_:1}),t(e(f),{type:"primary",loading:Q.value,onClick:a[2]||(a[2]=d=>Z())},{default:s(()=>[c(n(e(i)("button.confirm")),1)]),_:1},8,["loading"])]),default:s(()=>[t(me,{modelValue:q.value,"onUpdate:modelValue":a[0]||(a[0]=d=>q.value=d),"dict-code":"aiDocumentCollection"},null,8,["modelValue"])]),_:1},8,["title","modelValue"]),t(_e,{ref_key:"saveDialog",ref:V,onReload:I},null,512),p("div",Ie,[p("div",Te,[p("div",{onClick:a[4]||(a[4]=d=>W()),style:{cursor:"pointer"}},[t(e(oe),null,{default:s(()=>[t(e(ae))]),_:1})]),p("div",null,[t(e(de),{src:x.value.icon||e(ce),style:{width:"36px",height:"36px"}},null,8,["src"])]),p("div",$e,[p("div",we,n(x.value.name||""),1),p("div",Qe,n(x.value.description||""),1)])]),p("div",null,[t(e(f),{onClick:a[5]||(a[5]=d=>D.value=!0)},{default:s(()=>[t(e(T),{icon:"merge"}),c(" "+n(e(i)("dataset.MergeIntoKnowledge")),1)]),_:1}),t(e(f),{onClick:a[6]||(a[6]=d=>G(x.value))},{default:s(()=>[t(e(T),{icon:"llm"}),c(" "+n(e(i)("dataset.ExportSFTTrainingFile")),1)]),_:1})])]),t(fe,{buttons:H,onSearch:O,onButtonClick:a[9]||(a[9]=d=>B({}))},{"custom-button":s(()=>[t(e(A),{trigger:"click","show-arrow":!1},{dropdown:s(()=>[t(e(z),null,{default:s(()=>[t(e(E),{onClick:a[7]||(a[7]=d=>B({originType:0,datasetId:e(r),questions:[]}))},{default:s(()=>[t(e(T),{icon:"point"}),p("span",Be,n(e(i)("dataset.CreateQAManually")),1)]),_:1}),t(e(E),{onClick:a[8]||(a[8]=d=>e(R).push({name:"ImportFile",query:{datasetId:e(r)}}))},{default:s(()=>[t(e(T),{icon:"upload"}),p("span",Ee,n(e(i)("dataset.SmartDocumentImport")),1)]),_:1})]),_:1})]),default:s(()=>[t(e(f),{type:"primary",icon:e(se)},{default:s(()=>[c(n(e(i)("button.add")),1)]),_:1},8,["icon"])]),_:1})]),_:1}),p("div",Le,[t(ge,{ref_key:"pageDataRef",ref:u,"page-url":"/api/v1/datasetQa/page","page-size":10,"extra-query-params":{datasetId:e(r),sortKey:"id",sortType:"asc"}},{default:s(({pageList:d})=>[t(e(pe),{data:d,border:""},{default:s(()=>[t(e(_),{prop:"status",label:e(i)("datasetQa.status")},{default:s(({row:o})=>[t(L,{type:o.status===0?"warning":"success",text:e(v).getDictLabel("auditStatus",o.status)},null,8,["type","text"])]),_:1},8,["label"]),t(e(_),{prop:"questions",width:"200",label:e(i)("datasetQa.questions")},{default:s(({row:o})=>[o.questions&&o.questions.length>0?(m(),y("div",Se,[p("div",Ve,[p("div",Fe,n(o.questions[0].question),1),o.questions.length>1&&!o.expaned?(m(),S(L,{key:0,class:"cursor-pointer",size:"small",type:"info",onClick:b=>o.expaned=!0,text:e(i)("dataset.SimilarQuestions",{number:o.questions.length-1})},null,8,["onClick","text"])):(m(),S(L,{key:1,class:"cursor-pointer",size:"small",type:"primary",onClick:b=>o.expaned=!1,text:e(i)("dataset.Collapse")},null,8,["onClick","text"]))]),o.expaned?(m(),y("div",Me,[(m(!0),y(xe,null,De(o.questions,(b,F)=>(m(),y("div",{key:F},[F>0&&o.expaned?(m(),y("div",Ke,n(b.question),1)):w("",!0)]))),128))])):w("",!0)])):w("",!0)]),_:1},8,["label"]),t(e(_),{prop:"answer","show-overflow-tooltip":"",label:e(i)("datasetQa.answer")},{default:s(({row:o})=>[c(n(o.answer),1)]),_:1},8,["label"]),t(e(_),{prop:"originType",label:e(i)("datasetQa.originType")},{default:s(({row:o})=>[c(n(e(v).getDictLabel("qaOriginType",o.originType)),1)]),_:1},8,["label"]),t(e(_),{prop:"accountId",label:e(i)("datasetQa.accountId")},{default:s(({row:o})=>[c(n(e(v).getDictLabel("sysAccount",o.accountId)),1)]),_:1},8,["label"]),t(e(_),{prop:"created",label:e(i)("datasetQa.created")},{default:s(({row:o})=>[c(n(o.created),1)]),_:1},8,["label"]),t(e(_),{label:e(i)("common.handle"),width:"120",align:"right"},{default:s(({row:o})=>[p("div",Ne,[o.status!==1?(m(),S(e(f),{key:0,class:"mr-[-20px]",link:"",type:"primary",onClick:b=>U(o)},{default:s(()=>[c(n(e(i)("button.confirm")),1)]),_:1},8,["onClick"])):w("",!0),t(e(f),{link:"",type:"primary",onClick:b=>B(o)},{default:s(()=>[c(n(e(i)("button.edit")),1)]),_:1},8,["onClick"]),t(e(A),null,{dropdown:s(()=>[t(e(z),null,{default:s(()=>[he((m(),y("div",null,[t(e(E),{onClick:b=>j(o)},{default:s(()=>[t(e(f),{type:"danger",icon:e(le),link:""},{default:s(()=>[c(n(e(i)("button.delete")),1)]),_:1},8,["icon"])]),_:1},8,["onClick"])])),[[h,"/api/v1/dataset/remove","code"]])]),_:2},1024)]),default:s(()=>[t(e(f),{link:"",icon:e(ie)},null,8,["icon"])]),_:2},1024)])]),_:1},8,["label"])]),_:1},8,["data"])]),_:1},8,["extra-query-params"])])])}}}),ta=ne(Re,[["__scopeId","data-v-38c0d844"]]);export{ta as default};
