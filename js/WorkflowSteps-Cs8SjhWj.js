var q=Object.defineProperty;var I=Object.getOwnPropertySymbols;var M=Object.prototype.hasOwnProperty,j=Object.prototype.propertyIsEnumerable;var N=(u,n,s)=>n in u?q(u,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):u[n]=s,g=(u,n)=>{for(var s in n||(n={}))M.call(n,s)&&N(u,s,n[s]);if(I)for(var s of I(n))j.call(n,s)&&N(u,s,n[s]);return u};import{$ as T,V as b,bP as K,aY as R,b_ as W,b$ as Y,_ as A}from"./bootstrap-Bf65uz2I.js";import"./css-gf8D6QlL.js";import{E as G,a as H}from"./el-collapse-item-DRoc9NR8.js";/* empty css                */import{E as O,a as $}from"./el-form-item-8FQp7Cs4.js";import{S as Q}from"./ShowJson-BAGbKM0P.js";import X from"./ConfirmItem-tawJTZXx.js";import Z from"./ConfirmItemMulti-wNCtRvrG.js";import{ElButton as ee}from"./index-oBOAcXl-.js";import{k as te,r as p,w as E,c as ae,m,n as a,J as d,u as l,E as i,F as w,N as P,B as c,q as _,y as k,p as f,L as oe}from"../jse/index-index-D3Xb8oT_.js";import"./event-BB_Ol6Sd.js";import"./castArray-BBset58W.js";import"./index-DF0dk4ce.js";import"./index-Bxb6QITi.js";import"./use-form-common-props-IzjzSHax.js";import"./_baseClone-trfKWgGN.js";import"./el-empty-CDAlv280.js";import"./vue3-json-viewer-B3eBxIfC.js";/* empty css                */import"./confirm-other-CecEfHYi.js";import"./index-Bpv3aWiu.js";import"./index-Dg3fRnQE.js";import"./use-form-item-DVWmmqeW.js";const le={class:"flex items-center justify-between"},se={class:"flex items-center"},re={key:1,class:"spinner"},ne={key:0,class:"p-2.5"},ie={class:"mb-2 text-[16px] font-bold"},ue={key:0,class:"header-container"},me={key:1,class:"description-container"},de={class:"flex justify-end"},ce={key:1},fe=te({__name:"WorkflowSteps",props:{workflowId:{},nodeJson:{},initSignal:{type:Boolean},pollingData:{}},emits:["resume"],setup(u,{emit:n}){const s=u,U=n,S=p([]),V=p({}),B=p(!1);E(()=>s.pollingData,o=>{const r=o.nodes;for(const e in r)V.value[e]=r[e],r[e].status===6&&(x.value=e)},{deep:!0}),E(()=>s.initSignal,()=>{V.value={},B.value=!1,h.value=!1}),E(()=>s.nodeJson,o=>{o&&(S.value=[...o])},{immediate:!0});const z=ae(()=>S.value.map(o=>g(g({},o),V.value[o.key]))),x=p("1"),v=p({}),F=p({}),D=(o,r)=>{o&&(F.value[r]=o)},h=p(!1);function J(o){return o.formType||"radio"}function L(o){const r=o.key,e=F.value[r];if(!e){console.warn(`Form instance for ${r} not found`);return}const t=o.suspendForParameters[0].name;e.validate(C=>{if(C){const y={confirmParams:g({[t]:"yes"},v.value)};h.value=!0,U("resume",y)}})}return(o,r)=>(a(),m("div",null,[d(l(G),{modelValue:x.value,"onUpdate:modelValue":r[0]||(r[0]=e=>x.value=e),accordion:"","expand-icon-position":"left"},{default:i(()=>[(a(!0),m(w,null,P(z.value,e=>(a(),c(l(H),{key:e.key,title:`${e.label}-${e.status}`,name:e.key},{title:i(()=>[_("div",le,[_("div",null,k(e.label),1),_("div",se,[e.status===20?(a(),c(l(b),{key:0,color:"green",size:"20"},{default:i(()=>[d(l(K))]),_:1})):f("",!0),e.status===1?(a(),m("div",re)):f("",!0),e.status===10?(a(),c(l(b),{key:2,color:"red",size:"20"},{default:i(()=>[d(l(R))]),_:1})):f("",!0),e.status===6?(a(),c(l(b),{key:3,color:"orange",size:"20"},{default:i(()=>[d(l(W))]),_:1})):f("",!0),B.value?(a(),c(l(b),{key:4,color:"orange",size:"20"},{default:i(()=>[d(l(Y))]),_:1})):f("",!0)])])]),default:i(()=>[e.original.type==="confirmNode"?(a(),m("div",ne,[_("div",ie,k(e.original.data.message),1),d(l(O),{ref_for:!0,ref:t=>D(t,e.key),"label-position":"top",model:v.value},{default:i(()=>[(a(!0),m(w,null,P(e.suspendForParameters,(t,C)=>(a(),m(w,{key:C},[t.formType!=="confirm"?(a(),m("div",ue,[r[1]||(r[1]=_("div",{class:"blue-bar"},"Â ",-1)),_("span",null,k(t.formLabel),1)])):f("",!0),t.formType!=="confirm"?(a(),m("div",me,k(t.formDescription),1)):f("",!0),t.formType!=="confirm"?(a(),c(l($),{key:2,prop:t.name,rules:[{required:!0,message:l(T)("message.required")}]},{default:i(()=>[J(t)==="radio"?(a(),c(X,{key:0,modelValue:v.value[t.name],"onUpdate:modelValue":y=>v.value[t.name]=y,"selection-data-type":t.contentType||"text","selection-data":t.enums},null,8,["modelValue","onUpdate:modelValue","selection-data-type","selection-data"])):(a(),c(Z,{key:1,modelValue:v.value[t.name],"onUpdate:modelValue":y=>v.value[t.name]=y,"selection-data-type":t.contentType||"text","selection-data":t.enums},null,8,["modelValue","onUpdate:modelValue","selection-data-type","selection-data"]))]),_:2},1032,["prop","rules"])):f("",!0)],64))),128)),d(l($),null,{default:i(()=>[_("div",de,[d(l(ee),{disabled:h.value,type:"primary",onClick:t=>L(e)},{default:i(()=>[oe(k(l(T)("button.confirm")),1)]),_:1},8,["disabled","onClick"])])]),_:2},1024)]),_:2},1032,["model"])])):(a(),m("div",ce,[d(Q,{value:e.result||e.message},null,8,["value"])]))]),_:2},1032,["title","name"]))),128))]),_:1},8,["modelValue"])]))}}),Je=A(fe,[["__scopeId","data-v-2f061cbb"]]);export{Je as default};
