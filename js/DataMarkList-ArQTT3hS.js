var w=(E,f,n)=>new Promise((b,_)=>{var p=l=>{try{k(n.next(l))}catch(m){_(m)}},T=l=>{try{k(n.throw(l))}catch(m){_(m)}},k=l=>l.done?b(l.value):Promise.resolve(l.value).then(p,T);k((n=n.apply(E,f)).next())});import{$ as t,Z as Q,a3 as j,aH as J,a8 as K,Y as O,aI as P,M as $,R as N}from"./bootstrap-Bf65uz2I.js";import"./css-gf8D6QlL.js";import{E as Y,a as Z,b as C}from"./el-dropdown-menu-v2KdT220.js";/* empty css                  *//* empty css                     */import{E as R}from"./el-message-box-B8o3mhYx.js";import"./css-C9o_OfXA.js";import"./el-overlay-Zuw8glOl.js";import{E as F,a as c}from"./el-table-JPhh2aff.js";import"./css-_QzOlLq8.js";/* empty css                   *//* empty css                        *//* empty css               */import{H as G}from"./HeaderSearch-Dj9rqjlr.js";import{_ as U}from"./PageData.vue_vue_type_script_setup_true_lang-DfbAOXk_.js";import{T as W}from"./Tag-BLqYdY0p.js";import{u as X}from"./dict-CsbZy8Qf.js";import{_ as ee}from"./CreateTaskModal.vue_vue_type_script_setup_true_lang-V0a6PVeE.js";import{ElButton as x}from"./index-oBOAcXl-.js";import{k as te,r as h,o as ae,S as re,H as oe,m as y,n as g,J as a,q as V,E as i,u as e,L as d,y as u,B as ie,p as M,I as B}from"../jse/index-index-D3Xb8oT_.js";import"./index-CMBjNRIa.js";import"./index-bT9OJj6t.js";import"./_overRest-Bb9G3v08.js";import"./index-B3qAv2kq.js";import"./aria-DEUWDJ1E.js";import"./index-Bxb6QITi.js";import"./use-form-common-props-IzjzSHax.js";import"./index-CbSmxnRE.js";import"./util-B2mB0_6C.js";import"./castArray-BBset58W.js";import"./refs-D6FW0B1r.js";import"./index-BjDsryRX.js";import"./event-BB_Ol6Sd.js";import"./index-C33Sf0pH.js";import"./use-form-item-DVWmmqeW.js";import"./index-m1ZP1zbM.js";import"./validator-D2YZey62.js";import"./vnode-DysYOGZN.js";import"./scroll-C2492Iw_.js";import"./merge-BysAs727.js";import"./_baseClone-trfKWgGN.js";import"./isArrayLikeObject-j3RaJGb0.js";import"./_baseSlice-DZe_dRSe.js";import"./_baseIteratee-rJjBrWyx.js";import"./debounce-AsHllEOy.js";import"./toNumber-CvayJyp9.js";import"./index-p7kg-xKH.js";import"./index-Dg3fRnQE.js";import"./omit-CbyqVLxv.js";import"./index-pv0R11Cf.js";import"./raf-BVBe43_O.js";import"./hasPermission-CIdLHqw4.js";import"./el-empty-CDAlv280.js";import"./el-pagination-W2lJTIgw.js";import"./index-DcZY4wgD.js";import"./index-DGdiZ7pE.js";import"./useProps-DNCnrLfW.js";import"./_baseFindIndex-D7XfJLKM.js";import"./strings-CGsg9AfI.js";import"./clamp-CeuJyDnc.js";/* empty css                  */import"./el-dialog-CAR1-R4U.js";/* empty css                */import"./el-form-item-8FQp7Cs4.js";import"./DictSelect-DdOvS-6R.js";import"./SelectConversationModal.vue_vue_type_script_setup_true_lang-D6OprW_5.js";import"./css-Dv7ceDvX.js";import"./PreviewConversationModal.vue_vue_type_script_setup_true_lang-Co2Vmm9r.js";import"./index-Dwe-AimY.js";import"./panel-time-pick-Dcp5yKq_.js";import"./index-BKzCwxYe.js";const se={class:"flex h-full flex-col gap-6 p-6"},le={class:"h-full flex-1 overflow-auto rounded-lg border border-[var(--el-border-color)] bg-[var(--el-bg-color)] p-4"},ne={class:"flex items-center justify-center gap-2"},ce={key:0},me={key:1},Et=te({__name:"DataMarkList",setup(E){const f=h(),n=h(),b=h(""),_=h(""),p=X();ae(()=>{T()});function T(){p.fetchDictionary("sysAccount"),p.fetchDictionary("markStatus")}const k=[{key:"create",text:t("dataMark.createMark"),icon:re(Q),type:"primary",data:{action:"create"},permission:"/api/v1/markTask/save"}],l=r=>{f.value.setQuery({botName:r})},m=()=>{b.value="",_.value="",f.value.setQuery({})},A=()=>{n.value.openDialog()},S=(r,s)=>{P.push({name:"DataMarkDetail",query:{id:r.id,type:s}})},H=r=>w(null,null,function*(){try{yield R.confirm(t("message.resetAlert"),t("message.noticeTitle"),{confirmButtonText:t("message.ok"),cancelButtonText:t("message.cancel"),type:"warning"}),(yield $.get("/api/v1/markTask/resetTask",{params:{id:r.id}})).errorCode===0&&N.success(t("message.resetSuccess")),m()}catch(s){s!=="cancel"&&console.error("重置失败:",s)}}),I=r=>{n.value.openDialog(r)},L=r=>w(null,null,function*(){try{yield R.confirm(t("message.deleteAlert"),t("message.noticeTitle"),{confirmButtonText:t("message.ok"),cancelButtonText:t("message.cancel"),type:"warning"}),(yield $.get("/api/v1/markTask/removeTask",{params:{id:r.id}})).errorCode===0&&N.success(t("message.deleteOkMessage")),m()}catch(s){s!=="cancel"&&console.error("删除失败:",s)}});function q(r){return r===0?"info":r===1?"warning":r===2?"success":"info"}return(r,s)=>{const D=oe("access");return g(),y("div",se,[a(ee,{ref_key:"createDialog",ref:n,onReload:m},null,512),a(G,{buttons:k,onSearch:l,onButtonClick:A}),V("div",le,[a(U,{ref_key:"pageDataRef",ref:f,"page-url":"/api/v1/markTask/page","page-sizes":[10,20,50,100],"page-size":10},{default:i(({pageList:z})=>[a(e(F),{data:z,border:"",stripe:""},{default:i(()=>[a(e(c),{prop:"id",label:e(t)("dataMark.taskId"),width:"80",align:"center"},null,8,["label"]),a(e(c),{prop:"status",label:e(t)("dataMark.status"),width:"100",align:"center"},{default:i(({row:o})=>[a(W,{type:q(o.status),text:e(p).getDictLabel("markStatus",o.status)},null,8,["type","text"])]),_:1},8,["label"]),a(e(c),{prop:"botName",label:e(t)("dataMark.assistantName"),"min-width":"150"},null,8,["label"]),a(e(c),{prop:"conversationCount",label:e(t)("dataMark.topics"),width:"100",align:"center"},null,8,["label"]),a(e(c),{prop:"createdBy",label:e(t)("dataMark.creator"),width:"120"},{default:i(({row:o})=>[d(u(e(p).getDictLabel("sysAccount",o.createdBy)),1)]),_:1},8,["label"]),a(e(c),{prop:"taskProgress",label:e(t)("dataMark.progress"),"min-width":"200"},null,8,["label"]),a(e(c),{prop:"created",label:e(t)("dataMark.creationTime"),width:"180"},null,8,["label"]),a(e(c),{label:e(t)("common.handle"),width:"150",align:"center",fixed:"right"},{default:i(({row:o})=>[V("div",ne,[[0,1].includes(o.status)?(g(),ie(e(x),{key:0,class:"mr-[-10px]",type:"primary",link:"",onClick:v=>S(o,"mark")},{default:i(()=>[d(u(e(t)("button.goMark")),1)]),_:1},8,["onClick"])):M("",!0),a(e(x),{type:"primary",link:"",onClick:v=>S(o,"view")},{default:i(()=>[d(u(e(t)("button.view")),1)]),_:1},8,["onClick"]),a(e(Y),null,{dropdown:i(()=>[a(e(Z),null,{default:i(()=>[[0,1].includes(o.status)?B((g(),y("div",ce,[a(e(C),{icon:e(J),onClick:v=>H(o)},{default:i(()=>[d(u(e(t)("button.reset")),1)]),_:1},8,["icon","onClick"])])),[[D,"/api/v1/markTask/save","code"]]):M("",!0),[0,1].includes(o.status)?B((g(),y("div",me,[a(e(C),{icon:e(K),onClick:v=>I(o)},{default:i(()=>[d(u(e(t)("button.edit")),1)]),_:1},8,["icon","onClick"])])),[[D,"/api/v1/markTask/save","code"]]):M("",!0),B((g(),y("div",null,[a(e(C),{icon:e(O),style:{color:"#f56c6c"},onClick:v=>L(o)},{default:i(()=>[d(u(e(t)("button.delete")),1)]),_:1},8,["icon","onClick"])])),[[D,"/api/v1/markTask/remove","code"]])]),_:2},1024)]),default:i(()=>[a(e(x),{type:"primary",link:"",icon:e(j)},null,8,["icon"])]),_:2},1024)])]),_:1},8,["label"])]),_:1},8,["data"])]),_:1},512)])])}}});export{Et as default};
