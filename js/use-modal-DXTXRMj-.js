var Qe=Object.defineProperty,Ze=Object.defineProperties;var et=Object.getOwnPropertyDescriptors;var ae=Object.getOwnPropertySymbols;var be=Object.prototype.hasOwnProperty,xe=Object.prototype.propertyIsEnumerable;var ie=(o,t,s)=>t in o?Qe(o,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):o[t]=s,y=(o,t)=>{for(var s in t||(t={}))be.call(t,s)&&ie(o,s,t[s]);if(ae)for(var s of ae(t))xe.call(t,s)&&ie(o,s,t[s]);return o},z=(o,t)=>Ze(o,et(t));var j=(o,t)=>{var s={};for(var a in o)be.call(o,a)&&t.indexOf(a)<0&&(s[a]=o[a]);if(o!=null&&ae)for(var a of ae(o))t.indexOf(a)<0&&xe.call(o,a)&&(s[a]=o[a]);return s};var U=(o,t,s)=>ie(o,typeof t!="symbol"?t+"":t,s);var W=(o,t,s)=>new Promise((a,l)=>{var i=m=>{try{b(s.next(m))}catch(r){l(r)}},p=m=>{try{b(s.throw(m))}catch(r){l(r)}},b=m=>m.done?a(m.value):Promise.resolve(m.value).then(i,p);b((s=s.apply(o,t)).next())});import{K as de,bN as _e,dy as tt,ap as ot,P as Ae,dz as st,dA as at,dB as nt,dC as lt,dD as it,dE as rt,dF as dt,cy as ct,aw as we,dG as ut,dH as pt}from"./bootstrap-Bf65uz2I.js";import{k as A,B as h,n as f,u as e,ap as ft,aq as mt,E as v,x as C,i as Te,m as ce,c as S,r as M,au as yt,J as V,p as k,z as ht,s as R,v as _,D as ue,G as $e,o as vt,ag as gt,ak as Ct,aL as re,aM as bt,w as xt,aN as wt,q as kt,L as J,y as G,V as ke,A as pe,X as Ee,aO as Bt,d as Ot,P as Be}from"../jse/index-index-D3Xb8oT_.js";import{D as Dt,a as Mt,X as _t,b as At,c as Tt,d as $t,A as Et}from"./loading-BcNj5jY5.js";const Jt=de("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);const It=de("expand",[["path",{d:"m15 15 6 6",key:"1s409w"}],["path",{d:"m15 9 6-6",key:"ko1vev"}],["path",{d:"M21 16v5h-5",key:"1ck2sf"}],["path",{d:"M21 8V3h-5",key:"1qoq8a"}],["path",{d:"M3 16v5h5",key:"1t08am"}],["path",{d:"m3 21 6-6",key:"wwnumi"}],["path",{d:"M3 8V3h5",key:"1ln10m"}],["path",{d:"M9 9 3 3",key:"v551iv"}]]);const Pt=de("shrink",[["path",{d:"m15 15 6 6m-6-6v4.8m0-4.8h4.8",key:"17vawe"}],["path",{d:"M9 19.8V15m0 0H4.2M9 15l-6 6",key:"chjx8e"}],["path",{d:"M15 4.2V9m0 0h4.8M15 9l6-6",key:"lav6yq"}],["path",{d:"M9 4.2V9m0 0H4.2M9 9 3 3",key:"1pxi2q"}]]),Lt=A({__name:"Dialog",props:{open:{type:Boolean},defaultOpen:{type:Boolean},modal:{type:Boolean}},emits:["update:open"],setup(o,{emit:t}){const l=_e(o,t);return(i,p)=>(f(),h(e(Dt),ft(mt(e(l))),{default:v(()=>[C(i.$slots,"default")]),_:3},16))}}),St=["data-dismissable-modal"],Ft=A({__name:"DialogOverlay",setup(o){tt();const t=Te("DISMISSABLE_MODAL_ID");return(s,a)=>(f(),ce("div",{"data-dismissable-modal":e(t),class:"bg-overlay z-popup inset-0"},null,8,St))}}),zt=A({__name:"DialogContent",props:{forceMount:{type:Boolean},disableOutsidePointerEvents:{type:Boolean},asChild:{type:Boolean},as:{},animationType:{default:"slide"},appendTo:{default:"body"},class:{},closeClass:{},closeDisabled:{type:Boolean,default:!1},modal:{type:Boolean},open:{type:Boolean},overlayBlur:{},showClose:{type:Boolean,default:!0},zIndex:{}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","openAutoFocus","closeAutoFocus","close","closed","opened"],setup(o,{expose:t,emit:s}){const a=o,l=s,i=S(()=>{const $=a,{class:u,modal:d,open:g,showClose:x,animationType:B}=$;return j($,["class","modal","open","showClose","animationType"])});function p(){return a.appendTo==="body"||a.appendTo===document.body||!a.appendTo}const b=S(()=>p()?"fixed":"absolute"),m=_e(i,l),r=M(null);function c(u){var d;u.target===((d=r.value)==null?void 0:d.$el)&&(a.open?l("opened"):l("closed"))}return t({getContentRef:()=>r.value}),(u,d)=>(f(),h(yt,{defer:"",to:o.appendTo},[V(ot,{name:"fade"},{default:v(()=>[o.open&&o.modal?(f(),h(Ft,{key:0,style:ht(z(y({},o.zIndex?{zIndex:o.zIndex}:{}),{position:b.value,backdropFilter:o.overlayBlur&&o.overlayBlur>0?`blur(${o.overlayBlur}px)`:"none"})),onClick:d[0]||(d[0]=()=>l("close"))},null,8,["style"])):k("",!0)]),_:1}),V(e(At),ue({ref_key:"contentRef",ref:r,style:z(y({},o.zIndex?{zIndex:o.zIndex}:{}),{position:b.value}),onAnimationend:c},e(m),{class:e(_)("z-popup bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 w-full p-6 shadow-lg outline-none sm:rounded-xl",{"data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-top-[48%]":o.animationType==="slide"},a.class)}),{default:v(()=>[C(u.$slots,"default"),o.showClose?(f(),h(e(Mt),{key:0,disabled:o.closeDisabled,class:R(e(_)("data-[state=open]:bg-accent data-[state=open]:text-muted-foreground hover:bg-accent hover:text-accent-foreground text-foreground/80 flex-center absolute right-3 top-3 h-6 w-6 rounded-full px-1 text-lg opacity-70 transition-opacity hover:opacity-100 focus:outline-none disabled:pointer-events-none",a.closeClass)),onClick:d[1]||(d[1]=()=>l("close"))},{default:v(()=>[V(e(_t),{class:"h-4 w-4"})]),_:1},8,["disabled","class"])):k("",!0)]),_:3},16,["style","class"])],8,["to"]))}}),Oe=A({__name:"DialogDescription",props:{asChild:{type:Boolean},as:{},class:{}},setup(o){const t=o,s=S(()=>{const p=t,{class:l}=p;return j(p,["class"])}),a=Ae(s);return(l,i)=>(f(),h(e(Tt),ue(e(a),{class:e(_)("text-muted-foreground text-sm",t.class)}),{default:v(()=>[C(l.$slots,"default")]),_:3},16,["class"]))}}),Rt=A({__name:"DialogFooter",props:{class:{}},setup(o){const t=o;return(s,a)=>(f(),ce("div",{class:R(e(_)("flex flex-row flex-col-reverse justify-end gap-x-2",t.class))},[C(s.$slots,"default")],2))}}),Nt=A({__name:"DialogHeader",props:{class:{}},setup(o){const t=o;return(s,a)=>(f(),ce("div",{class:R(e(_)("flex flex-col gap-y-1.5 text-center sm:text-left",t.class))},[C(s.$slots,"default")],2))}}),De=A({__name:"DialogTitle",props:{asChild:{type:Boolean},as:{},class:{}},setup(o){const t=o,s=S(()=>{const p=t,{class:l}=p;return j(p,["class"])}),a=Ae(s);return(l,i)=>(f(),h(e($t),ue(e(a),{class:e(_)("text-lg font-semibold leading-none tracking-tight",t.class)}),{default:v(()=>[C(l.$slots,"default")]),_:3},16,["class"]))}});function Vt(o,t,s,a){const l=$e({offsetX:0,offsetY:0}),i=M(!1),p=c=>{const u=c.clientX,d=c.clientY;if(!o.value)return;const g=o.value.getBoundingClientRect(),{offsetX:x,offsetY:B}=l,T=g.left,$=g.top,X=g.width,Q=g.height;let I=null;if(a!=null&&a.value){const O=document.querySelector(a.value);O&&(I=O.getBoundingClientRect())}let Y,q,H,P;if(I)H=I.left-T+x,Y=I.right-T-X+x,P=I.top-$+B,q=I.bottom-$-Q+B;else{const O=document.documentElement,L=O.clientWidth,D=O.clientHeight;H=-T+x,P=-$+B,Y=L-T-X+x,q=D-$-Q+B}const Z=O=>{let L=x+O.clientX-u,D=B+O.clientY-d;L=Math.min(Math.max(L,H),Y),D=Math.min(Math.max(D,P),q),l.offsetX=L,l.offsetY=D,o.value&&(o.value.style.transform=`translate(${L}px, ${D}px)`,i.value=!0)},ee=()=>{i.value=!1,document.removeEventListener("mousemove",Z),document.removeEventListener("mouseup",ee)};document.addEventListener("mousemove",Z),document.addEventListener("mouseup",ee)},b=()=>{const c=re(t);c&&o.value&&c.addEventListener("mousedown",p)},m=()=>{const c=re(t);c&&o.value&&c.removeEventListener("mousedown",p)},r=()=>{l.offsetX=0,l.offsetY=0;const c=re(o);c&&(c.style.transform="none")};return vt(()=>{gt(()=>{s.value?b():m()})}),Ct(()=>{m()}),{dragging:i,resetPosition:r,transform:l}}const Xt=A({__name:"modal",props:{modalApi:{default:void 0},animationType:{},appendToMain:{type:Boolean,default:!1},bordered:{type:Boolean},cancelText:{},centered:{type:Boolean},class:{},closable:{type:Boolean},closeOnClickModal:{type:Boolean},closeOnPressEscape:{type:Boolean},confirmDisabled:{type:Boolean},confirmLoading:{type:Boolean},confirmText:{},contentClass:{},description:{},destroyOnClose:{type:Boolean,default:!1},draggable:{type:Boolean},footer:{type:Boolean},footerClass:{},fullscreen:{type:Boolean},fullscreenButton:{type:Boolean},header:{type:Boolean},headerClass:{},loading:{type:Boolean},modal:{type:Boolean},openAutoFocus:{type:Boolean},overlayBlur:{},showCancelButton:{type:Boolean},showConfirmButton:{type:Boolean},submitting:{type:Boolean},title:{},titleTooltip:{},zIndex:{}},setup(o){var se,Ce;const t=o,s=st.getComponents(),a=M(),l=M(),i=M(),p=M(),b=M(),m=bt();Ee("DISMISSABLE_MODAL_ID",m);const{$t:r}=at(),{isMobile:c}=nt(),u=(Ce=(se=t.modalApi)==null?void 0:se.useStore)==null?void 0:Ce.call(se),{appendToMain:d,bordered:g,cancelText:x,centered:B,class:T,closable:$,closeOnClickModal:X,closeOnPressEscape:Q,confirmDisabled:I,confirmLoading:Y,confirmText:q,contentClass:H,description:P,destroyOnClose:Z,draggable:ee,footer:O,footerClass:L,fullscreen:D,fullscreenButton:Ie,header:fe,headerClass:Pe,loading:me,modal:Le,openAutoFocus:Se,overlayBlur:Fe,showCancelButton:ze,showConfirmButton:Re,submitting:E,title:te,titleTooltip:ye,animationType:Ne,zIndex:Ve}=lt(t,u),oe=S(()=>D.value||c.value),he=S(()=>ee.value&&!oe.value&&fe.value),ve=S(()=>d.value?`#${it}>div:not(.absolute)>div`:void 0),{dragging:Xe,transform:Ye}=Vt(i,p,he,ve),ne=M(!1),le=M(!0);xt(()=>{var n;return(n=u==null?void 0:u.value)==null?void 0:n.isOpen},n=>W(null,null,function*(){if(n){if(le.value=!1,ne.value||(ne.value=!0),yield pe(),!a.value)return;const w=a.value.getContentRef();i.value=w.$el;const{offsetX:N,offsetY:F}=Ye;i.value.style.transform=`translate(${N}px, ${F}px)`}}),{immediate:!0}),wt(()=>{var n;d.value||(n=t.modalApi)==null||n.close()});function qe(){var n;(n=t.modalApi)==null||n.setState(w=>z(y({},w),{fullscreen:!D.value}))}function He(n){(!X.value||E.value)&&(n.preventDefault(),n.stopPropagation())}function Ke(n){(!Q.value||E.value)&&n.preventDefault()}function je(n){Se.value||n==null||n.preventDefault()}function Ue(n){const w=n.target,N=w==null?void 0:w.dataset.dismissableModal;(!X.value||N!==m||E.value)&&(n.preventDefault(),n.stopPropagation())}function ge(n){n.preventDefault(),n.stopPropagation()}const We=S(()=>!e(Z)&&e(ne)),Je=()=>{requestAnimationFrame(()=>{var n;(n=t.modalApi)==null||n.onOpened()})};function Ge(){var n;le.value=!0,(n=t.modalApi)==null||n.onClosed()}return(n,w)=>{var N;return f(),h(e(Lt),{modal:!1,open:(N=e(u))==null?void 0:N.isOpen,"onUpdate:open":w[2]||(w[2]=()=>{var F;return e(E)||(F=o.modalApi)==null?void 0:F.close()})},{default:v(()=>{var F;return[V(e(zt),{ref_key:"contentRef",ref:a,"append-to":ve.value,class:R(e(_)("left-0 right-0 top-[10vh] mx-auto flex max-h-[80%] w-[520px] flex-col p-0",oe.value?"sm:rounded-none":"sm:rounded-[var(--radius)]",e(T),{"border-border border":e(g),"shadow-3xl":!e(g),"left-0 top-0 size-full max-h-full !translate-x-0 !translate-y-0":oe.value,"top-1/2 !-translate-y-1/2":e(B)&&!oe.value,"duration-300":!e(Xe),hidden:le.value})),"force-mount":We.value,modal:e(Le),open:(F=e(u))==null?void 0:F.isOpen,"show-close":e($),"animation-type":e(Ne),"z-index":e(Ve),"overlay-blur":e(Fe),"close-class":"top-3",onCloseAutoFocus:ge,onClosed:Ge,"close-disabled":e(E),onEscapeKeyDown:Ke,onFocusOutside:ge,onInteractOutside:He,onOpenAutoFocus:je,onOpened:Je,onPointerDownOutside:Ue},{default:v(()=>[V(e(Nt),{ref_key:"headerRef",ref:p,class:R(e(_)("px-5 py-4",{"border-b":e(g),hidden:!e(fe),"cursor-move select-none":he.value},e(Pe)))},{default:v(()=>[e(te)?(f(),h(e(De),{key:0,class:"text-left"},{default:v(()=>[C(n.$slots,"title",{},()=>[J(G(e(te))+" ",1),e(ye)?C(n.$slots,"titleTooltip",{key:0},()=>[V(e(rt),{"trigger-class":"pb-1"},{default:v(()=>[J(G(e(ye)),1)]),_:1})]):k("",!0)])]),_:3})):k("",!0),e(P)?(f(),h(e(Oe),{key:1},{default:v(()=>[C(n.$slots,"description",{},()=>[J(G(e(P)),1)])]),_:3})):k("",!0),!e(te)||!e(P)?(f(),h(e(dt),{key:2},{default:v(()=>[e(te)?k("",!0):(f(),h(e(De),{key:0})),e(P)?k("",!0):(f(),h(e(Oe),{key:1}))]),_:1})):k("",!0)]),_:3},8,["class"]),kt("div",{ref_key:"wrapperRef",ref:l,class:R(e(_)("relative min-h-40 flex-1 overflow-y-auto p-3",e(H),{"pointer-events-none":e(me)||e(E)}))},[C(n.$slots,"default")],2),e(me)||e(E)?(f(),h(e(Et),{key:0,spinning:""})):k("",!0),e(Ie)?(f(),h(e(ct),{key:1,class:"hover:bg-accent hover:text-accent-foreground text-foreground/80 flex-center absolute right-10 top-3 hidden size-6 rounded-full px-1 text-lg opacity-70 transition-opacity hover:opacity-100 focus:outline-none disabled:pointer-events-none sm:block",onClick:qe},{default:v(()=>[e(D)?(f(),h(e(Pt),{key:0,class:"size-3.5"})):(f(),h(e(It),{key:1,class:"size-3.5"}))]),_:1})):k("",!0),e(O)?(f(),h(e(Rt),{key:2,ref_key:"footerRef",ref:b,class:R(e(_)("flex-row items-center justify-end p-2",{"border-t":e(g)},e(L)))},{default:v(()=>[C(n.$slots,"prepend-footer"),C(n.$slots,"footer",{},()=>[e(ze)?(f(),h(ke(e(s).DefaultButton||e(we)),{key:0,variant:"ghost",disabled:e(E),onClick:w[0]||(w[0]=()=>{var K;return(K=o.modalApi)==null?void 0:K.onCancel()})},{default:v(()=>[C(n.$slots,"cancelText",{},()=>[J(G(e(x)||e(r)("cancel")),1)])]),_:3},8,["disabled"])):k("",!0),C(n.$slots,"center-footer"),e(Re)?(f(),h(ke(e(s).PrimaryButton||e(we)),{key:1,disabled:e(I),loading:e(Y)||e(E),onClick:w[1]||(w[1]=()=>{var K;return(K=o.modalApi)==null?void 0:K.onConfirm()})},{default:v(()=>[C(n.$slots,"confirmText",{},()=>[J(G(e(q)||e(r)("confirm")),1)])]),_:3},8,["disabled","loading"])):k("",!0)]),C(n.$slots,"append-footer")]),_:3},8,["class"])):k("",!0)]),_:3},8,["append-to","class","force-mount","modal","open","show-close","animation-type","z-index","overlay-blur","close-disabled"])]}),_:3},8,["open"])}}});class Yt{constructor(t={}){U(this,"sharedData",{payload:{}});U(this,"store");U(this,"api");U(this,"state");const u=t,{connectedComponent:s,onBeforeClose:a,onCancel:l,onClosed:i,onConfirm:p,onOpenChange:b,onOpened:m}=u,r=j(u,["connectedComponent","onBeforeClose","onCancel","onClosed","onConfirm","onOpenChange","onOpened"]),c={bordered:!0,centered:!1,class:"",closeOnClickModal:!0,closeOnPressEscape:!0,confirmDisabled:!1,confirmLoading:!1,contentClass:"",destroyOnClose:!0,draggable:!1,footer:!0,footerClass:"",fullscreen:!1,fullscreenButton:!0,header:!0,headerClass:"",isOpen:!1,loading:!1,modal:!0,openAutoFocus:!1,showCancelButton:!0,showConfirmButton:!0,title:"",animationType:"slide"};this.store=new ut(y(y({},c),r),{onUpdate:()=>{var g,x,B;const d=this.store.state;(d==null?void 0:d.isOpen)===((g=this.state)==null?void 0:g.isOpen)?this.state=d:(this.state=d,(B=(x=this.api).onOpenChange)==null||B.call(x,!!(d!=null&&d.isOpen)))}}),this.state=this.store.state,this.api={onBeforeClose:a,onCancel:l,onClosed:i,onConfirm:p,onOpenChange:b,onOpened:m},Bt(this)}close(){return W(this,null,function*(){var s,a,l;((l=yield(a=(s=this.api).onBeforeClose)==null?void 0:a.call(s))!=null?l:!0)&&this.store.setState(i=>z(y({},i),{isOpen:!1}))})}getData(){var t,s;return(s=(t=this.sharedData)==null?void 0:t.payload)!=null?s:{}}lock(t=!0){return this.setState({submitting:t})}onCancel(){var t,s;this.api.onCancel?(s=(t=this.api).onCancel)==null||s.call(t):this.close()}onClosed(){var t,s;this.state.isOpen||(s=(t=this.api).onClosed)==null||s.call(t)}onConfirm(){var t,s;(s=(t=this.api).onConfirm)==null||s.call(t)}onOpened(){var t,s;this.state.isOpen&&((s=(t=this.api).onOpened)==null||s.call(t))}open(){this.store.setState(t=>z(y({},t),{isOpen:!0,submitting:!1}))}setData(t){return this.sharedData.payload=t,this}setState(t){return Ot(t)?this.store.setState(t):this.store.setState(s=>y(y({},s),t)),this}unlock(){return this.lock(!1)}}const Me=Symbol("APP_MODAL_INJECT"),qt={};function Gt(o={}){var m;const{connectedComponent:t}=o;if(t){const r=$e({}),c=M(!0);return[A((d,{attrs:g,slots:x})=>(Ee(Me,{extendApi(T){Object.setPrototypeOf(r,T)},options:o,reCreateModal(){return W(this,null,function*(){c.value=!1,yield pe(),c.value=!0})}}),Ht(r,y(y(y({},d),g),x)),()=>Be(c.value?t:"div",y(y({},d),g),x)),{name:"AIFlowyParentModal",inheritAttrs:!1}),r]}const s=Te(Me,{}),a=y(y(y({},qt),s.options),o);a.onOpenChange=r=>{var c,u,d;(c=o.onOpenChange)==null||c.call(o,r),(d=(u=s.options)==null?void 0:u.onOpenChange)==null||d.call(u,r)};const l=a.onClosed;a.onClosed=()=>{var r;l==null||l(),a.destroyOnClose&&((r=s.reCreateModal)==null||r.call(s))};const i=new Yt(a),p=i;p.useStore=r=>pt(i.store,r);const b=A((r,{attrs:c,slots:u})=>()=>Be(Xt,z(y(y({},r),c),{modalApi:p}),u),{name:"AIFlowyModal",inheritAttrs:!1});return(m=s.extendApi)==null||m.call(s,p),[b,p]}function Ht(o,t){return W(this,null,function*(){var l;if(!t||Object.keys(t).length===0)return;yield pe();const s=(l=o==null?void 0:o.store)==null?void 0:l.state;if(!s)return;const a=new Set(Object.keys(s));for(const i of Object.keys(t))a.has(i)&&!["class"].includes(i)&&console.warn(`[AIFlowy Modal]: When 'connectedComponent' exists, do not set props or slots '${i}', which will increase complexity. If you need to modify the props of Modal, please use useAIFlowyModal or api.`)})}export{Jt as C,Gt as u};
