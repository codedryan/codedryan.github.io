var ie=Object.defineProperty,de=Object.defineProperties;var fe=Object.getOwnPropertyDescriptors;var j=Object.getOwnPropertySymbols;var le=Object.prototype.hasOwnProperty,ve=Object.prototype.propertyIsEnumerable;var M=(e,t,n)=>t in e?ie(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,R=(e,t)=>{for(var n in t||(t={}))le.call(t,n)&&M(e,n,t[n]);if(j)for(var n of j(t))ve.call(t,n)&&M(e,n,t[n]);return e},I=(e,t)=>de(e,fe(t));var W=(e,t,n)=>new Promise((o,a)=>{var c=f=>{try{v(n.next(f))}catch(m){a(m)}},l=f=>{try{v(n.throw(f))}catch(m){a(m)}},v=f=>f.done?o(f.value):Promise.resolve(f.value).then(c,l);v((n=n.apply(e,t)).next())});import{f as pe}from"./aria-DEUWDJ1E.js";import{o as D,ak as B,r as L,k as se,x as K,w as N,u as b,A as J,a8 as Ee,X as me,B as Te,n as Fe,au as be}from"../jse/index-index-D3Xb8oT_.js";import{i as X,bv as oe,bx as re,an as ae,bp as _e,bm as ye,bn as Pe,aq as Le}from"./bootstrap-Bf65uz2I.js";const A="focus-trap.focus-after-trapped",U="focus-trap.focus-after-released",Se="focus-trap.focusout-prevented",Y={cancelable:!0,bubbles:!1},we={cancelable:!0,bubbles:!1},z="focusAfterTrapped",G="focusAfterReleased",he=Symbol("elFocusTrap"),$=L(),S=L(0),H=L(0);let _=0;const ce=e=>{const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:o=>{const a=o.tagName==="INPUT"&&o.type==="hidden";return o.disabled||o.hidden||a?NodeFilter.FILTER_SKIP:o.tabIndex>=0||o===document.activeElement?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t},Q=(e,t)=>{for(const n of e)if(!Ce(n,t))return n},Ce=(e,t)=>{if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1},Oe=e=>{const t=ce(e),n=Q(t,e),o=Q(t.reverse(),e);return[n,o]},ge=e=>e instanceof HTMLInputElement&&"select"in e,E=(e,t)=>{if(e){const n=document.activeElement;pe(e,{preventScroll:!0}),H.value=window.performance.now(),e!==n&&ge(e)&&t&&e.select()}};function Z(e,t){const n=[...e],o=e.indexOf(t);return o!==-1&&n.splice(o,1),n}const ke=()=>{let e=[];return{push:o=>{const a=e[0];a&&o!==a&&a.pause(),e=Z(e,o),e.unshift(o)},remove:o=>{var a,c;e=Z(e,o),(c=(a=e[0])==null?void 0:a.resume)==null||c.call(a)}}},Re=(e,t=!1)=>{const n=document.activeElement;for(const o of e)if(E(o,t),document.activeElement!==n)return},ee=ke(),Ie=()=>S.value>H.value,y=()=>{$.value="pointer",S.value=window.performance.now()},te=()=>{$.value="keyboard",S.value=window.performance.now()},Ne=()=>(D(()=>{_===0&&(document.addEventListener("mousedown",y),document.addEventListener("touchstart",y),document.addEventListener("keydown",te)),_++}),B(()=>{_--,_<=0&&(document.removeEventListener("mousedown",y),document.removeEventListener("touchstart",y),document.removeEventListener("keydown",te))}),{focusReason:$,lastUserFocusTimestamp:S,lastAutomatedFocusTimestamp:H}),P=e=>new CustomEvent(Se,I(R({},we),{detail:e}));let T=[];const ne=e=>{oe(e)===re.esc&&T.forEach(n=>n(e))},Ae=e=>{D(()=>{T.length===0&&document.addEventListener("keydown",ne),X&&T.push(e)}),B(()=>{T=T.filter(t=>t!==e),T.length===0&&X&&document.removeEventListener("keydown",ne)})},Ue=se({name:"ElFocusTrap",inheritAttrs:!1,props:{loop:Boolean,trapped:Boolean,focusTrapEl:Object,focusStartEl:{type:[Object,String],default:"first"}},emits:[z,G,"focusin","focusout","focusout-prevented","release-requested"],setup(e,{emit:t}){const n=L();let o,a;const{focusReason:c}=Ne();Ae(s=>{e.trapped&&!l.paused&&t("release-requested",s)});const l={paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}},v=s=>{if(!e.loop&&!e.trapped||l.paused)return;const{altKey:r,ctrlKey:u,metaKey:i,currentTarget:d,shiftKey:C}=s,{loop:q}=e,ue=oe(s)===re.tab&&!r&&!u&&!i,F=document.activeElement;if(ue&&F){const O=d,[g,k]=Oe(O);if(g&&k){if(!C&&F===k){const p=P({focusReason:c.value});t("focusout-prevented",p),p.defaultPrevented||(s.preventDefault(),q&&E(g,!0))}else if(C&&[g,O].includes(F)){const p=P({focusReason:c.value});t("focusout-prevented",p),p.defaultPrevented||(s.preventDefault(),q&&E(k,!0))}}else if(F===O){const p=P({focusReason:c.value});t("focusout-prevented",p),p.defaultPrevented||s.preventDefault()}}};me(he,{focusTrapRef:n,onKeydown:v}),N(()=>e.focusTrapEl,s=>{s&&(n.value=s)},{immediate:!0}),N([n],([s],[r])=>{s&&(s.addEventListener("keydown",v),s.addEventListener("focusin",w),s.addEventListener("focusout",h)),r&&(r.removeEventListener("keydown",v),r.removeEventListener("focusin",w),r.removeEventListener("focusout",h))});const f=s=>{t(z,s)},m=s=>t(G,s),w=s=>{const r=b(n);if(!r)return;const u=s.target,i=s.relatedTarget,d=u&&r.contains(u);e.trapped||i&&r.contains(i)||(o=i),d&&t("focusin",s),!l.paused&&e.trapped&&(d?a=u:E(a,!0))},h=s=>{const r=b(n);if(!(l.paused||!r))if(e.trapped){const u=s.relatedTarget;!_e(u)&&!r.contains(u)&&setTimeout(()=>{if(!l.paused&&e.trapped){const i=P({focusReason:c.value});t("focusout-prevented",i),i.defaultPrevented||E(a,!0)}},0)}else{const u=s.target;u&&r.contains(u)||t("focusout",s)}};function V(){return W(this,null,function*(){yield J();const s=b(n);if(s){ee.push(l);const r=s.contains(document.activeElement)?o:document.activeElement;if(o=r,!s.contains(r)){const i=new Event(A,Y);s.addEventListener(A,f),s.dispatchEvent(i),i.defaultPrevented||J(()=>{let d=e.focusStartEl;Ee(d)||(E(d),document.activeElement!==d&&(d="first")),d==="first"&&Re(ce(s),!0),(document.activeElement===r||d==="container")&&E(s)})}}})}function x(){const s=b(n);if(s){s.removeEventListener(A,f);const r=new CustomEvent(U,I(R({},Y),{detail:{focusReason:c.value}}));s.addEventListener(U,m),s.dispatchEvent(r),!r.defaultPrevented&&(c.value=="keyboard"||!Ie()||s.contains(document.activeElement))&&E(o!=null?o:document.body),s.removeEventListener(U,m),ee.remove(l),o=null,a=null}}return D(()=>{e.trapped&&V(),N(()=>e.trapped,s=>{s?V():x()})}),B(()=>{e.trapped&&x(),n.value&&(n.value.removeEventListener("keydown",v),n.value.removeEventListener("focusin",w),n.value.removeEventListener("focusout",h),n.value=void 0)}),{onKeydown:v}}});function Ke(e,t,n,o,a,c){return K(e.$slots,"default",{handleKeydown:e.onKeydown})}var We=ae(Ue,[["render",Ke],["__file","focus-trap.vue"]]);const De=ye({to:{type:Pe([String,Object]),required:!0},disabled:Boolean}),Be=se({__name:"teleport",props:De,setup(e){return(t,n)=>t.disabled?K(t.$slots,"default",{key:0}):(Fe(),Te(be,{key:1,to:t.to},[K(t.$slots,"default")],8,["to"]))}});var $e=ae(Be,[["__file","teleport.vue"]]);const Je=Le($e);export{We as E,he as F,Je as a,De as t};
