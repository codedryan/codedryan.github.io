var Z=Object.defineProperty,ee=Object.defineProperties;var le=Object.getOwnPropertyDescriptors;var R=Object.getOwnPropertySymbols;var oe=Object.prototype.hasOwnProperty,te=Object.prototype.propertyIsEnumerable;var z=(m,n,u)=>n in m?Z(m,n,{enumerable:!0,configurable:!0,writable:!0,value:u}):m[n]=u,f=(m,n)=>{for(var u in n||(n={}))oe.call(n,u)&&z(m,u,n[u]);if(R)for(var u of R(n))te.call(n,u)&&z(m,u,n[u]);return m},$=(m,n)=>ee(m,le(n));var I=(m,n,u)=>new Promise((x,V)=>{var k=p=>{try{C(u.next(p))}catch(v){V(v)}},L=p=>{try{C(u.throw(p))}catch(v){V(v)}},C=p=>p.done?x(p.value):Promise.resolve(p.value).then(k,L);C((u=u.apply(m,n)).next())});import{$ as o,V as J,a0 as j,M as N,R as h}from"./bootstrap-Bf65uz2I.js";import"./css-gf8D6QlL.js";import{E as ae}from"./el-dialog-CAR1-R4U.js";import"./el-overlay-Zuw8glOl.js";/* empty css                */import{E as re,a as s}from"./el-form-item-8FQp7Cs4.js";import"./css-C9o_OfXA.js";/* empty css                  *//* empty css               *//* empty css                     *//* empty css                  */import"./css-DCrZaNHy.js";/* empty css                   */import{D as w}from"./DictSelect-DdOvS-6R.js";import{U as de}from"./UploadAvatar-a3x1lqjM.js";import{ElInput as g}from"./index-BjDsryRX.js";import{E as F,a as _}from"./index-DcZY4wgD.js";import{E as G}from"./index-CMBjNRIa.js";import{ElSwitch as ue}from"./index-CHf9SThW.js";import{ElButton as H}from"./index-oBOAcXl-.js";import{k as ie,r as c,o as ne,B as U,n as b,E as d,J as r,u as e,p as se,m as A,F as B,N as P,q as K,L as q,y as D}from"../jse/index-index-D3Xb8oT_.js";const me={style:{display:"flex","align-items":"center"}},pe={style:{display:"flex","align-items":"center"}},we=ie({__name:"DocumentCollectionModal",emits:["reload"],setup(m,{expose:n,emit:u}){const x=u,V=c([]),k=c([]),L=()=>I(null,null,function*(){try{const a=yield N.get("/api/v1/model/list?modelType=embeddingModel",{});a.errorCode===0&&(V.value=a.data)}catch(i){h.error(o("message.apiError")),console.error("获取嵌入模型列表失败：",i)}}),C=()=>I(null,null,function*(){try{const i=yield N.get("/api/v1/model/list?modelType=rerankModel");k.value=i.data}catch(i){h.error(o("message.apiError")),console.error("获取重排模型列表失败：",i)}});ne(()=>I(null,null,function*(){yield L(),yield C()}));const p=c(),v=c(!1),E=c(!0),Q=c([{value:"milvus",label:"Milvus"},{value:"redis",label:"Redis"},{value:"opensearch",label:"OpenSearch"},{value:"elasticsearch",label:"ElasticSearch"},{value:"aliyun",label:o("documentCollection.alibabaCloud")},{value:"qcloud",label:o("documentCollection.tencentCloud")}]),M={alias:"",deptId:"",icon:"",title:"",categoryId:"",description:"",summaryPrompt:"",slug:"",authType:0,scopeOfAuthorityDeptIds:[],vectorStoreEnable:!1,vectorStoreType:"",vectorStoreCollection:"",vectorStoreConfig:"",vectorEmbedModelId:"",dimensionOfVectorModel:void 0,options:{canUpdateEmbeddingModel:!0},rerankModelId:"",searchEngineEnable:"",englishName:""},t=c(f({},M)),T=c(!1),W=c({deptId:[{required:!0,message:o("message.required"),trigger:"blur"}],englishName:[{required:!0,message:o("message.required"),trigger:"blur"}],description:[{required:!0,message:o("message.required"),trigger:"blur"}],title:[{required:!0,message:o("message.required"),trigger:"blur"}],vectorStoreType:[{required:!0,message:o("message.required"),trigger:"blur"}],vectorStoreCollection:[{required:!0,message:o("message.required"),trigger:"blur"}],vectorStoreConfig:[{required:!0,message:o("message.required"),trigger:"blur"}],vectorEmbedModelId:[{required:!0,message:o("message.required"),trigger:"blur"}]});function X(i={}){i.id?(E.value=!1,t.value=$(f(f({},M),i),{options:f(f({},M.options),i.options)})):(E.value=!0,t.value=f({},M)),v.value=!0}function Y(){return I(this,null,function*(){var i;try{if(!(yield(i=p.value)==null?void 0:i.validate()))return;T.value=!0;const l=yield N.post(E.value?"/api/v1/documentCollection/save":"/api/v1/documentCollection/update",t.value);l.errorCode===0?(h.success(l.message||o("message.saveSuccess")),x("reload"),O()):h.error(l.message||o("message.saveFail"))}catch(a){h.error(o("message.saveFail")),console.error("保存失败：",a)}finally{T.value=!1}})}function O(){var i;(i=p.value)==null||i.resetFields(),E.value=!0,t.value=f({},M),v.value=!1}return n({openDialog:X}),(i,a)=>(b(),U(e(ae),{modelValue:v.value,"onUpdate:modelValue":a[16]||(a[16]=l=>v.value=l),draggable:"",title:E.value?e(o)("button.add"):e(o)("button.edit"),"before-close":O,"close-on-click-modal":!1,"align-center":""},{footer:d(()=>[r(e(H),{onClick:O},{default:d(()=>[q(D(e(o)("button.cancel")),1)]),_:1}),r(e(H),{type:"primary",onClick:Y,loading:T.value,disabled:T.value},{default:d(()=>[q(D(e(o)("button.save")),1)]),_:1},8,["loading","disabled"])]),default:d(()=>[r(e(re),{"label-width":"150px",ref_key:"saveForm",ref:p,model:t.value,"status-icon":"",rules:W.value},{default:d(()=>[r(e(s),{prop:"icon",label:e(o)("documentCollection.icon"),style:{display:"flex","align-items":"center"}},{default:d(()=>[r(de,{modelValue:t.value.icon,"onUpdate:modelValue":a[0]||(a[0]=l=>t.value.icon=l)},null,8,["modelValue"])]),_:1},8,["label"]),r(e(s),{prop:"title",label:e(o)("documentCollection.title")},{default:d(()=>[r(e(g),{modelValue:t.value.title,"onUpdate:modelValue":a[1]||(a[1]=l=>t.value.title=l),modelModifiers:{trim:!0},placeholder:e(o)("documentCollection.placeholder.title")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),r(e(s),{prop:"categoryId",label:e(o)("documentCollection.categoryId")},{default:d(()=>[r(w,{modelValue:t.value.categoryId,"onUpdate:modelValue":a[2]||(a[2]=l=>t.value.categoryId=l),"dict-code":"aiDocumentCollectionCategory"},null,8,["modelValue"])]),_:1},8,["label"]),r(e(s),{prop:"alias",label:e(o)("documentCollection.alias")},{default:d(()=>[r(e(g),{modelValue:t.value.alias,"onUpdate:modelValue":a[3]||(a[3]=l=>t.value.alias=l),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1},8,["label"]),r(e(s),{prop:"englishName",label:e(o)("documentCollection.englishName")},{default:d(()=>[r(e(g),{modelValue:t.value.englishName,"onUpdate:modelValue":a[4]||(a[4]=l=>t.value.englishName=l),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1},8,["label"]),r(e(s),{prop:"description",label:e(o)("documentCollection.description")},{default:d(()=>[r(e(g),{modelValue:t.value.description,"onUpdate:modelValue":a[5]||(a[5]=l=>t.value.description=l),modelModifiers:{trim:!0},rows:4,type:"textarea",placeholder:e(o)("documentCollection.placeholder.description")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),r(e(s),{prop:"summaryPrompt",label:e(o)("documentCollection.summaryPrompt")},{default:d(()=>[r(e(g),{modelValue:t.value.summaryPrompt,"onUpdate:modelValue":a[6]||(a[6]=l=>t.value.summaryPrompt=l),modelModifiers:{trim:!0},rows:4,type:"textarea",placeholder:e(o)("documentCollection.placeholder.summaryPrompt")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),r(e(s),{prop:"vectorStoreType",label:e(o)("documentCollection.vectorStoreType")},{default:d(()=>[r(e(F),{modelValue:t.value.vectorStoreType,"onUpdate:modelValue":a[7]||(a[7]=l=>t.value.vectorStoreType=l),placeholder:e(o)("documentCollection.placeholder.vectorStoreType")},{default:d(()=>[(b(!0),A(B,null,P(Q.value,l=>(b(),U(e(_),{key:l.value,label:l.label,value:l.value||""},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),r(e(s),{prop:"vectorStoreCollection",label:e(o)("documentCollection.vectorStoreCollection")},{default:d(()=>[r(e(g),{modelValue:t.value.vectorStoreCollection,"onUpdate:modelValue":a[8]||(a[8]=l=>t.value.vectorStoreCollection=l),modelModifiers:{trim:!0},placeholder:e(o)("documentCollection.placeholder.vectorStoreCollection")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),r(e(s),{prop:"vectorStoreConfig",label:e(o)("documentCollection.vectorStoreConfig")},{default:d(()=>[r(e(g),{modelValue:t.value.vectorStoreConfig,"onUpdate:modelValue":a[9]||(a[9]=l=>t.value.vectorStoreConfig=l),modelModifiers:{trim:!0},rows:4,type:"textarea"},null,8,["modelValue"])]),_:1},8,["label"]),r(e(s),{prop:"vectorEmbedModelId"},{label:d(()=>[K("span",me,[q(D(e(o)("documentCollection.vectorEmbedLlmId"))+" ",1),r(e(G),{content:e(o)("documentCollection.vectorEmbedModelTips"),placement:"top",effect:"light"},{default:d(()=>[r(e(J),{style:{"margin-left":"4px",color:"#909399",cursor:"pointer","font-size":"14px"}},{default:d(()=>[r(e(j))]),_:1})]),_:1},8,["content"])])]),default:d(()=>{var l,S;return[r(e(F),{modelValue:t.value.vectorEmbedModelId,"onUpdate:modelValue":a[10]||(a[10]=y=>t.value.vectorEmbedModelId=y),disabled:!((S=(l=t.value)==null?void 0:l.options)!=null&&S.canUpdateEmbeddingModel),placeholder:e(o)("documentCollection.placeholder.embedLlm")},{default:d(()=>[(b(!0),A(B,null,P(V.value,y=>(b(),U(e(_),{key:y.id,label:y.title,value:y.id||""},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled","placeholder"])]}),_:1}),r(e(s),{prop:"dimensionOfVectorModel",label:e(o)("documentCollection.dimensionOfVectorModel")},{label:d(()=>[K("span",pe,[q(D(e(o)("documentCollection.dimensionOfVectorModel"))+" ",1),r(e(G),{content:e(o)("documentCollection.dimensionOfVectorModelTips"),placement:"top",effect:"light"},{default:d(()=>[r(e(J),{style:{"margin-left":"4px",color:"#909399",cursor:"pointer","font-size":"14px"}},{default:d(()=>[r(e(j))]),_:1})]),_:1},8,["content"])])]),default:d(()=>{var l,S;return[r(e(g),{disabled:!((S=(l=t.value)==null?void 0:l.options)!=null&&S.canUpdateEmbeddingModel),modelValue:t.value.dimensionOfVectorModel,"onUpdate:modelValue":a[11]||(a[11]=y=>t.value.dimensionOfVectorModel=y),modelModifiers:{trim:!0},type:"number"},null,8,["disabled","modelValue"])]}),_:1},8,["label"]),r(e(s),{prop:"rerankModelId",label:e(o)("documentCollection.rerankLlmId")},{default:d(()=>[r(e(F),{modelValue:t.value.rerankModelId,"onUpdate:modelValue":a[12]||(a[12]=l=>t.value.rerankModelId=l),placeholder:e(o)("documentCollection.placeholder.rerankLlm")},{default:d(()=>[(b(!0),A(B,null,P(k.value,l=>(b(),U(e(_),{key:l.id,label:l.title,value:l.id||""},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),r(e(s),{prop:"searchEngineEnable",label:e(o)("documentCollection.searchEngineEnable")},{default:d(()=>[r(e(ue),{modelValue:t.value.searchEngineEnable,"onUpdate:modelValue":a[13]||(a[13]=l=>t.value.searchEngineEnable=l)},null,8,["modelValue"])]),_:1},8,["label"]),r(e(s),{prop:"authType",label:e(o)("documentCollection.authType")},{default:d(()=>[r(w,{modelValue:t.value.authType,"onUpdate:modelValue":a[14]||(a[14]=l=>t.value.authType=l),"dict-code":"deptAuthType"},null,8,["modelValue"])]),_:1},8,["label"]),t.value.authType===1?(b(),U(e(s),{key:0,prop:"scopeOfAuthorityDeptIds",label:e(o)("documentCollection.scopeOfAuthorityDeptIds")},{default:d(()=>[r(w,{modelValue:t.value.scopeOfAuthorityDeptIds,"onUpdate:modelValue":a[15]||(a[15]=l=>t.value.scopeOfAuthorityDeptIds=l),multiple:"","dict-code":"sysDept"},null,8,["modelValue"])]),_:1},8,["label"])):se("",!0)]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"]))}});export{we as _};
