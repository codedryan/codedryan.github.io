var G=Object.defineProperty;var S=Object.getOwnPropertySymbols;var H=Object.prototype.hasOwnProperty,Q=Object.prototype.propertyIsEnumerable;var B=(d,r,m)=>r in d?G(d,r,{enumerable:!0,configurable:!0,writable:!0,value:m}):d[r]=m,g=(d,r)=>{for(var m in r||(r={}))H.call(r,m)&&B(d,m,r[m]);if(S)for(var m of S(r))Q.call(r,m)&&B(d,m,r[m]);return d};import{$ as l,M as N,R as U,_ as W}from"./bootstrap-Bf65uz2I.js";import"./css-gf8D6QlL.js";import{E as X}from"./el-dialog-CAR1-R4U.js";import"./el-overlay-Zuw8glOl.js";/* empty css                */import{E as Y,a as E}from"./el-form-item-8FQp7Cs4.js";import"./css-C9o_OfXA.js";import"./css-DCrZaNHy.js";import{E as Z,a as w}from"./el-table-JPhh2aff.js";import"./css-_QzOlLq8.js";/* empty css                   *//* empty css                  *//* empty css                     *//* empty css                        *//* empty css               */import{a as K,E as D}from"./el-tabs-BUyJm6xP.js";import{ElInput as M}from"./index-BjDsryRX.js";import{ElSwitch as ee}from"./index-CHf9SThW.js";import{ElButton as I}from"./index-oBOAcXl-.js";import{k as te,o as oe,r as p,B as ae,n as f,E as s,J as a,u as e,m as _,p as L,F as le,N as se,q as u,L as x,y as v}from"../jse/index-index-D3Xb8oT_.js";import"./index-B3qAv2kq.js";import"./aria-DEUWDJ1E.js";import"./refs-D6FW0B1r.js";import"./event-BB_Ol6Sd.js";import"./index-Bxb6QITi.js";import"./index-Dg3fRnQE.js";import"./vnode-DysYOGZN.js";import"./scroll-C2492Iw_.js";import"./use-form-common-props-IzjzSHax.js";import"./castArray-BBset58W.js";import"./_baseClone-trfKWgGN.js";import"./index-CbSmxnRE.js";import"./util-B2mB0_6C.js";import"./index-bT9OJj6t.js";import"./_overRest-Bb9G3v08.js";import"./index-CMBjNRIa.js";import"./merge-BysAs727.js";import"./isArrayLikeObject-j3RaJGb0.js";import"./_baseSlice-DZe_dRSe.js";import"./_baseIteratee-rJjBrWyx.js";import"./debounce-AsHllEOy.js";import"./toNumber-CvayJyp9.js";import"./index-p7kg-xKH.js";import"./use-form-item-DVWmmqeW.js";import"./omit-CbyqVLxv.js";import"./index-pv0R11Cf.js";import"./raf-BVBe43_O.js";import"./use-wheel-C9oFsIdW.js";import"./strings-CGsg9AfI.js";import"./clamp-CeuJyDnc.js";import"./index-DSAOTmKA.js";import"./index-C33Sf0pH.js";import"./index-m1ZP1zbM.js";import"./validator-D2YZey62.js";const ie={key:0},re={key:0,class:"params-list"},me={class:"params-left-title-container"},ne={class:"content-title"},de={key:0,class:"required-mark"},pe={class:"params-desc-container"},ue={class:"content-title"},ce={class:"content-desc"},fe={key:1,class:"params-name"},ve={class:"content-left"},_e={class:"content-title"},be={class:"content-desc"},ge=te({__name:"McpModal",emits:["reload"],setup(d,{expose:r,emit:m}){const O=m;oe(()=>{}),r({openDialog:P});const k=p(),V=p(!1),c=p(!0),b=p(!1),y={title:"",description:"",configJson:"",deptId:"",status:!1,tools:[]},i=p(g({},y)),j=p({title:[{required:!0,message:l("message.required"),trigger:"blur"}],configJson:[{required:!0,message:l("message.required"),trigger:"blur"}]});function P(n={}){c.value=!n.id,i.value=g(g({},y),n),c.value||$(n),V.value=!0}function $(n){N.post("api/v1/mcp/getMcpTools",{id:n.id}).then(o=>{o.errorCode===0&&(i.value.tools=o.data.tools)})}function A(){var n;(n=k.value)==null||n.validate(o=>{o&&(b.value=!0,N.post(c.value?"api/v1/mcp/save":"api/v1/mcp/update",i.value).then(t=>{b.value=!1,t.errorCode===0&&(c.value?U.success(l("message.saveOkMessage")):U.success(l("message.updateOkMessage")),O("reload"),h())}).catch(()=>{b.value=!1}))})}function h(){var n;(n=k.value)==null||n.resetFields(),c.value=!0,i.value=g({},y),V.value=!1}const R=p(`{
  "mcpServers": {
    "12306-mcp": {
      "command": "npx.cmd",
      "args": [
        "-y",
        "12306-mcp"
      ]
    }
  }
}`),q=p("config");return(n,o)=>(f(),ae(e(X),{modelValue:V.value,"onUpdate:modelValue":o[5]||(o[5]=t=>V.value=t),draggable:"",title:c.value?e(l)("button.add"):e(l)("button.edit"),"before-close":h,"close-on-click-modal":!1},{footer:s(()=>[a(e(I),{onClick:h},{default:s(()=>[x(v(e(l)("button.cancel")),1)]),_:1}),a(e(I),{type:"primary",onClick:A,loading:b.value,disabled:b.value},{default:s(()=>[x(v(e(l)("button.save")),1)]),_:1},8,["loading","disabled"])]),default:s(()=>[a(e(K),{modelValue:q.value,"onUpdate:modelValue":o[4]||(o[4]=t=>q.value=t),class:"demo-tabs"},{default:s(()=>[a(e(D),{label:e(l)("mcp.modal.config"),name:"config"},{default:s(()=>[a(e(Y),{"label-width":"120px",ref_key:"saveForm",ref:k,model:i.value,"status-icon":"",rules:j.value},{default:s(()=>[a(e(E),{prop:"title",label:e(l)("mcp.title")},{default:s(()=>[a(e(M),{modelValue:i.value.title,"onUpdate:modelValue":o[0]||(o[0]=t=>i.value.title=t),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1},8,["label"]),a(e(E),{prop:"description",label:e(l)("mcp.description")},{default:s(()=>[a(e(M),{modelValue:i.value.description,"onUpdate:modelValue":o[1]||(o[1]=t=>i.value.description=t),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1},8,["label"]),a(e(E),{prop:"configJson",label:e(l)("mcp.configJson")},{default:s(()=>[a(e(M),{type:"textarea",rows:15,modelValue:i.value.configJson,"onUpdate:modelValue":o[2]||(o[2]=t=>i.value.configJson=t),modelModifiers:{trim:!0},placeholder:e(l)("mcp.example")+R.value},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(e(E),{prop:"status",label:e(l)("mcp.status")},{default:s(()=>[a(e(ee),{modelValue:i.value.status,"onUpdate:modelValue":o[3]||(o[3]=t=>i.value.status=t)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model","rules"])]),_:1},8,["label"]),c.value?L("",!0):(f(),_("div",ie,[a(e(D),{label:e(l)("mcp.modal.tool"),name:"tool"},{default:s(()=>[a(e(Z),{data:i.value.tools,border:"","preserve-expanded-content":!0},{default:s(()=>[a(e(w),{type:"expand"},{default:s(t=>{var C,T;return[(T=(C=t.row)==null?void 0:C.inputSchema)!=null&&T.properties?(f(),_("div",re,[(f(!0),_(le,null,se(Object.entries(t.row.inputSchema.properties),([F,J],z)=>(f(),_("div",{key:z,class:"params-content-container"},[u("div",me,[u("div",ne,[x(v(F)+" ",1),t.row.inputSchema.required&&t.row.inputSchema.required.includes(F)?(f(),_("span",de," * ")):L("",!0)])]),u("div",pe,[u("div",ue,v(J.type||"未知类型"),1),u("div",ce,v(J.description||"无描述"),1)])]))),128))])):(f(),_("div",fe,"暂无属性配置"))]}),_:1}),a(e(w),{label:e(l)("mcp.modal.table.availableTools")},{default:s(({row:t})=>[u("div",ve,[u("span",_e,v(t.name),1),u("span",be,v(t.description),1)])]),_:1},8,["label"])]),_:1},8,["data"])]),_:1},8,["label"])]))]),_:1},8,["modelValue"])]),_:1},8,["modelValue","title"]))}}),Et=W(ge,[["__scopeId","data-v-09226089"]]);export{Et as default};
