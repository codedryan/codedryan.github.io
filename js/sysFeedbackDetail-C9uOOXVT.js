var ne=Object.defineProperty,oe=Object.defineProperties;var ie=Object.getOwnPropertyDescriptors;var J=Object.getOwnPropertySymbols;var ce=Object.prototype.hasOwnProperty,de=Object.prototype.propertyIsEnumerable;var Q=(p,e,a)=>e in p?ne(p,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):p[e]=a,T=(p,e)=>{for(var a in e||(e={}))ce.call(e,a)&&Q(p,a,e[a]);if(J)for(var a of J(e))de.call(e,a)&&Q(p,a,e[a]);return p},B=(p,e)=>oe(p,ie(e));var U=(p,e,a)=>new Promise((S,o)=>{var c=s=>{try{N(a.next(s))}catch(l){o(l)}},k=s=>{try{N(a.throw(s))}catch(l){o(l)}},N=s=>s.done?S(s.value):Promise.resolve(s.value).then(c,k);N((a=a.apply(p,e)).next())});import{bC as O,ao as te,bp as pe,bm as K,bn as ue,an as se,bq as be,cB as fe,aq as me,$ as d,as as ye,Q as X,M as H,aI as ve,aL as he,bT as ge,aW as ke,R as _e}from"./bootstrap-Bf65uz2I.js";import"./css-gf8D6QlL.js";import{E as we}from"./el-link-CfUnA7Pp.js";import{ElButton as q}from"./index-oBOAcXl-.js";import{g as Se,f as Ne}from"./vnode-DysYOGZN.js";import{k as I,I as j,P as W,i as ae,m as w,u as t,n as m,q as u,F as D,N as L,B as M,J as _,ah as Fe,c as Ce,p as xe,s as A,x as Y,L as C,y as v,X as Ee,r as Z,G as $e,o as De,E as F}from"../jse/index-index-D3Xb8oT_.js";import{u as Ie}from"./use-form-common-props-IzjzSHax.js";import"./index-Dg3fRnQE.js";import"./use-form-item-DVWmmqeW.js";import"./index-Bxb6QITi.js";const G=Symbol("elDescriptions");var z=I({name:"ElDescriptionsCell",props:{cell:{type:Object},tag:{type:String,default:"td"},type:{type:String}},setup(){return{descriptions:ae(G,{})}},render(){var p;const e=Se(this.cell),a=(((p=this.cell)==null?void 0:p.dirs)||[]).map(g=>{const{dir:b,arg:f,modifiers:P,value:$}=g;return[b,$,f,P]}),{border:S,direction:o}=this.descriptions,c=o==="vertical",k=()=>{var g,b,f;return((f=(b=(g=this.cell)==null?void 0:g.children)==null?void 0:b.label)==null?void 0:f.call(b))||e.label},N=()=>{var g,b,f;return(f=(b=(g=this.cell)==null?void 0:g.children)==null?void 0:b.default)==null?void 0:f.call(b)},s=e.span,l=e.rowspan,r=e.align?`is-${e.align}`:"",i=e.labelAlign?`is-${e.labelAlign}`:r,x=e.className,n=e.labelClassName,h=this.type==="label"&&(e.labelWidth||this.descriptions.labelWidth)||e.width,E={width:O(h),minWidth:O(e.minWidth)},y=te("descriptions");switch(this.type){case"label":return j(W(this.tag,{style:E,class:[y.e("cell"),y.e("label"),y.is("bordered-label",S),y.is("vertical-label",c),i,n],colSpan:c?s:1,rowspan:c?1:l},k()),a);case"content":return j(W(this.tag,{style:E,class:[y.e("cell"),y.e("content"),y.is("bordered-content",S),y.is("vertical-content",c),r,x],colSpan:c?s:s*2-1,rowspan:c?l*2-1:l},N()),a);default:{const g=k(),b={},f=O(e.labelWidth||this.descriptions.labelWidth);return f&&(b.width=f,b.display="inline-block"),j(W("td",{style:E,class:[y.e("cell"),r],colSpan:s,rowspan:l},[pe(g)?void 0:W("span",{style:b,class:[y.e("label"),n]},g),W("span",{class:[y.e("content"),x]},N())]),a)}}}});const Re=K({row:{type:ue(Array),default:()=>[]}}),Ae=I({name:"ElDescriptionsRow"}),We=I(B(T({},Ae),{props:Re,setup(p){const e=ae(G,{});return(a,S)=>t(e).direction==="vertical"?(m(),w(D,{key:0},[u("tr",null,[(m(!0),w(D,null,L(a.row,(o,c)=>(m(),M(t(z),{key:`tr1-${c}`,cell:o,tag:"th",type:"label"},null,8,["cell"]))),128))]),u("tr",null,[(m(!0),w(D,null,L(a.row,(o,c)=>(m(),M(t(z),{key:`tr2-${c}`,cell:o,tag:"td",type:"content"},null,8,["cell"]))),128))])],64)):(m(),w("tr",{key:1},[(m(!0),w(D,null,L(a.row,(o,c)=>(m(),w(D,{key:`tr3-${c}`},[t(e).border?(m(),w(D,{key:0},[_(t(z),{cell:o,tag:"td",type:"label"},null,8,["cell"]),_(t(z),{cell:o,tag:"td",type:"content"},null,8,["cell"])],64)):(m(),M(t(z),{key:1,cell:o,tag:"td",type:"both"},null,8,["cell"]))],64))),128))]))}}));var ze=se(We,[["__file","descriptions-row.vue"]]);const Pe=K({border:Boolean,column:{type:Number,default:3},direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},size:be,title:{type:String,default:""},extra:{type:String,default:""},labelWidth:{type:[String,Number],default:""}}),le="ElDescriptionsItem",Te=I({name:"ElDescriptions"}),Be=I(B(T({},Te),{props:Pe,setup(p){const e=p,a=te("descriptions"),S=Ie(),o=Fe();Ee(G,e);const c=Ce(()=>[a.b(),a.m(S.value)]),k=(s,l,r,i=!1)=>(s.props||(s.props={}),l>r&&(s.props.span=r),i&&(s.props.span=l),s),N=()=>{if(!o.default)return[];const s=Ne(o.default()).filter(h=>{var E;return((E=h==null?void 0:h.type)==null?void 0:E.name)===le}),l=[];let r=[],i=e.column,x=0;const n=[];return s.forEach((h,E)=>{var y,g,b;const f=((y=h.props)==null?void 0:y.span)||1,P=((g=h.props)==null?void 0:g.rowspan)||1,$=l.length;if(n[$]||(n[$]=0),P>1)for(let R=1;R<P;R++)n[b=$+R]||(n[b]=0),n[$+R]++,x++;if(n[$]>0&&(i-=n[$],n[$]=0),E<s.length-1&&(x+=f>i?i:f),E===s.length-1){const R=e.column-x%e.column;r.push(k(h,R,i,!0)),l.push(r);return}f<i?(i-=f,r.push(h)):(r.push(k(h,f,i)),l.push(r),i=e.column,r=[])}),l};return(s,l)=>(m(),w("div",{class:A(t(c))},[s.title||s.extra||s.$slots.title||s.$slots.extra?(m(),w("div",{key:0,class:A(t(a).e("header"))},[u("div",{class:A(t(a).e("title"))},[Y(s.$slots,"title",{},()=>[C(v(s.title),1)])],2),u("div",{class:A(t(a).e("extra"))},[Y(s.$slots,"extra",{},()=>[C(v(s.extra),1)])],2)],2)):xe("v-if",!0),u("div",{class:A(t(a).e("body"))},[u("table",{class:A([t(a).e("table"),t(a).is("bordered",s.border)])},[u("tbody",null,[(m(!0),w(D,null,L(N(),(r,i)=>(m(),M(ze,{key:i,row:r},null,8,["row"]))),128))])],2)],2)],2))}}));var Ve=se(Be,[["__file","description.vue"]]);const ee=["left","center","right"],Le=K({label:{type:String,default:""},span:{type:Number,default:1},rowspan:{type:Number,default:1},width:{type:[String,Number],default:""},minWidth:{type:[String,Number],default:""},labelWidth:{type:[String,Number],default:""},align:{type:String,values:ee,default:"left"},labelAlign:{type:String,values:ee},className:{type:String,default:""},labelClassName:{type:String,default:""}}),re=I({name:le,props:Le}),Me=me(Ve,{DescriptionsItem:re}),V=fe(re),Ue={class:"relative p-5"},Oe={class:"mx-auto flex w-full max-w-[900px] flex-col gap-4"},qe={class:"bg-background border-border flex flex-col gap-6 rounded-lg border p-5 pb-6"},je={class:"bg-background border-border flex flex-col gap-6 rounded-lg border p-5 pb-6"},Ke={class:"text-base font-medium"},Ge={class:"flex items-start gap-2 text-sm"},Je={class:"w-20 shrink-0"},Qe={class:"border-border w-full whitespace-pre-wrap rounded-lg border p-4"},Xe={class:"flex items-start gap-2 text-sm"},He={class:"w-20 shrink-0"},Ye={class:"mx-auto flex items-center"},dt=I({__name:"sysFeedbackDetail",setup(p){const e=[{value:1,label:d("sysFeedback.functionalFailure")},{value:2,label:d("sysFeedback.optimizationSuggestions")},{value:3,label:d("sysFeedback.accountIssue")},{value:4,label:d("sysFeedback.other")}],a={0:{label:d("sysFeedback.notViewed"),type:"warning"},1:{label:d("sysFeedback.viewed"),type:"primary"},2:{label:d("sysFeedback.processed"),type:"success"},3:{label:d("sysFeedback.closed/Invalid"),type:"info"}},S=ye(),o=Z(),c=Z(0),k=$e({markRead:!1,markResolved:!1});De(()=>U(null,null,function*(){if(S.params.id){const[,l]=yield X(H.get)("/api/v1/sysUserFeedback/detail",{params:{id:S.params.id}});l&&l.errorCode===0&&(o.value=l.data,c.value=l.data.status)}}));function N(l){const r=e.find(i=>i.value===l);return r==null?void 0:r.label}function s(l){return U(this,null,function*(){const r=l===1?"markRead":"markResolved";k[r]=!0;const[,i]=yield X(H.post)("/api/v1/sysUserFeedback/update",B(T({},o.value),{status:l}));i&&i.errorCode===0&&(c.value=l,_e.success(d("sysFeedback.markedSuccessfully"))),k[r]=!1})}return(l,r)=>{var i,x;return m(),w("div",Ue,[_(t(q),{class:"absolute left-5 top-5",icon:t(he),onClick:r[0]||(r[0]=n=>t(ve).back())},{default:F(()=>[C(v(t(d)("button.back")),1)]),_:1},8,["icon"]),u("div",Oe,[u("div",qe,[_(t(Me),{title:t(d)("sysFeedback.basicInformation")},{default:F(()=>[_(t(V),{label:t(d)("sysFeedback.category")},{default:F(()=>{var n;return[C(v(N((n=o.value)==null?void 0:n.feedbackType)),1)]}),_:1},8,["label"]),_(t(V),{label:t(d)("sysFeedback.processingStatus")},{default:F(()=>{var n,h;return[C(v(a[(h=(n=o.value)==null?void 0:n.status)!=null?h:0].label),1)]}),_:1},8,["label"]),_(t(V),{label:t(d)("sysFeedback.contactInformation")},{default:F(()=>{var n;return[C(v((n=o.value)==null?void 0:n.contactInfo),1)]}),_:1},8,["label"]),_(t(V),{label:t(d)("sysFeedback.submittedAt")},{default:F(()=>{var n;return[C(v((n=o.value)==null?void 0:n.created),1)]}),_:1},8,["label"])]),_:1},8,["title"])]),u("div",je,[u("h1",Ke,v(t(d)("sysFeedback.feedbackContent")),1),u("div",Ge,[u("span",Je,v(t(d)("sysFeedback.description"))+"： ",1),u("div",Qe,v((i=o.value)==null?void 0:i.feedbackContent),1)]),u("div",Xe,[u("span",He,v(t(d)("sysFeedback.attachments"))+"： ",1),_(t(we),{target:"_blank",href:(x=o.value)==null?void 0:x.attachmentUrl},{default:F(()=>{var n;return[C(v((n=o.value)==null?void 0:n.attachmentUrl),1)]}),_:1},8,["href"])])]),u("div",Ye,[_(t(q),{type:"primary",icon:t(ge),loading:k.markRead,disabled:c.value>=1,onClick:r[1]||(r[1]=n=>s(1))},{default:F(()=>[C(v(t(d)("button.markAsRead")),1)]),_:1},8,["icon","loading","disabled"]),_(t(q),{type:"primary",loading:k.markResolved,disabled:c.value>=2,onClick:r[2]||(r[2]=n=>s(2))},{icon:F(()=>[_(t(ke),{icon:"svg:resolved"})]),default:F(()=>[C(" "+v(t(d)("button.markAsResolved")),1)]),_:1},8,["loading","disabled"])])])])}}});export{dt as default};
