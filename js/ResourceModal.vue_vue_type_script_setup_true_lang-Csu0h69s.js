import{$ as l,M as k,R as C}from"./bootstrap-Bf65uz2I.js";import"./css-gf8D6QlL.js";import{E as D}from"./el-dialog-CAR1-R4U.js";import"./el-overlay-Zuw8glOl.js";/* empty css                */import{E as S,a as m}from"./el-form-item-8FQp7Cs4.js";import"./css-C9o_OfXA.js";import{D as f}from"./DictSelect-DdOvS-6R.js";import{_ as B}from"./Upload.vue_vue_type_script_setup_true_lang-ClW8ereK.js";import{ElInput as F}from"./index-BjDsryRX.js";import{ElButton as y}from"./index-oBOAcXl-.js";import{k as M,o as z,r as i,B as $,n as L,E as t,J as s,u as r,L as V,y as q,R as w}from"../jse/index-index-D3Xb8oT_.js";const h=M({__name:"ResourceModal",emits:["reload"],setup(A,{expose:U,emit:_}){const T=_;z(()=>{}),U({openDialog:E});const p=i(),n=i(!1),c=i(!0),a=i({deptId:"",resourceType:"",resourceName:"",suffix:"",resourceUrl:"",origin:"",status:"",options:"",fileSize:""}),d=i(!1),x=i({deptId:[{required:!0,message:l("message.required"),trigger:"blur"}],resourceType:[{required:!0,message:l("message.required"),trigger:"blur"}],resourceName:[{required:!0,message:l("message.required"),trigger:"blur"}],suffix:[{required:!0,message:l("message.required"),trigger:"blur"}],resourceUrl:[{required:!0,message:l("message.required"),trigger:"blur"}],origin:[{required:!0,message:l("message.required"),trigger:"blur"}],status:[{required:!0,message:l("message.required"),trigger:"blur"}]});function E(e){e.id&&(c.value=!1),a.value=e,n.value=!0}function N(){var e;(e=p.value)==null||e.validate(u=>{u&&(d.value=!0,k.post(c.value?"api/v1/resource/save":"api/v1/resource/update",a.value).then(o=>{d.value=!1,o.errorCode===0&&(C.success(o.message),T("reload"),g())}).catch(()=>{d.value=!1}))})}function g(){var e;(e=p.value)==null||e.resetFields(),c.value=!0,a.value={},n.value=!1}function R(e){var v,b;const u=(v=e==null?void 0:e.name)==null?void 0:v.split(".")[0],o=(b=e==null?void 0:e.name)==null?void 0:b.split(".")[1];a.value.resourceType=w(o),a.value.resourceName=u,a.value.suffix=o,a.value.fileSize=e.size,a.value.origin=0}function I(e){a.value.resourceUrl=e}return(e,u)=>(L(),$(r(D),{modelValue:n.value,"onUpdate:modelValue":u[4]||(u[4]=o=>n.value=o),draggable:"",title:c.value?r(l)("button.add"):r(l)("button.edit"),"before-close":g,"close-on-click-modal":!1},{footer:t(()=>[s(r(y),{onClick:g},{default:t(()=>[V(q(r(l)("button.cancel")),1)]),_:1}),s(r(y),{type:"primary",onClick:N,loading:d.value,disabled:d.value},{default:t(()=>[V(q(r(l)("button.save")),1)]),_:1},8,["loading","disabled"])]),default:t(()=>[s(r(S),{"label-width":"120px",ref_key:"saveForm",ref:p,model:a.value,"status-icon":"",rules:x.value},{default:t(()=>[s(r(m),{prop:"resourceUrl",label:r(l)("aiResource.resourceUrl")},{default:t(()=>[s(B,{onBeforeUpload:R,onSuccess:I})]),_:1},8,["label"]),s(r(m),{prop:"origin",label:r(l)("aiResource.origin")},{default:t(()=>[s(f,{modelValue:a.value.origin,"onUpdate:modelValue":u[0]||(u[0]=o=>a.value.origin=o),"dict-code":"resourceOriginType"},null,8,["modelValue"])]),_:1},8,["label"]),s(r(m),{prop:"resourceType",label:r(l)("aiResource.resourceType")},{default:t(()=>[s(f,{modelValue:a.value.resourceType,"onUpdate:modelValue":u[1]||(u[1]=o=>a.value.resourceType=o),"dict-code":"resourceType"},null,8,["modelValue"])]),_:1},8,["label"]),s(r(m),{prop:"resourceName",label:r(l)("aiResource.resourceName")},{default:t(()=>[s(r(F),{modelValue:a.value.resourceName,"onUpdate:modelValue":u[2]||(u[2]=o=>a.value.resourceName=o),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1},8,["label"]),s(r(m),{prop:"categoryId",label:r(l)("aiResource.categoryId")},{default:t(()=>[s(f,{modelValue:a.value.categoryId,"onUpdate:modelValue":u[3]||(u[3]=o=>a.value.categoryId=o),"dict-code":"aiResourceCategory"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"]))}});export{h as _};
