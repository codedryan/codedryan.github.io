var $=(D,V,g)=>new Promise((_,m)=>{var b=s=>{try{T(g.next(s))}catch(M){m(M)}},B=s=>{try{T(g.throw(s))}catch(M){m(M)}},T=s=>s.done?_(s.value):Promise.resolve(s.value).then(b,B);T((g=g.apply(D,V)).next())});import{$ as o,V as y,bW as Q,bX as Y,bD as Z,ax as ee,bt as te,M as k,_ as ae}from"./bootstrap-Bf65uz2I.js";import{E as oe,a as le}from"./el-collapse-item-DRoc9NR8.js";import{E as re}from"./el-dialog-CAR1-R4U.js";import"./el-overlay-Zuw8glOl.js";/* empty css                */import{E as ie,a as se}from"./el-form-item-8FQp7Cs4.js";import"./css-C9o_OfXA.js";import{E as F}from"./el-message-box-B8o3mhYx.js";import"./css-gf8D6QlL.js";import{a as ne,E as de}from"./el-tabs-BUyJm6xP.js";/* empty css                   *//* empty css                  */import{M as me}from"./ModelViewItemOperation-CyWEsQLr.js";import{ElInput as ce}from"./index-BjDsryRX.js";import{E as U}from"./index-CMBjNRIa.js";import{k as pe,r as d,G as R,B as C,n as u,E as r,q as h,J as l,u as t,m as N,F as z,N as G,p as ue,y as ve,A as fe}from"../jse/index-index-D3Xb8oT_.js";import"./event-BB_Ol6Sd.js";import"./castArray-BBset58W.js";import"./index-DF0dk4ce.js";import"./index-Bxb6QITi.js";import"./index-B3qAv2kq.js";import"./aria-DEUWDJ1E.js";import"./refs-D6FW0B1r.js";import"./index-Dg3fRnQE.js";import"./vnode-DysYOGZN.js";import"./scroll-C2492Iw_.js";import"./use-form-common-props-IzjzSHax.js";import"./_baseClone-trfKWgGN.js";import"./index-oBOAcXl-.js";import"./use-form-item-DVWmmqeW.js";import"./validator-D2YZey62.js";import"./use-wheel-C9oFsIdW.js";import"./raf-BVBe43_O.js";import"./strings-CGsg9AfI.js";import"./clamp-CeuJyDnc.js";import"./toNumber-CvayJyp9.js";import"./index-DSAOTmKA.js";import"./omit-CbyqVLxv.js";import"./_baseSlice-DZe_dRSe.js";import"./index-bT9OJj6t.js";import"./_overRest-Bb9G3v08.js";import"./el-image-viewer-DlaFkWIK.js";import"./debounce-AsHllEOy.js";import"./index-C33Sf0pH.js";/* empty css               */import"./providerList-IOY-GpS5.js";import"./model-ability-utils-DYGAejac.js";import"./index-DGdiZ7pE.js";import"./index-m1ZP1zbM.js";const he={class:"manage-llm-container"},ge={class:"form-container"},_e={class:"search-container"},be={class:"llm-table-container"},Me={key:0,class:"collapse-loading"},ke={key:1},Te={class:"flex items-center justify-between pr-2"},xe=pe({__name:"ManageModelModal",emits:["reload"],setup(D,{expose:V,emit:g}){const _=g,m=d([]),b=d(!1),B=[{label:o("llmProvider.chatModel"),name:"chatModel"}],T=[{label:o("llmProvider.embeddingModel"),name:"embeddingModel"}],s=[{label:o("llmProvider.rerankModel"),name:"rerankModel"}],M=d(),c=d(),j=a=>{k.get(`/api/v1/modelProvider/detail?id=${a}`).then(e=>{e.errorCode===0&&(c.value=e.data)})},E=d([]),v=(a,e)=>{b.value=!0;const f=e===""?`/api/v1/model/selectLlmByProviderAndModelType?providerId=${a}&modelType=${e}&supportFree=true`:`/api/v1/model/selectLlmByProviderAndModelType?providerId=${a}&modelType=${e}&selectText=${L.searchText}`;k.get(f).then(i=>{if(i.errorCode===0){const p=i.data||{};E.value=Object.entries(p).map(([w,H])=>({groupName:w,llmList:H}))}b.value=!1})},P=d("");V({openDialog(a,e){var f;switch(e){case"chatModel":{m.value=[...B];break}case"embeddingModel":{m.value=[...T];break}case"rerankModel":{m.value=[...s];break}}P.value=a,(f=M.value)==null||f.resetFields(),E.value=[],n.value=m.value[0].name,j(a),v(a,e),x.value=!0},openEditDialog(a){x.value=!0,O.value=!1,A.icon=a.icon,A.providerName=a.providerName,A.provider=a.provider}});const O=d(!0),x=d(!1),A=R({icon:"",providerName:"",provider:"",apiKey:"",endPoint:"",chatPath:"",embedPath:""}),q=()=>{x.value=!1},J=()=>$(null,null,function*(){yield fe(),v(c.value.id,n.value)}),n=d("all"),K=a=>{F.confirm(o("message.deleteModelGroupAlert"),o("message.noticeTitle"),{confirmButtonText:o("message.ok"),cancelButtonText:o("message.cancel"),type:"warning"}).then(()=>{k.post("/api/v1/model/removeByEntity",{groupName:a,providerId:P.value}).then(e=>{e.errorCode===0&&(v(c.value.id,n.value),_("reload"))})})},S=a=>{F.confirm(o("message.deleteModelAlert"),o("message.noticeTitle"),{confirmButtonText:o("message.ok"),cancelButtonText:o("message.cancel"),type:"warning"}).then(()=>{k.post("/api/v1/model/removeLlmByIds",{id:a}).then(e=>{e.errorCode===0&&(v(c.value.id,n.value),_("reload"))})})},W=a=>{k.post("/api/v1/model/update",{id:a,withUsed:!0}).then(e=>{e.errorCode===0&&(v(c.value.id,n.value),_("reload"))})},L=R({searchText:""}),X=()=>{k.post("/api/v1/model/addAllLlm",{providerId:P.value,withUsed:!0}).then(a=>{a.errorCode===0&&(v(c.value.id,n.value),_("reload"))})},I=()=>{b.value||v(c.value.id,n.value)};return(a,e)=>{var f;return u(),C(t(re),{modelValue:x.value,"onUpdate:modelValue":e[2]||(e[2]=i=>x.value=i),draggable:"",title:`${(f=c.value)==null?void 0:f.providerName}${t(o)("llmProvider.model")}`,"before-close":q,"close-on-click-modal":!1,"align-center":"",width:"762"},{default:r(()=>[h("div",he,[h("div",ge,[l(t(ie),{ref_key:"formDataRef",ref:M,model:L,"status-icon":""},{default:r(()=>[l(t(se),{prop:"searchText"},{default:r(()=>[h("div",_e,[l(t(ce),{modelValue:L.searchText,"onUpdate:modelValue":e[0]||(e[0]=i=>L.searchText=i),modelModifiers:{trim:!0},onInput:I,placeholder:t(o)("llm.searchTextPlaceholder")},null,8,["modelValue","placeholder"]),l(t(U),{content:t(o)("llm.button.addAllLlm"),placement:"top",effect:"dark"},{default:r(()=>[l(t(y),{size:"20",onClick:X,class:"cursor-pointer"},{default:r(()=>[l(t(Q))]),_:1})]),_:1},8,["content"]),l(t(U),{content:t(o)("llm.button.RetrieveAgain"),placement:"top",effect:"dark"},{default:r(()=>[l(t(y),{size:"20",onClick:I,class:"cursor-pointer"},{default:r(()=>[l(t(Y))]),_:1})]),_:1},8,["content"])])]),_:1})]),_:1},8,["model"])]),h("div",be,[l(t(ne),{modelValue:n.value,"onUpdate:modelValue":e[1]||(e[1]=i=>n.value=i),onTabClick:J},{default:r(()=>[(u(!0),N(z,null,G(m.value,i=>(u(),C(t(de),{label:i.label,name:i.name,"default-active":"all",key:i.name},{default:r(()=>[b.value?(u(),N("div",Me,[l(t(y),{class:"is-loading",size:"24"},{default:r(()=>[l(t(Z))]),_:1})])):(u(),N("div",ke,[E.value.length>0?(u(),C(t(oe),{key:0,"expand-icon-position":"left"},{default:r(()=>[(u(!0),N(z,null,G(E.value,p=>(u(),C(t(le),{key:p.groupName,title:p.groupName,name:p.groupName},{title:r(()=>[h("div",Te,[h("span",null,ve(p.groupName),1),h("span",null,[l(t(y),{onClick:ee(w=>K(p.groupName),["stop"])},{default:r(()=>[l(t(te))]),_:1},8,["onClick"])])])]),default:r(()=>[l(me,{"need-hidden-setting-icon":!0,"llm-list":p.llmList,onDeleteLlm:S,onAddLlm:W,"is-management":!0},null,8,["llm-list"])]),_:2},1032,["title","name"]))),128))]),_:1})):ue("",!0)]))]),_:1},8,["label","name"]))),128))]),_:1},8,["modelValue"])])])]),_:1},8,["modelValue","title"])}}}),Mt=ae(xe,[["__scopeId","data-v-215e3c5e"]]);export{Mt as default};
