var U=Object.defineProperty,T=Object.defineProperties;var D=Object.getOwnPropertyDescriptors;var x=Object.getOwnPropertySymbols;var I=Object.prototype.hasOwnProperty,R=Object.prototype.propertyIsEnumerable;var k=Math.pow,y=(a,s,e)=>s in a?U(a,s,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[s]=e,E=(a,s)=>{for(var e in s||(s={}))I.call(s,e)&&y(a,e,s[e]);if(x)for(var e of x(s))R.call(s,e)&&y(a,e,s[e]);return a},$=(a,s)=>T(a,D(s));import{T as w,a1 as P,V,bR as L,$ as h}from"./bootstrap-Bf65uz2I.js";import"./css-gf8D6QlL.js";import"./css-BA5xAVBz.js";import{E as M,a as v}from"./el-table-JPhh2aff.js";import"./css-_QzOlLq8.js";/* empty css                   *//* empty css                  *//* empty css                     *//* empty css                        *//* empty css               */import{E as A,a as F}from"./index-e0qsk5Ci.js";import{k as N,r as z,B as b,n as S,E as u,J as i,q as m,u as o,y as B,z as q,m as G,L as K}from"../jse/index-index-D3Xb8oT_.js";import{ElButton as O}from"./index-oBOAcXl-.js";function W(a,s=2){if(Number.isNaN(a)||a<0||a===0)return"0 B";const e=["B","KB","MB","GB","TB"],r=Math.floor(Math.log(a)/Math.log(1024)),p=(a/k(1024,r)).toFixed(s);return`${Number.parseFloat(p).toString()} ${e[r]}`}const Z={VITE_GLOB_API_URL:"http://pro.api.aiflowy.tech"},J={class:"flex flex-col gap-1"},j={class:"text-base"},H={class:"text-sm text-[#75808d]"},Q=N({__name:"DragFileUpload",props:{action:{type:String,default:"/api/v1/commons/upload"},visible:{type:Boolean,default:!0}},emits:["success","onChange"],setup(a,{expose:s,emit:e}){const r=a,p=e,_=w(),C=z({"aiflowy-token":_.accessToken}),{apiURL:t}=P(Z,!0),c=z(),l=n=>{p("success",n.data.path)},g=(n,f)=>{p("onChange",n,f)};return s({triggerFileSelect:()=>{if(c.value){const n=c.value.$el.querySelector('input[type="file"]');n&&n.click()}}}),(n,f)=>(S(),b(o(A),{ref_key:"uploadRef",ref:c,class:"upload-demo",drag:"",headers:C.value,action:`${o(t)}${r.action}`,"on-success":l,"on-change":g,multiple:"",style:q({display:r.visible?"block":"none"})},{default:u(()=>[i(o(V),{size:"48",color:"hsl(var(--primary))"},{default:u(()=>[i(o(L))]),_:1}),m("div",J,[m("span",j,B(n.$t("message.upload.title")),1),m("span",H,B(n.$t("message.upload.description")),1)])]),_:1},8,["headers","action","style"]))}}),de=N({__name:"ImportKnowledgeFileContainer",setup(a,{expose:s}){const e=z([]),r=z([]);s({getFilesData(){return e.value}});function p(t){r.value=t.data}function _(t){var l,g;e.value.find(d=>d.uid===t.uid)?e.value=e.value.map(d=>{var n,f;return d.uid===t.uid?$(E({},d),{fileSize:t.size,progressUpload:t.percentage,status:t.status,filePath:(f=(n=t==null?void 0:t.response)==null?void 0:n.data)==null?void 0:f.path}):d}):e.value.push({uid:t.uid,fileName:t.name,progressUpload:t.percentage,fileSize:t.size,status:t.status,filePath:(g=(l=t==null?void 0:t.response)==null?void 0:l.data)==null?void 0:g.path})}function C(t){e.value=e.value.filter(c=>c.uid!==t.uid)}return(t,c)=>(S(),G("div",null,[m("div",null,[i(Q,{onSuccess:p,onOnChange:_})]),m("div",null,[i(o(M),{data:e.value,style:{width:"100%"},size:"large"},{default:u(()=>[i(o(v),{prop:"fileName",label:o(h)("documentCollection.importDoc.fileName"),width:"250"},null,8,["label"]),i(o(v),{prop:"progressUpload",label:o(h)("documentCollection.importDoc.progressUpload"),width:"180"},{default:u(({row:l})=>[l.status==="success"?(S(),b(o(F),{key:0,percentage:l.progressUpload,status:"success"},null,8,["percentage"])):(S(),b(o(F),{key:1,percentage:l.progressUpload},null,8,["percentage"]))]),_:1},8,["label"]),i(o(v),{prop:"fileSize",label:o(h)("documentCollection.importDoc.fileSize")},{default:u(({row:l})=>[m("span",null,B(o(W)(l.fileSize)),1)]),_:1},8,["label"]),i(o(v),{label:o(h)("common.handle")},{default:u(({row:l})=>[i(o(O),{type:"danger",size:"small",onClick:g=>C(l)},{default:u(()=>[K(B(o(h)("button.delete")),1)]),_:1},8,["onClick"])]),_:1},8,["label"])]),_:1},8,["data"])])]))}});export{de as _};
