var te=Object.defineProperty,ae=Object.defineProperties;var le=Object.getOwnPropertyDescriptors;var z=Object.getOwnPropertySymbols;var re=Object.prototype.hasOwnProperty,ie=Object.prototype.propertyIsEnumerable;var D=(k,y,v)=>y in k?te(k,y,{enumerable:!0,configurable:!0,writable:!0,value:v}):k[y]=v,g=(k,y)=>{for(var v in y||(y={}))re.call(y,v)&&D(k,v,y[v]);if(z)for(var v of z(y))ie.call(y,v)&&D(k,v,y[v]);return k},E=(k,y)=>ae(k,le(y));import{$ as u,Z as Q,Y as ne,R as oe,_ as de}from"./bootstrap-Bf65uz2I.js";import"./css-gf8D6QlL.js";import"./css-C9o_OfXA.js";/* empty css                  *//* empty css               *//* empty css                     *//* empty css                  */import"./css-DCrZaNHy.js";import{E as se,a as A}from"./el-table-JPhh2aff.js";import"./css-_QzOlLq8.js";/* empty css                   *//* empty css                        */import{ElInput as U}from"./index-BjDsryRX.js";import{E as R,a as S}from"./index-DcZY4wgD.js";import{ElSwitch as L}from"./index-CHf9SThW.js";import{ElButton as $}from"./index-oBOAcXl-.js";import{k as ue,r as q,w as me,m as s,n,J as m,p as V,u as l,E as c,B as C,q as B,z as H,y as b,s as M,L as x,F as pe,N as ce}from"../jse/index-index-D3Xb8oT_.js";import"./index-CbSmxnRE.js";import"./util-B2mB0_6C.js";import"./index-bT9OJj6t.js";import"./_overRest-Bb9G3v08.js";import"./index-CMBjNRIa.js";import"./index-B3qAv2kq.js";import"./aria-DEUWDJ1E.js";import"./index-Bxb6QITi.js";import"./use-form-common-props-IzjzSHax.js";import"./merge-BysAs727.js";import"./_baseClone-trfKWgGN.js";import"./isArrayLikeObject-j3RaJGb0.js";import"./_baseSlice-DZe_dRSe.js";import"./_baseIteratee-rJjBrWyx.js";import"./castArray-BBset58W.js";import"./debounce-AsHllEOy.js";import"./toNumber-CvayJyp9.js";import"./index-p7kg-xKH.js";import"./event-BB_Ol6Sd.js";import"./use-form-item-DVWmmqeW.js";import"./index-Dg3fRnQE.js";import"./omit-CbyqVLxv.js";import"./index-pv0R11Cf.js";import"./raf-BVBe43_O.js";import"./index-C33Sf0pH.js";import"./index-m1ZP1zbM.js";import"./index-DGdiZ7pE.js";import"./useProps-DNCnrLfW.js";import"./_baseFindIndex-D7XfJLKM.js";import"./strings-CGsg9AfI.js";import"./scroll-C2492Iw_.js";import"./clamp-CeuJyDnc.js";import"./vnode-DysYOGZN.js";import"./validator-D2YZey62.js";const ye={class:"tree-table-container"},he={class:"header-with-asterisk"},fe={class:"name-cell"},be={key:1},ve={class:"name-input-wrapper"},ke={key:0,class:"error-message"},_e={class:"header-with-asterisk"},ge={class:"description-cell"},Ve={key:0},Ee={key:1},Be={key:0,class:"error-message"},Ie={key:0},Ae={key:1},Ce={key:0,class:"error-message"},Ne={key:0},Oe={key:1},Se={key:2},xe={key:0,class:"error-message"},Ue={key:0},$e={key:1},qe={class:"action-buttons"},je={key:0,class:"add-button-container"},Pe=ue({__name:"PluginInputAndOutParams",props:{modelValue:{default:()=>[]},editable:{type:Boolean,default:!1},isEditOutput:{type:Boolean,default:!1}},emits:["update:modelValue","submit"],setup(k,{expose:y,emit:v}){const o=k,j=v,p=q([]),I=q(["1"]),h=q({});me(()=>o.modelValue,i=>{i&&(p.value=i)},{immediate:!0,deep:!0});const P=i=>{const t=String(i.key).split("-").length-1;return t>0?t*20:0},J=i=>i.name==="arrayItem"?[{label:"Array[String]",value:"Array[String]"},{label:"Array[Number]",value:"Array[Number]"},{label:"Array[Boolean]",value:"Array[Boolean]"},{label:"Array[Object]",value:"Array[Object]"}]:[{label:"String",value:"String"},{label:"Boolean",value:"Boolean"},{label:"Number",value:"Number"},{label:"Object",value:"Object"},{label:"Array",value:"Array"},{label:"File",value:"File"}],_=()=>{j("update:modelValue",p.value)},T=(i,t)=>{const e=a=>a.map(r=>r.key===i.key?["Array[Boolean]","Array[Integer]","Array[Number]","Array[Object]","Array[String]","Boolean","Number","String"].includes(t)?E(g({},r),{type:t,children:void 0}):E(g({},r),{type:t,children:r.children||[]}):r.children?E(g({},r),{children:e(r.children)}):r);if(p.value=e(p.value),_(),t==="Object"||t==="Array"||t==="Array[Object]"){const a=E(g({key:`${i.key}-${Date.now()}`,name:t==="Array"?"arrayItem":"",description:"",enabled:!0},o.isEditOutput?{}:{method:"Query",defaultValue:"",required:!1}),{type:t==="Array"?"Array[String]":"String"}),r=d=>d.map(f=>f.key===i.key?E(g({},f),{children:[a]}):f.children?E(g({},f),{children:r(f.children)}):f);p.value=r(p.value),_(),I.value.includes(i.key)||(I.value=[...I.value,i.key])}},W=(i,t)=>{I.value=t.map(e=>e.key)},Y=()=>{if(!o.editable)return;const i=`${Date.now()}`,t=g({key:i,name:"",description:"",enabled:!0,type:"String"},o.isEditOutput?{}:{method:"Query",defaultValue:"",required:!1});p.value=[...p.value,t],_()},Z=i=>{if(!o.editable||!i)return;const t=g({key:`${i}-${Date.now()}`,name:"",description:"",required:!1,enabled:!0,type:"String"},o.isEditOutput?{}:{method:"Query",defaultValue:""}),e=a=>a.map(r=>r.key===i?E(g({},r),{children:[...r.children||[],t]}):r.children?E(g({},r),{children:e(r.children)}):r);p.value=e(p.value),_(),I.value.includes(i)||(I.value=[...I.value,i])},G=i=>{if(!o.editable)return;const t=e=>e.filter(a=>a.key===i?!1:(a.children&&(a.children=t(a.children)),!0));p.value=t(p.value),_()},X=()=>{const i={};let t=!0;const e=a=>{const{name:r,description:d,method:f,type:w}=a,N={};let O=!0;return r!=null&&r.trim()||(N.name=u("message.cannotBeEmpty.name"),O=!1,t=!1),d!=null&&d.trim()||(N.description=u("message.cannotBeEmpty.description"),O=!1,t=!1),K(a)&&!f&&!o.isEditOutput&&(N.method=u("message.cannotBeEmpty.method"),O=!1,t=!1),w||(N.type=u("message.cannotBeEmpty.type"),O=!1,t=!1),Object.keys(N).length>0&&(i[a.key]=N),a.children&&a.children.forEach(ee=>{e(ee)||(O=!1,t=!1)}),O};return p.value.forEach(a=>{e(a)}),h.value=i,t},K=i=>!i.key.includes("-");y({handleSubmitParams:()=>{if(!X()){oe.error(u("message.cannotBeEmpty.all"));const t=document.querySelector(".error-border");if(t)if(t.scrollIntoView({behavior:"smooth",block:"center"}),t.focus)t.focus();else{const e=t.querySelector(".el-input__inner");e&&e.focus()}throw new Error(u("message.cannotBeEmpty.error"))}j("submit",p.value)}});const F=(i,t)=>{h.value&&i&&t&&h.value[i.key]&&delete h.value[i.key][t]};return(i,t)=>(n(),s("div",ye,[m(l(se),{data:p.value,"row-key":"key",border:!0,size:"default","expand-row-keys":I.value,onExpandChange:W,style:{width:"100%","overflow-x":"auto"}},{default:c(()=>[m(l(A),{prop:"name","class-name":"first-column"},{header:c(()=>[B("div",he,[x(b(l(u)("pluginItem.parameterName"))+" ",1),t[0]||(t[0]=B("span",{class:"required-asterisk"},"*",-1))])]),default:c(({row:e})=>{var a,r,d;return[B("div",fe,[o.editable?(n(),s("div",be,[B("div",ve,[B("div",{style:H({width:`${P(e)}px`})},null,4),m(l(U),{modelValue:e.name,"onUpdate:modelValue":f=>e.name=f,disabled:e.name==="arrayItem",onInput:_,onBlur:f=>F(e,"name"),class:M({"error-border":(a=h.value[e.key])==null?void 0:a.name})},null,8,["modelValue","onUpdate:modelValue","disabled","onBlur","class"]),(r=h.value[e.key])!=null&&r.name?(n(),s("div",ke,b((d=h.value[e.key])==null?void 0:d.name),1)):V("",!0)])])):(n(),s("div",{key:0,style:H({paddingLeft:`${P(e)}px`})},b(e.name||""),5))])]}),_:1}),m(l(A),{prop:"description"},{header:c(()=>[B("div",_e,[x(b(l(u)("pluginItem.parameterDescription"))+" ",1),t[1]||(t[1]=B("span",{class:"required-asterisk"},"*",-1))])]),default:c(({row:e})=>{var a,r,d;return[B("div",ge,[o.editable?(n(),s("div",Ee,[m(l(U),{modelValue:e.description,"onUpdate:modelValue":f=>e.description=f,onInput:_,onBlur:f=>F(e,"description"),class:M({"error-border":(a=h.value[e.key])==null?void 0:a.description})},null,8,["modelValue","onUpdate:modelValue","onBlur","class"]),(r=h.value[e.key])!=null&&r.description?(n(),s("div",Be,b((d=h.value[e.key])==null?void 0:d.description),1)):V("",!0)])):(n(),s("span",Ve,b(e.description||""),1))])]}),_:1}),m(l(A),{prop:"type",label:l(u)("pluginItem.parameterType"),width:"150px"},{default:c(({row:e})=>{var a,r;return[o.editable?(n(),s("div",Ae,[m(l(R),{modelValue:e.type,"onUpdate:modelValue":d=>e.type=d,onChange:d=>T(e,d)},{default:c(()=>[(n(!0),s(pe,null,ce(J(e),d=>(n(),C(l(S),{key:d.value,label:d.label,value:d.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"]),(a=h.value[e.key])!=null&&a.type?(n(),s("div",Ce,b((r=h.value[e.key])==null?void 0:r.type),1)):V("",!0)])):(n(),s("span",Ie,b(e.type||""),1))]}),_:1},8,["label"]),o.isEditOutput?V("",!0):(n(),C(l(A),{key:0,prop:"method",label:l(u)("pluginItem.inputMethod"),width:"120px"},{default:c(({row:e})=>{var a,r;return[e.name==="arrayItem"?(n(),s("span",Ne)):o.editable?(n(),s("div",Se,[m(l(R),{modelValue:e.method,"onUpdate:modelValue":d=>e.method=d,onChange:_},{default:c(()=>[m(l(S),{label:"Query",value:"Query"}),m(l(S),{label:"Body",value:"Body"}),m(l(S),{label:"Path",value:"Path"}),m(l(S),{label:"Header",value:"Header"})]),_:1},8,["modelValue","onUpdate:modelValue"]),(a=h.value[e.key])!=null&&a.method?(n(),s("div",xe,b((r=h.value[e.key])==null?void 0:r.method),1)):V("",!0)])):(n(),s("span",Oe,b(e.method||""),1))]}),_:1},8,["label"])),o.isEditOutput?V("",!0):(n(),C(l(A),{key:1,prop:"required",label:l(u)("pluginItem.required"),width:"120px"},{default:c(({row:e})=>[m(l(L),{modelValue:e.required,"onUpdate:modelValue":a=>e.required=a,onChange:_,disabled:!o.editable},null,8,["modelValue","onUpdate:modelValue","disabled"])]),_:1},8,["label"])),o.isEditOutput?V("",!0):(n(),C(l(A),{key:2,prop:"defaultValue",label:l(u)("pluginItem.defaultValue"),width:"150px"},{default:c(({row:e})=>[e.type==="Object"?(n(),s("span",Ue)):o.editable?(n(),C(l(U),{key:2,modelValue:e.defaultValue,"onUpdate:modelValue":a=>e.defaultValue=a,onInput:_,disabled:!o.editable},null,8,["modelValue","onUpdate:modelValue","disabled"])):(n(),s("span",$e,b(e.defaultValue||""),1))]),_:1},8,["label"])),m(l(A),{prop:"enabled",label:l(u)("pluginItem.enabledStatus"),width:"120px"},{default:c(({row:e})=>[m(l(L),{modelValue:e.enabled,"onUpdate:modelValue":a=>e.enabled=a,onChange:_,disabled:!o.editable},null,8,["modelValue","onUpdate:modelValue","disabled"])]),_:1},8,["label"]),o.editable?(n(),C(l(A),{key:3,label:l(u)("common.handle"),width:"130px"},{default:c(({row:e})=>[B("div",qe,[e.type==="Object"||e.type==="Array[Object]"?(n(),C(l($),{key:0,type:"primary",link:"",icon:l(Q),onClick:a=>Z(e.key),title:l(u)("pluginItem.addChildNode")},null,8,["icon","onClick","title"])):V("",!0),m(l($),{type:"danger",link:"",icon:l(ne),onClick:a=>G(e.key)},{default:c(()=>[x(b(l(u)("button.delete")),1)]),_:1},8,["icon","onClick"])])]),_:1},8,["label"])):V("",!0)]),_:1},8,["data","expand-row-keys"]),o.editable?(n(),s("div",je,[m(l($),{type:"default",onClick:Y,icon:l(Q)},{default:c(()=>[x(b(l(u)("pluginItem.addParameter")),1)]),_:1},8,["icon"])])):V("",!0)]))}}),Pt=de(Pe,[["__scopeId","data-v-90eed689"]]);export{Pt as default};
