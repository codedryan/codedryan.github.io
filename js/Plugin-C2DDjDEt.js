var P=(c,p,l)=>new Promise((r,L)=>{var x=a=>{try{y(l.next(a))}catch(m){L(m)}},C=a=>{try{y(l.throw(a))}catch(m){L(m)}},y=a=>a.done?r(a.value):Promise.resolve(a.value).then(x,C);y((l=l.apply(c,p)).next())});import{_ as b,a9 as F,$ as t,a8 as I,Y as N,M as _,R as k,Z as V}from"./bootstrap-Bf65uz2I.js";import"./css-gf8D6QlL.js";import{E as H}from"./el-dialog-CAR1-R4U.js";import"./el-overlay-Zuw8glOl.js";/* empty css                */import{E as J,a as K}from"./el-form-item-8FQp7Cs4.js";import"./css-C9o_OfXA.js";import{E as Y}from"./el-message-box-B8o3mhYx.js";import{H as j}from"./HeaderSearch-Dj9rqjlr.js";import{m as w,n as B,q as v,s as R,k as G,r as s,o as W,J as i,u as n,E as d,L as Z,y as D}from"../jse/index-index-D3Xb8oT_.js";import{C as X}from"./CardList-DOl2PmFc.js";import{_ as e6}from"./PageData.vue_vue_type_script_setup_true_lang-DfbAOXk_.js";import{P as t6}from"./PageSide-wLZhy9Oh.js";import o6 from"./AddPluginModal-BW3w9qsM.js";import{_ as a6}from"./CategoryPluginModal.vue_vue_type_script_setup_true_lang-CilhiHhi.js";import{ElInput as i6}from"./index-BjDsryRX.js";import{ElButton as $}from"./index-oBOAcXl-.js";import"./index-B3qAv2kq.js";import"./aria-DEUWDJ1E.js";import"./refs-D6FW0B1r.js";import"./event-BB_Ol6Sd.js";import"./index-Bxb6QITi.js";import"./index-Dg3fRnQE.js";import"./vnode-DysYOGZN.js";import"./scroll-C2492Iw_.js";import"./use-form-common-props-IzjzSHax.js";import"./castArray-BBset58W.js";import"./_baseClone-trfKWgGN.js";import"./validator-D2YZey62.js";import"./el-dropdown-menu-v2KdT220.js";import"./index-CMBjNRIa.js";import"./index-bT9OJj6t.js";import"./_overRest-Bb9G3v08.js";import"./index-CbSmxnRE.js";import"./util-B2mB0_6C.js";/* empty css                  *//* empty css                     */import"./hasPermission-CIdLHqw4.js";import"./el-avatar-BVPcm0Px.js";import"./el-card-DGd_zL6P.js";import"./css-CLrSDUNG.js";/* empty css                */import"./index-Bpv3aWiu.js";import"./index-Ce9mjW49.js";import"./el-empty-CDAlv280.js";import"./el-pagination-W2lJTIgw.js";import"./index-DcZY4wgD.js";import"./index-DGdiZ7pE.js";import"./useProps-DNCnrLfW.js";import"./_baseFindIndex-D7XfJLKM.js";import"./_baseIteratee-rJjBrWyx.js";import"./strings-CGsg9AfI.js";import"./use-form-item-DVWmmqeW.js";import"./index-m1ZP1zbM.js";import"./clamp-CeuJyDnc.js";import"./toNumber-CvayJyp9.js";import"./index-pv0R11Cf.js";/* empty css               *//* empty css                  */import"./css-BBEQ4fog.js";import"./css-Co2xKw2s.js";import"./UploadAvatar-a3x1lqjM.js";import"./el-image-viewer-DlaFkWIK.js";import"./debounce-AsHllEOy.js";import"./index-C33Sf0pH.js";import"./css-BA5xAVBz.js";import"./index-e0qsk5Ci.js";import"./cloneDeep-Orislllf.js";import"./index-C5wmh2tf.js";import"./omit-CbyqVLxv.js";import"./_baseSlice-DZe_dRSe.js";const n6="/png/defaultPluginIcon-vpAC4VvO.png",r6={__name:"CategorizeIcon",props:{className:{type:String,default:""}},setup(c){const p=c;return(l,r)=>(B(),w("svg",{class:R(p.className),width:"13.6333333px",height:"13.6333333px",viewBox:"0 0 13.6333333 13.6333333",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},[...r[0]||(r[0]=[v("path",{d:"M7.66166667,10.1666667 C7.66166667,11.55014 8.78319337,12.6716667 10.1666667,12.6716667 C11.55014,12.6716667 12.6716667,11.55014 12.6716667,10.1666667 C12.6716667,8.78319337 11.55014,7.66166667 10.1666667,7.66166667 L8.04,7.66166667 C7.82966667,7.66166667 7.662,7.82966667 7.662,8.03966667 L7.662,10.1666667 L7.66166667,10.1666667 Z M10.1666667,6.99999866 C11.9155684,6.99999866 13.3333333,8.41776496 13.3333333,10.1666667 C13.3333333,11.9155684 11.9155684,13.3333333 10.1666667,13.3333333 C8.41776496,13.3333333 6.99999807,11.9155684 6.99999807,10.1666667 L6.99999807,8.04 C6.99946799,7.76406988 7.10882245,7.49928316 7.3039036,7.30413947 C7.49898474,7.10899578 7.7637364,6.99955644 8.03966667,6.99999866 L10.1666667,6.99999866 L10.1666667,6.99999866 Z M6.33333469,10.1666667 C6.33333469,11.9155684 4.91556838,13.3333333 3.16666667,13.3333333 C1.41776496,13.3333333 0,11.9155684 0,10.1666667 C0,8.41776496 1.41776496,6.99999866 3.16666667,6.99999866 L5.29366667,6.99999866 C5.56953908,6.99955669 5.83424002,7.10895032 6.02931152,7.30402182 C6.22438303,7.49909332 6.33377666,7.76379426 6.33333469,8.03966667 L6.33333469,10.1666667 Z M3.16666667,7.66166667 C1.78319337,7.66166667 0.661666672,8.78319337 0.661666672,10.1666667 C0.661666672,11.55014 1.78319337,12.6716667 3.16666667,12.6716667 C4.55013997,12.6716667 5.67166667,11.55014 5.67166667,10.1666667 L5.67166667,8.04 C5.67166667,7.83 5.504,7.662 5.29366667,7.662 L3.16666667,7.662 L3.16666667,7.66166667 Z M6.99999866,3.16633334 C7.00018409,1.41747504 8.41803055,-0.000122713956 10.1668889,7.79661757e-09 C11.9157472,0.000122729549 13.3333333,1.41791945 13.3333333,3.16677777 C13.3333333,4.91563609 11.915525,6.33333528 10.1666667,6.33333528 L8.04,6.33333528 C7.76406988,6.33386536 7.49928316,6.22451089 7.30413947,6.02942974 C7.10899578,5.8343486 6.99955644,5.56959695 6.99999866,5.29366667 L6.99999866,3.16666667 L6.99999866,3.16633334 Z M10.1666667,5.67166667 C11.55014,5.67166667 12.6716667,4.55013997 12.6716667,3.16666667 C12.6716667,1.78319337 11.55014,0.661666672 10.1666667,0.661666672 C8.78319337,0.661666672 7.66166667,1.78319337 7.66166667,3.16666667 L7.66166667,5.29366667 C7.66166667,5.50366667 7.82933334,5.67166667 8.03966667,5.67166667 L10.1666667,5.67166667 L10.1666667,5.67166667 Z M5.67166667,3.16666667 C5.67166667,1.78319337 4.55013997,0.661666672 3.16666667,0.661666672 C1.78319337,0.661666672 0.661666672,1.78319337 0.661666672,3.16666667 C0.661666672,4.55013997 1.78319337,5.67166667 3.16666667,5.67166667 L5.29366667,5.67166667 C5.504,5.67166667 5.67166667,5.50366667 5.67166667,5.29366667 L5.67166667,3.16666667 Z M3.16666667,6.33333469 C1.41776496,6.33333469 0,4.91556838 0,3.16666667 C0,1.41776496 1.41776496,0 3.16666667,0 C4.91556838,0 6.33333469,1.41776496 6.33333469,3.16666667 L6.33333469,5.29366667 C6.33377666,5.56953908 6.22438303,5.83424002 6.02931152,6.02931152 C5.83424002,6.22438303 5.56953908,6.33377666 5.29366667,6.33333469 L3.16666667,6.33333469 Z",id:"形状"},null,-1)])],2))}},l6=b(r6,[["__scopeId","data-v-e6824932"]]),s6={__name:"PluginToolIcon",props:{className:{type:String,default:""}},setup(c){const p=c;return(l,r)=>(B(),w("svg",{width:"14",height:"14",viewBox:"0 0 14 14",xmlns:"http://www.w3.org/2000/svg",class:R(p.className)},[...r[0]||(r[0]=[v("path",{d:"M9.702 14L1.335 14C0.586 14 0 13.393 0 12.69L0 10.676C0 10.516 0.065 10.388 0.195 10.292C0.326 10.196 0.488 10.164 0.619 10.196C0.781 10.228 0.944 10.26 1.074 10.26C2.019 10.26 2.8 9.493 2.8 8.566C2.8 7.639 2.019 6.872 1.074 6.872C0.944 6.872 0.781 6.904 0.619 6.936C0.456 6.968 0.326 6.936 0.195 6.84C0.065 6.744 0 6.616 0 6.457L0 4.443C0 3.708 0.619 3.132 1.335 3.132L2.833 3.132C2.8 2.973 2.8 2.813 2.8 2.653C2.8 1.183 4.005 0 5.502 0C7 0 8.205 1.183 8.205 2.653C8.205 2.813 8.205 2.973 8.172 3.132L9.67 3.132C10.419 3.132 11.005 3.74 11.005 4.443L11.005 5.913L11.298 5.913C12.795 5.913 14 7.096 14 8.566C14 10.037 12.795 11.219 11.298 11.219L11.005 11.219L11.005 12.69C11.07 13.393 10.451 14 9.702 14ZM0.977 11.219L0.977 12.658C0.977 12.849 1.14 13.009 1.335 13.009L9.702 13.009C9.898 13.009 10.06 12.849 10.06 12.658L10.06 10.58C10.06 10.42 10.126 10.26 10.256 10.196C10.386 10.1 10.549 10.1 10.712 10.132C10.907 10.196 11.102 10.26 11.298 10.26C12.242 10.26 13.023 9.493 13.023 8.566C13.023 7.639 12.242 6.872 11.298 6.872C11.102 6.872 10.907 6.904 10.712 7C10.549 7.064 10.386 7.032 10.256 6.936C10.126 6.84 10.06 6.712 10.06 6.553L10.06 4.443C10.06 4.251 9.898 4.091 9.702 4.091L7.521 4.091C7.358 4.091 7.195 3.995 7.098 3.868C7 3.74 7 3.548 7.065 3.42C7.195 3.164 7.228 2.941 7.228 2.685C7.228 1.758 6.447 0.991 5.502 0.991C4.558 0.991 3.777 1.758 3.777 2.685C3.777 2.941 3.842 3.196 3.94 3.42C4.005 3.58 4.005 3.74 3.907 3.868C3.81 3.995 3.647 4.091 3.484 4.091L1.335 4.091C1.14 4.091 0.977 4.251 0.977 4.443L0.977 5.881C2.507 5.817 3.777 7.032 3.777 8.534C3.777 10.005 2.572 11.187 1.074 11.187C1.042 11.219 1.009 11.219 0.977 11.219Z",fill:"currentColor","fill-rule":"nonzero"},null,-1)])],2))}},p6=b(s6,[["__scopeId","data-v-4afa5d73"]]),m6={class:"knowledge-container"},u6={class:"knowledge-header"},d6={class:"plugin-content-container"},c6={class:"category-panel-container"},C6={class:"plugin-content-data-container h-full overflow-auto"},g6=G({__name:"Plugin",setup(c){const p=F(),l=[{icon:I,text:t("button.edit"),className:"",permission:"/api/v1/plugin/save",onClick(e){m.value.openDialog(e)}},{icon:p6,text:t("plugin.button.tools"),className:"",permission:"/api/v1/plugin/save",onClick(e){p.push({path:"/ai/plugin/tools",query:{id:e.id,pageKey:"/ai/plugin"}})}},{icon:l6,text:t("plugin.button.categorize"),className:"",permission:"/api/v1/plugin/save",onClick(e){E.value.openDialog(e)}},{icon:N,text:t("button.delete"),className:"item-danger",permission:"/api/v1/plugin/remove",onClick(e){y(e)}}],r=s([]),L=[{icon:I,label:t("button.edit"),onClick(e){u.value.name=e.name,u.value.id=e.id,h.value=!0,g.value=!0}},{type:"danger",icon:N,label:t("button.delete"),onClick(e){Q(e)}}],x={icon:V,label:t("button.add"),onClick(){g.value=!0,h.value=!1}},C=()=>P(null,null,function*(){return _.get("/api/v1/pluginCategory/list").then(e=>{e.errorCode===0&&(r.value=[{id:"0",name:t("common.allCategories")},...e.data])})});W(()=>{C()});const y=e=>{Y.confirm(t("message.deleteAlert"),t("message.noticeTitle"),{confirmButtonText:t("message.ok"),cancelButtonText:t("message.cancel"),type:"warning"}).then(()=>{_.post("/api/v1/plugin/plugin/remove",{id:e.id}).then(o=>{o.errorCode===0&&(k.success(t("message.deleteOkMessage")),a.value.setQuery({}))})}).catch(()=>{})},a=s(),m=s(),E=s(),S=[{key:"add",text:t("plugin.button.addPlugin"),icon:V,type:"primary",data:{action:"add"}}],z=s("0"),g=s(!1),h=s(!1),u=s({name:"",id:""}),O=()=>{h.value?q(u.value):A(u.value),g.value=!1},T=(e,o)=>{switch(e.key){case"add":{m.value.openDialog({});break}}},M=e=>{a.value.setQuery({title:e,isQueryOr:!0})},q=e=>{_.post("/api/v1/pluginCategory/update",{id:e.id,name:e.name}).then(o=>{o.errorCode===0&&(C(),k.success(t("message.updateOkMessage")))})},A=e=>{_.post("/api/v1/pluginCategory/save",{name:e.name}).then(o=>{o.errorCode===0&&(C(),k.success(t("message.saveOkMessage")))})},Q=e=>{_.get(`/api/v1/pluginCategory/doRemoveCategory?id=${e.id}`).then(o=>{o.errorCode===0&&(C(),k.success(t("message.deleteOkMessage")))})},U=e=>{a.value.setQuery({category:e.id})};return(e,o)=>(B(),w("div",m6,[v("div",u6,[i(j,{buttons:S,"search-placeholder":n(t)("plugin.searchUsers"),onSearch:M,onButtonClick:T},null,8,["search-placeholder"])]),v("div",d6,[v("div",c6,[i(t6,{"label-key":"name","value-key":"id",menus:r.value,"control-btns":L,"footer-button":x,"default-selected":"0",onChange:U},null,8,["menus"])]),v("div",C6,[i(e6,{ref_key:"pageDataRef",ref:a,"page-url":"/api/v1/plugin/pageByCategory","page-size":12,"page-sizes":[12,24,36,48],"extra-query-params":{category:z.value}},{default:d(({pageList:f})=>[i(X,{"title-key":"title","avatar-key":"icon","description-key":"description",data:f,actions:l,"default-icon":n(n6)},null,8,["data","default-icon"])]),_:1},8,["extra-query-params"])])]),i(o6,{ref_key:"aiPluginModalRef",ref:m,onReload:M},null,512),i(a6,{ref_key:"categoryCategoryModal",ref:E,onReload:M},null,512),i(n(H),{title:h.value?`${n(t)("button.edit")}`:`${n(t)("button.add")}`,modelValue:g.value,"onUpdate:modelValue":o[2]||(o[2]=f=>g.value=f),width:"500px","close-on-click-modal":!1},{footer:d(()=>[i(n($),{onClick:o[1]||(o[1]=f=>g.value=!1)},{default:d(()=>[Z(D(n(t)("button.cancel")),1)]),_:1}),i(n($),{type:"primary",onClick:O},{default:d(()=>[Z(D(n(t)("button.confirm")),1)]),_:1})]),default:d(()=>[i(n(J),{model:u.value,"status-icon":""},{default:d(()=>[i(n(K),null,{default:d(()=>[i(n(i6),{modelValue:u.value.name,"onUpdate:modelValue":o[0]||(o[0]=f=>u.value.name=f),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title","modelValue"])]))}}),D1=b(g6,[["__scopeId","data-v-2f30e167"]]);export{D1 as default};
