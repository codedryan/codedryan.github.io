var P=(e,v,d)=>new Promise((a,n)=>{var i=o=>{try{u(d.next(o))}catch(f){n(f)}},l=o=>{try{u(d.throw(o))}catch(f){n(f)}},u=o=>o.done?a(o.value):Promise.resolve(o.value).then(i,l);u((d=d.apply(e,v)).next())});import{V as I,aH as S,R as x,U as _,_ as A}from"./bootstrap-Bf65uz2I.js";import"./css-gf8D6QlL.js";import{E as H}from"./el-dialog-CAR1-R4U.js";import"./el-overlay-Zuw8glOl.js";import"./css-C9o_OfXA.js";import{ElButton as T}from"./index-oBOAcXl-.js";import{ElInput as b}from"./index-BjDsryRX.js";import{k as N,r as k,B as $,n as D,u as r,E as m,q as t,m as z,p as G,J as c,y as p,L as C,z as E}from"../jse/index-index-D3Xb8oT_.js";import"./index-B3qAv2kq.js";import"./aria-DEUWDJ1E.js";import"./refs-D6FW0B1r.js";import"./event-BB_Ol6Sd.js";import"./index-Bxb6QITi.js";import"./index-Dg3fRnQE.js";import"./vnode-DysYOGZN.js";import"./scroll-C2492Iw_.js";import"./use-form-item-DVWmmqeW.js";import"./use-form-common-props-IzjzSHax.js";import"./index-bT9OJj6t.js";import"./_overRest-Bb9G3v08.js";import"./index-C33Sf0pH.js";import"./index-m1ZP1zbM.js";const L={class:"dialog-content"},J={class:"summary-section"},M={class:"summary-column"},R={class:"summary-card highlight-wrapper"},U={class:"summary-card-inner"},W={class:"column-header"},q={class:"column-title"},O={class:"action-section"},j={key:0,class:"summary-column"},F={class:"summary-card original-card"},K={class:"column-header"},Q={class:"column-title"},X={class:"dialog-footer"},Y=N({__name:"AiContentGeneratorDialog",props:{modelValue:{type:Boolean,default:!1},content:{default:""},originalText:{default:""},originalTextLabel:{default:"原始内容"},modalTitle:{default:"AI智能生成内容"},title:{default:"AI生成内容"},confirmText:{default:"确认替换"},cancelText:{default:"取消"},generateText:{default:"智能生成"},generatingText:{default:"生成中..."},aiPlaceholder:{default:"AI生成的内容将显示在这里..."},originalPlaceholder:{default:"暂无内容"},defaultSysPromptTemplateContent:{default:""},promptTemplate:{default:"请根据以下内容生成符合要求的文本：{content}"},maxHeight:{default:400},dialogWidth:{default:"696px"}},emits:["update:modelValue","confirm","close","generate"],setup(e,{expose:v,emit:d}){const a=e,n=d,i=k(!1),l=k(""),u=()=>a.content.trim()?a.promptTemplate.includes("{content}")?a.defaultSysPromptTemplateContent+a.promptTemplate.replace("{content}",a.content):`${a.defaultSysPromptTemplateContent}${a.promptTemplate}${a.content}`:"",o=()=>P(null,null,function*(){if(!a.content.trim()){x.warning("请输入文本内容后再生成！");return}l.value="",i.value=!0;try{const g=u();yield new Promise(s=>setTimeout(s,1500));const h={prompt:g};_.post("/api/v1/common/chore/chat",h,{onMessage(s){var w;if(s.event==="done"){i.value=!1;return}if(!s.data)return;const B=(w=JSON.parse(s.data).payload)==null?void 0:w.delta;l.value+=B}}),n("generate",l.value)}catch(g){x.error("生成失败，请重试"),console.error("生成失败:",g),i.value=!1}}),f=()=>{if(!l.value.trim()){x.warning("暂无可用的AI生成内容！");return}n("confirm",l.value),y()},y=()=>{i.value=!1,n("update:modelValue",!1),n("close")},V=()=>{l.value=""};return v({generateSummary:o,clearGeneratedText:V,openDialog(){V(),n("update:modelValue",!0)}}),(g,h)=>(D(),$(r(H),{"model-value":e.modelValue,title:e.modalTitle,width:e.dialogWidth,"close-on-click-modal":!1,onClose:y,class:"ai-summary-dialog"},{footer:m(()=>[t("div",X,[c(r(T),{onClick:y},{default:m(()=>[C(p(e.cancelText),1)]),_:1}),c(r(T),{type:"primary",onClick:f,disabled:!l.value.trim()},{default:m(()=>[C(p(e.confirmText),1)]),_:1},8,["disabled"])])]),default:m(()=>[t("div",L,[t("div",J,[t("div",M,[t("div",R,[t("div",U,[t("div",W,[t("span",q,p(e.title),1),t("div",O,[c(r(T),{type:"primary",onClick:o,loading:i.value,disabled:!e.content.trim()},{default:m(()=>[c(r(I),{class:"btn-icon"},{default:m(()=>[c(r(S))]),_:1}),C(" "+p(i.value?e.generatingText:e.generateText),1)]),_:1},8,["loading","disabled"])])]),c(r(b),{modelValue:l.value,"onUpdate:modelValue":h[0]||(h[0]=s=>l.value=s),type:"textarea",rows:10,placeholder:e.aiPlaceholder,class:"summary-input",style:E({maxHeight:`${e.maxHeight}px`}),resize:"none"},null,8,["modelValue","placeholder","style"])])])]),e.originalText||e.originalPlaceholder?(D(),z("div",j,[t("div",F,[t("div",K,[t("span",Q,p(e.originalTextLabel),1)]),c(r(b),{value:e.originalText||e.originalPlaceholder,type:"textarea",rows:10,readonly:"",class:"summary-input original",style:E({maxHeight:`${e.maxHeight}px`}),resize:"none"},null,8,["value","style"])])])):G("",!0)])])]),_:1},8,["model-value","title","width"]))}}),Pe=A(Y,[["__scopeId","data-v-a0cc2b69"]]);export{Pe as default};
