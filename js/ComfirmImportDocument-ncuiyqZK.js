var L=Object.defineProperty,P=Object.defineProperties;var A=Object.getOwnPropertyDescriptors;var k=Object.getOwnPropertySymbols;var R=Object.prototype.hasOwnProperty,V=Object.prototype.propertyIsEnumerable;var C=(r,e,o)=>e in r?L(r,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):r[e]=o,h=(r,e)=>{for(var o in e||(e={}))R.call(e,o)&&C(r,o,e[o]);if(k)for(var o of k(e))V.call(e,o)&&C(r,o,e[o]);return r},S=(r,e)=>P(r,A(e));import{as as $,$ as n,M as b,_ as j}from"./bootstrap-Bf65uz2I.js";import{E as q,a as E}from"./el-table-JPhh2aff.js";import"./css-_QzOlLq8.js";/* empty css                   *//* empty css                  *//* empty css                     *//* empty css                        *//* empty css               */import{E as f}from"./index-DGdiZ7pE.js";import{k as x,r as w,w as z,m as J,n as d,J as D,u as t,E as c,B as v,L as y,y as _}from"../jse/index-index-D3Xb8oT_.js";import"./index-CbSmxnRE.js";import"./util-B2mB0_6C.js";import"./index-bT9OJj6t.js";import"./_overRest-Bb9G3v08.js";import"./index-CMBjNRIa.js";import"./index-B3qAv2kq.js";import"./aria-DEUWDJ1E.js";import"./index-Bxb6QITi.js";import"./use-form-common-props-IzjzSHax.js";import"./merge-BysAs727.js";import"./_baseClone-trfKWgGN.js";import"./isArrayLikeObject-j3RaJGb0.js";import"./_baseSlice-DZe_dRSe.js";import"./_baseIteratee-rJjBrWyx.js";import"./castArray-BBset58W.js";import"./debounce-AsHllEOy.js";import"./toNumber-CvayJyp9.js";import"./index-p7kg-xKH.js";import"./event-BB_Ol6Sd.js";import"./use-form-item-DVWmmqeW.js";import"./index-Dg3fRnQE.js";import"./omit-CbyqVLxv.js";import"./index-pv0R11Cf.js";import"./raf-BVBe43_O.js";const M={class:"import-doc-file-list"},O=x({__name:"ComfirmImportDocument",props:{filesList:{default:()=>[],type:Array},splitterParams:{default:()=>{},type:Object},manualDocumentsData:{default:()=>[],type:Array},segmentationStrategy:{default:"",type:String}},emits:["loadingFinish"],setup(r,{expose:e,emit:o}){const u=r,I=o,T=$(),U=w(T.query.id||""),a=w([]);z(()=>u.filesList,p=>{a.value=[...p].map(i=>S(h({},i),{progressUpload:i.progressUpload||"pending"}))},{immediate:!0});const N=()=>{if(a.value.length===0)return;let p=0;const i=a.value.length;a.value.forEach((l,s)=>{a.value[s].progressUpload="loading",B(l.filePath,"saveText",l.fileName,s,()=>{p++,p===i&&I("loadingFinish")})})},B=(p,i,l,s,m)=>{if(u.segmentationStrategy==="manualSegmentation"){const g=u.manualDocumentsData[s];if(!g){a.value[s].progressUpload="error",m();return}b.post("/api/v1/document/store/manual",{knowledgeId:U.value,manualDocumentsData:g}).then(F=>{a.value[s].progressUpload=F.errorCode===0?"success":"error",m()}).catch(()=>{a.value[s].progressUpload="error",m()})}else u.segmentationStrategy==="automaticSegmentation"?b.post("/api/v1/document/saveText",{},{params:h({filePath:p,operation:i,knowledgeId:U.value,fileOriginName:l},u.splitterParams)}).then(g=>{a.value[s].progressUpload=g.errorCode===0?"success":"error",m()}).catch(()=>{a.value[s].progressUpload="error",m()}):(a.value[s].progressUpload="error",m())};return e({handleSave:N}),(p,i)=>(d(),J("div",M,[D(t(q),{data:a.value,size:"large",style:{width:"100%"}},{default:c(()=>[D(t(E),{prop:"fileName",label:t(n)("documentCollection.importDoc.fileName"),width:"250"},null,8,["label"]),D(t(E),{prop:"progressUpload",label:t(n)("documentCollection.splitterDoc.uploadStatus")},{default:c(({row:l})=>[l.progressUpload==="success"?(d(),v(t(f),{key:0,type:"success"},{default:c(()=>[y(_(t(n)("documentCollection.splitterDoc.completed")),1)]),_:1})):l.progressUpload==="loading"?(d(),v(t(f),{key:1,type:"primary"},{default:c(()=>[y(_(t(n)("documentCollection.splitterDoc.uploading")),1)]),_:1})):l.progressUpload==="error"?(d(),v(t(f),{key:2,type:"danger"},{default:c(()=>[y(_(t(n)("documentCollection.splitterDoc.uploadFailed")),1)]),_:1})):(d(),v(t(f),{key:3,type:"info"},{default:c(()=>[y(_(t(n)("documentCollection.splitterDoc.pendingUpload")),1)]),_:1}))]),_:1},8,["label"])]),_:1},8,["data"])]))}}),we=j(O,[["__scopeId","data-v-e3bf71c8"]]);export{we as default};
