var oe=Object.defineProperty;var H=Object.getOwnPropertySymbols;var te=Object.prototype.hasOwnProperty,ae=Object.prototype.propertyIsEnumerable;var I=(n,l,a)=>l in n?oe(n,l,{enumerable:!0,configurable:!0,writable:!0,value:a}):n[l]=a,D=(n,l)=>{for(var a in l||(l={}))te.call(l,a)&&I(n,a,l[a]);if(H)for(var a of H(l))ae.call(l,a)&&I(n,a,l[a]);return n};var T=(n,l,a)=>new Promise((w,_)=>{var b=m=>{try{v(a.next(m))}catch(d){_(d)}},x=m=>{try{v(a.throw(m))}catch(d){_(d)}},v=m=>m.done?w(m.value):Promise.resolve(m.value).then(b,x);v((a=a.apply(n,l)).next())});import{_ as re,$ as t,a8 as W,bZ as ie,aZ as le,aN as se,c0 as ne,Y as F,aI as E,Z as M,M as h,R as C,Q as me}from"./bootstrap-Bf65uz2I.js";import"./css-gf8D6QlL.js";import{E as pe}from"./el-dialog-CAR1-R4U.js";import"./el-overlay-Zuw8glOl.js";/* empty css                */import{E as ce,a as ue}from"./el-form-item-8FQp7Cs4.js";import"./css-C9o_OfXA.js";import"./css-B4xXAc0m.js";import{E as U}from"./el-message-box-B8o3mhYx.js";import{w as de}from"./workflowIcon-DFe_EiNo.js";import{H as fe}from"./HeaderSearch-Dj9rqjlr.js";import{m as L,n as g,q as R,k as ge,o as ve,r as u,S as ye,c as ke,J as c,E as f,u as s,F as he,N as we,B as $,p as _e,L as z,y as Q}from"../jse/index-index-D3Xb8oT_.js";import{C as Ce}from"./CardList-DOl2PmFc.js";import{_ as be}from"./PageData.vue_vue_type_script_setup_true_lang-DfbAOXk_.js";import{P as xe}from"./PageSide-wLZhy9Oh.js";import{u as Ne}from"./dict-CsbZy8Qf.js";import{_ as Be}from"./WorkflowModal.vue_vue_type_script_setup_true_lang-CuW_4vbQ.js";import{ElInput as Ve}from"./index-BjDsryRX.js";import{ElInputNumber as De}from"./index-9UPoHQm1.js";import{ElButton as P}from"./index-oBOAcXl-.js";import"./index-B3qAv2kq.js";import"./aria-DEUWDJ1E.js";import"./refs-D6FW0B1r.js";import"./event-BB_Ol6Sd.js";import"./index-Bxb6QITi.js";import"./index-Dg3fRnQE.js";import"./vnode-DysYOGZN.js";import"./scroll-C2492Iw_.js";import"./use-form-common-props-IzjzSHax.js";import"./castArray-BBset58W.js";import"./_baseClone-trfKWgGN.js";import"./validator-D2YZey62.js";import"./el-dropdown-menu-v2KdT220.js";import"./index-CMBjNRIa.js";import"./index-bT9OJj6t.js";import"./_overRest-Bb9G3v08.js";import"./index-CbSmxnRE.js";import"./util-B2mB0_6C.js";/* empty css                  *//* empty css                     */import"./hasPermission-CIdLHqw4.js";import"./el-avatar-BVPcm0Px.js";import"./el-card-DGd_zL6P.js";import"./css-CLrSDUNG.js";/* empty css                */import"./index-Bpv3aWiu.js";import"./index-Ce9mjW49.js";import"./el-empty-CDAlv280.js";import"./el-pagination-W2lJTIgw.js";import"./index-DcZY4wgD.js";import"./index-DGdiZ7pE.js";import"./useProps-DNCnrLfW.js";import"./_baseFindIndex-D7XfJLKM.js";import"./_baseIteratee-rJjBrWyx.js";import"./strings-CGsg9AfI.js";import"./use-form-item-DVWmmqeW.js";import"./index-m1ZP1zbM.js";import"./clamp-CeuJyDnc.js";import"./toNumber-CvayJyp9.js";import"./index-pv0R11Cf.js";/* empty css               *//* empty css                  */import"./DictSelect-DdOvS-6R.js";import"./UploadAvatar-a3x1lqjM.js";import"./el-image-viewer-DlaFkWIK.js";import"./debounce-AsHllEOy.js";import"./index-C33Sf0pH.js";import"./css-BA5xAVBz.js";import"./index-e0qsk5Ci.js";import"./cloneDeep-Orislllf.js";import"./index-BKzCwxYe.js";const Ee={},$e={t:"1765503751020",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"9797",width:"1em",height:"1em"};function Le(n,l){return g(),L("svg",$e,[...l[0]||(l[0]=[R("path",{d:"M827.712 341.312H452.288a25.6 25.6 0 0 1-25.6-25.6V256H320c-29.44 0-54.592 10.432-75.456 31.232a102.784 102.784 0 0 0-31.232 75.456c0 29.44 10.432 54.592 31.232 75.392A102.784 102.784 0 0 0 320 469.312h384c53.056 0 98.24 18.816 135.744 56.256A184.96 184.96 0 0 1 896 661.312c0 53.056-18.752 98.304-56.256 135.808a184.96 184.96 0 0 1-135.744 56.192H554.688v59.776a25.6 25.6 0 0 1-25.6 25.6H153.6a25.6 25.6 0 0 1-25.6-25.6v-204.8a25.6 25.6 0 0 1 25.6-25.6h375.488a25.6 25.6 0 0 1 25.6 25.6V768H704c29.44 0 54.592-10.432 75.456-31.232a102.912 102.912 0 0 0 31.232-75.456c0-29.44-10.432-54.592-31.232-75.392A102.848 102.848 0 0 0 704 554.688H320a185.088 185.088 0 0 1-135.744-56.256A184.96 184.96 0 0 1 128 362.688c0-53.056 18.752-98.304 56.256-135.808A184.96 184.96 0 0 1 320 170.688h106.688v-59.776a25.6 25.6 0 0 1 25.6-25.6h375.424a25.6 25.6 0 0 1 25.6 25.6v204.8a25.6 25.6 0 0 1-25.6 25.6zM537.6 256h204.8a25.6 25.6 0 0 0 25.6-25.6v-34.112a25.6 25.6 0 0 0-25.6-25.6H537.6a25.6 25.6 0 0 0-25.6 25.6V230.4a25.6 25.6 0 0 0 25.6 25.6z m-68.288 571.712V793.6a25.6 25.6 0 0 0-25.6-25.6h-204.8a25.6 25.6 0 0 0-25.6 25.6v34.112a25.6 25.6 0 0 0 25.6 25.6h204.8a25.6 25.6 0 0 0 25.6-25.6z","p-id":"9798",fill:"currentColor"},null,-1)])])}const Re=re(Ee,[["render",Le]]),Se={class:"flex h-full flex-col gap-6 p-6"},qe={class:"flex max-h-[calc(100vh-191px)] flex-1 gap-6"},Ae={class:"h-full flex-1 overflow-auto"},ot=ge({__name:"WorkflowList",setup(n){const l=[{icon:W,text:t("button.edit"),className:"",permission:"/api/v1/workflow/save",onClick:e=>{d(e)}},{icon:Re,text:t("button.design"),className:"",permission:"/api/v1/workflow/save",onClick:e=>{J(e)}},{icon:ie,text:t("button.run"),className:"",permission:"",onClick:e=>{E.push({name:"RunPage",query:{id:e.id}})}},{icon:le,text:t("aiWorkflowExecRecord.moduleName"),className:"",permission:"/api/v1/workflow/save",onClick:e=>{E.push({name:"ExecRecord",query:{workflowId:e.id}})}},{icon:se,text:t("button.export"),className:"",permission:"",onClick:e=>{j(e)}},{icon:ne,text:t("button.copy"),className:"",permission:"",onClick:e=>{d({title:`${e.title}Copy`,content:e.content})}},{icon:F,text:t("button.delete"),className:"item-danger",permission:"",onClick:e=>{Z(e)}}];ve(()=>{x(),V()});const a=u(),w=u(),_=Ne(),b=[{key:"create",text:t("button.add"),icon:ye(M),type:"primary",data:{action:"create"},permission:"/api/v1/workflow/save"}];function x(){_.fetchDictionary("dataStatus")}const v=e=>{a.value.setQuery({title:e,isQueryOr:!0})};function m(){a.value.setQuery({})}function d(e){w.value.openDialog(D({},e))}function Z(e){U.confirm(t("message.deleteAlert"),t("message.noticeTitle"),{confirmButtonText:t("message.ok"),cancelButtonText:t("message.cancel"),type:"warning",beforeClose:(r,o,i)=>{r==="confirm"?(o.confirmButtonLoading=!0,h.post("/api/v1/workflow/remove",{id:e.id}).then(k=>{o.confirmButtonLoading=!1,k.errorCode===0&&(C.success(k.message),m(),i())}).catch(()=>{o.confirmButtonLoading=!1})):i()}}).catch(()=>{})}function J(e){E.push({name:"WorkflowDesign",query:{id:e.id}})}function j(e){h.get("/api/v1/workflow/exportWorkFlow",{params:{id:e.id}}).then(r=>{const o=r.data,i=document.createElement("a");i.setAttribute("href",`data:text/plain;charset=utf-8,${encodeURIComponent(o)}`),i.setAttribute("download",`${e.title}.json`),i.style.display="none",document.body.append(i),i.click(),i.remove(),C.success(t("message.downloadSuccess"))})}const S=u([{prop:"categoryName",label:t("aiWorkflowCategory.categoryName"),type:"input",required:!0,placeholder:t("aiWorkflowCategory.categoryName")},{prop:"sortNo",label:t("aiWorkflowCategory.sortNo"),type:"number",required:!1,placeholder:t("aiWorkflowCategory.sortNo")}]),p=u({}),y=u(!1),N=u(),B=u(!1),q=u([]),K=[{icon:W,label:t("button.edit"),onClick(e){A(e)}},{type:"danger",icon:F,label:t("button.delete"),onClick(e){X(e)}}],O={icon:M,label:t("button.add"),onClick(){A({})}},Y=ke(()=>{const e={};return S.value.forEach(r=>{const o=[];r.required&&o.push({required:!0,message:`${t("message.required")}`,trigger:"blur"}),o.length>0&&(e[r.prop]=o)}),e});function G(e){a.value.setQuery({categoryId:e.id})}function A(e){var r;(r=N.value)==null||r.resetFields(),p.value=D({},e),y.value=!0}function X(e){U.confirm(t("message.deleteAlert"),t("message.noticeTitle"),{confirmButtonText:t("message.ok"),cancelButtonText:t("message.cancel"),type:"warning",beforeClose:(r,o,i)=>{r==="confirm"?(o.confirmButtonLoading=!0,h.post("/api/v1/workflowCategory/remove",{id:e.id}).then(k=>{o.confirmButtonLoading=!1,k.errorCode===0&&(C.success(k.message),i(),V())}).catch(()=>{o.confirmButtonLoading=!1})):i()}}).catch(()=>{})}function ee(){var e;(e=N.value)==null||e.validate(r=>{if(r){B.value=!0;const o=p.value.id?"/api/v1/workflowCategory/update":"/api/v1/workflowCategory/save";h.post(o,p.value).then(i=>{B.value=!1,i.errorCode===0&&(C.success(i.message),y.value=!1,V())})}})}const V=()=>T(null,null,function*(){const[,e]=yield me(h.get)("/api/v1/workflowCategory/list",{params:{sortKey:"sortNo",sortType:"asc"}});e&&e.errorCode===0&&(q.value=[{id:"",categoryName:t("common.allCategories")},...e.data])});return(e,r)=>(g(),L("div",Se,[c(Be,{ref_key:"saveDialog",ref:w,onReload:m},null,512),c(fe,{buttons:b,onSearch:v,onButtonClick:r[0]||(r[0]=o=>d({}))}),R("div",qe,[c(xe,{"label-key":"categoryName","value-key":"id",menus:q.value,"control-btns":K,"footer-button":O,onChange:G},null,8,["menus"]),R("div",Ae,[c(be,{ref_key:"pageDataRef",ref:a,"page-url":"/api/v1/workflow/page","page-sizes":[12,18,24],"page-size":12},{default:f(({pageList:o})=>[c(Ce,{"default-icon":s(de),data:o,actions:l},null,8,["default-icon","data"])]),_:1},512)])]),c(s(pe),{modelValue:y.value,"onUpdate:modelValue":r[2]||(r[2]=o=>y.value=o),title:p.value.id?`${s(t)("button.edit")}`:`${s(t)("button.add")}`,"close-on-click-modal":!1},{footer:f(()=>[c(s(P),{onClick:r[1]||(r[1]=o=>y.value=!1)},{default:f(()=>[z(Q(s(t)("button.cancel")),1)]),_:1}),c(s(P),{type:"primary",onClick:ee,loading:B.value},{default:f(()=>[z(Q(s(t)("button.confirm")),1)]),_:1},8,["loading"])]),default:f(()=>[c(s(ce),{ref_key:"formRef",ref:N,model:p.value,rules:Y.value,"label-width":"120px"},{default:f(()=>[(g(!0),L(he,null,we(S.value,o=>(g(),$(s(ue),{key:o.prop,label:o.label,prop:o.prop},{default:f(()=>[!o.type||o.type==="input"?(g(),$(s(Ve),{key:0,modelValue:p.value[o.prop],"onUpdate:modelValue":i=>p.value[o.prop]=i,placeholder:o.placeholder},null,8,["modelValue","onUpdate:modelValue","placeholder"])):o.type==="number"?(g(),$(s(De),{key:1,modelValue:p.value[o.prop],"onUpdate:modelValue":i=>p.value[o.prop]=i,placeholder:o.placeholder,style:{width:"100%"}},null,8,["modelValue","onUpdate:modelValue","placeholder"])):_e("",!0)]),_:2},1032,["label","prop"]))),128))]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])]))}});export{ot as default};
