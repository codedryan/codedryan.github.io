var L=Object.defineProperty;var K=Object.getOwnPropertySymbols;var P=Object.prototype.hasOwnProperty,U=Object.prototype.propertyIsEnumerable;var _=(u,r,i)=>r in u?L(u,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):u[r]=i,I=(u,r)=>{for(var i in r||(r={}))P.call(r,i)&&_(u,i,r[i]);if(K)for(var i of K(r))U.call(r,i)&&_(u,i,r[i]);return u};import{$ as t,M as F,R as c,_ as q}from"./bootstrap-Bf65uz2I.js";import{E as N}from"./el-alert-DFDoDStD.js";import"./css-gf8D6QlL.js";import"./css-_QzOlLq8.js";import"./css-XAUFhYlW.js";import"./css-Dv7ceDvX.js";import"./css-C9o_OfXA.js";/* empty css                     *//* empty css                  */import{E as R}from"./el-dialog-CAR1-R4U.js";import"./el-overlay-Zuw8glOl.js";/* empty css                */import{E as $,a as E}from"./el-form-item-8FQp7Cs4.js";import{D as G}from"./DictSelect-DdOvS-6R.js";import{ElDatePicker as J}from"./index-Dwe-AimY.js";import{ElCheckboxGroup as O,ElCheckbox as T}from"./index-p7kg-xKH.js";import{ElButton as h}from"./index-oBOAcXl-.js";import{k as j,r as d,o as z,B as D,n as k,E as l,J as m,u as e,L as y,m as H,F as Q,N as W,y as A}from"../jse/index-index-D3Xb8oT_.js";import"./index-CMBjNRIa.js";import"./index-bT9OJj6t.js";import"./_overRest-Bb9G3v08.js";import"./index-B3qAv2kq.js";import"./aria-DEUWDJ1E.js";import"./index-Bxb6QITi.js";import"./use-form-common-props-IzjzSHax.js";import"./refs-D6FW0B1r.js";import"./event-BB_Ol6Sd.js";import"./index-Dg3fRnQE.js";import"./vnode-DysYOGZN.js";import"./scroll-C2492Iw_.js";import"./castArray-BBset58W.js";import"./_baseClone-trfKWgGN.js";/* empty css                  *//* empty css               */import"./index-DcZY4wgD.js";import"./index-CbSmxnRE.js";import"./util-B2mB0_6C.js";import"./index-DGdiZ7pE.js";import"./useProps-DNCnrLfW.js";import"./_baseFindIndex-D7XfJLKM.js";import"./_baseIteratee-rJjBrWyx.js";import"./strings-CGsg9AfI.js";import"./use-form-item-DVWmmqeW.js";import"./index-m1ZP1zbM.js";import"./clamp-CeuJyDnc.js";import"./toNumber-CvayJyp9.js";import"./index-pv0R11Cf.js";import"./panel-time-pick-Dcp5yKq_.js";import"./index-BjDsryRX.js";import"./index-C33Sf0pH.js";import"./index-BKzCwxYe.js";import"./debounce-AsHllEOy.js";import"./omit-CbyqVLxv.js";import"./_baseSlice-DZe_dRSe.js";const X=j({__name:"SysApiKeyModal",emits:["reload"],setup(u,{expose:r,emit:i}){const S=i,f=d(),v=d(!1),g=d(!0),p=d({apiKey:"",status:"",deptId:"",expiredAt:null,permissionIds:[]}),n=d(!1),V=d([]),C=d({status:[{required:!0,message:t("message.pleaseSelect",{name:t("sysApiKey.status")}),trigger:"change"}],expiredAt:[{required:!0,message:t("message.pleaseSelect",{name:t("sysApiKey.expiredAt")}),trigger:"change"}]});function M(o={}){var s;(s=f.value)==null||s.resetFields(),p.value=I({apiKey:"",status:"",deptId:"",expiredAt:null,permissionIds:[]},o),g.value=!o.id,v.value=!0}function w(){F.get("/api/v1/sysApiKeyResourcePermission/list").then(o=>{o.errorCode===0?V.value=o.data:c.error(o.message||t("message.getDataError"))}).catch(()=>{c.error(t("message.getDataError"))})}function B(){var o;(o=f.value)==null||o.validate(s=>{if(s){n.value=!0;const a=g.value?"api/v1/sysApiKey/save":"api/v1/sysApiKey/update";F.post(a,p.value).then(x=>{n.value=!1,x.errorCode===0?(c.success(x.message||t("message.saveOkMessage")),S("reload"),b()):c.error(x.message||t("message.saveFailMessage"))}).catch(()=>{n.value=!1,c.error(t("message.saveFailMessage"))})}})}function b(){var o;(o=f.value)==null||o.resetFields(),p.value={apiKey:"",status:"",deptId:"",expiredAt:null,permissionIds:[]},g.value=!0,v.value=!1}return z(()=>{w()}),r({openDialog:M}),(o,s)=>(k(),D(e(R),{modelValue:v.value,"onUpdate:modelValue":s[3]||(s[3]=a=>v.value=a),draggable:"",title:g.value?e(t)("button.add"):e(t)("button.edit"),"before-close":b,"close-on-click-modal":!1,width:"50%"},{footer:l(()=>[m(e(h),{onClick:b},{default:l(()=>[y(A(e(t)("button.cancel")),1)]),_:1}),m(e(h),{type:"primary",onClick:B,loading:n.value,disabled:n.value},{default:l(()=>[y(A(e(t)("button.save")),1)]),_:1},8,["loading","disabled"])]),default:l(()=>[m(e($),{"label-width":"120px",ref_key:"saveForm",ref:f,model:p.value,"status-icon":"",rules:C.value,class:"form-container"},{default:l(()=>[m(e(E),{prop:"status",label:e(t)("sysApiKey.status")},{default:l(()=>[m(G,{modelValue:p.value.status,"onUpdate:modelValue":s[0]||(s[0]=a=>p.value.status=a),"dict-code":"dataStatus",style:{width:"100%"}},null,8,["modelValue"])]),_:1},8,["label"]),m(e(E),{prop:"expiredAt",label:e(t)("sysApiKey.expiredAt")},{default:l(()=>[m(e(J),{modelValue:p.value.expiredAt,"onUpdate:modelValue":s[1]||(s[1]=a=>p.value.expiredAt=a),type:"datetime",placeholder:e(t)("message.pleaseSelect",{name:e(t)("sysApiKey.expiredAt")}),style:{width:"100%"}},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),m(e(E),{prop:"permissions",label:e(t)("sysApiKey.permissions"),class:"permission-form-item"},{default:l(()=>[m(e(N),{type:"info"},{default:l(()=>[...s[4]||(s[4]=[y(" 接口信息请运行：tech.aiflowy.publicapi.SyncApis 的 main 方法同步到数据库。 ",-1)])]),_:1}),m(e(O),{modelValue:p.value.permissionIds,"onUpdate:modelValue":s[2]||(s[2]=a=>p.value.permissionIds=a),class:"permission-checkbox-group"},{default:l(()=>[(k(!0),H(Q,null,W(V.value,a=>(k(),D(e(T),{key:a.id,value:a.id,class:"permission-checkbox"},{default:l(()=>[y(A(a.requestInterface)+" - "+A(a.title),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"]))}}),Ze=q(X,[["__scopeId","data-v-fb964947"]]);export{Ze as default};
