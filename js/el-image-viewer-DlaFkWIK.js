var Xe=Object.defineProperty,Ye=Object.defineProperties;var He=Object.getOwnPropertyDescriptors;var Ee=Object.getOwnPropertySymbols;var je=Object.prototype.hasOwnProperty,qe=Object.prototype.propertyIsEnumerable;var Le=(o,i,t)=>i in o?Xe(o,i,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[i]=t,Z=(o,i)=>{for(var t in i||(i={}))je.call(i,t)&&Le(o,t,i[t]);if(Ee)for(var t of Ee(i))qe.call(i,t)&&Le(o,t,i[t]);return o},ne=(o,i)=>Ye(o,He(i));var ze=(o,i,t)=>new Promise((d,l)=>{var m=I=>{try{_(t.next(I))}catch(n){l(n)}},V=I=>{try{_(t.throw(I))}catch(n){l(n)}},_=I=>I.done?d(I.value):Promise.resolve(I.value).then(m,V);_((t=t.apply(o,i)).next())});import{ak as Ke,bo as be,bm as Oe,bn as Q,cd as $e,an as Re,cJ as We,cK as Ze,br as Te,ao as xe,cD as Je,cL as Ge,bk as J,ap as Qe,ax as Ue,V as M,bz as ea,aL as aa,aM as sa,cM as ta,cN as oa,cO as na,bX as la,c4 as ra,bv as ia,bx as K,aq as Pe,f as ca,i as G,a as ua,cP as da,cQ as fa,cR as va}from"./bootstrap-Bf65uz2I.js";import{E as ma,a as pa}from"./index-B3qAv2kq.js";import{d as ga}from"./debounce-AsHllEOy.js";import{k as re,S as Se,r as y,ay as wa,c as v,O as ya,w as le,o as Ae,B as he,n as k,E as g,J as f,q as h,z as Ne,s as p,u as a,p as E,m as R,x as N,F as ke,L as ba,y as Me,V as ha,A as Ve,aa as ka,b as Ia,D as _e,a7 as Ca,ap as ge,aq as we,a8 as Ea}from"../jse/index-index-D3Xb8oT_.js";import{u as La}from"./index-C33Sf0pH.js";import{a as za}from"./scroll-C2492Iw_.js";var Sa="Expected a function";function ye(o,i,t){var d=!0,l=!0;if(typeof o!="function")throw new TypeError(Sa);return Ke(t)&&(d="leading"in t?!!t.leading:d,l="trailing"in t?!!t.trailing:l),ga(o,i,{leading:d,maxWait:i,trailing:l})}const Na=Oe({urlList:{type:Q(Array),default:()=>$e([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:Boolean,teleported:Boolean,closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},scale:{type:Number,default:1},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},showProgress:Boolean,crossorigin:{type:Q(String)}}),_a={close:()=>!0,error:o=>o instanceof Event,switch:o=>be(o),rotate:o=>be(o)},Oa=re({name:"ElImageViewer"}),$a=re(ne(Z({},Oa),{props:Na,emits:_a,setup(o,{expose:i,emit:t}){var d;const l=o,m={CONTAIN:{name:"contain",icon:Se(Ze)},ORIGINAL:{name:"original",icon:Se(We)}};let V,_="";const{t:I}=Te(),n=xe("image-viewer"),{nextZIndex:B}=Je(),L=y(),Y=y(),D=wa(),O=v(()=>{const{scale:e,minScale:u,maxScale:c}=l;return Ge(e,u,c)}),T=y(!0),z=y(!1),w=y(l.initialIndex),H=ya(m.CONTAIN),r=y({scale:O.value,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),ie=y((d=l.zIndex)!=null?d:B()),U=v(()=>{const{urlList:e}=l;return e.length<=1}),j=v(()=>w.value===0),ee=v(()=>w.value===l.urlList.length-1),q=v(()=>l.urlList[w.value]),ce=v(()=>[n.e("btn"),n.e("prev"),n.is("disabled",!l.infinite&&j.value)]),ae=v(()=>[n.e("btn"),n.e("next"),n.is("disabled",!l.infinite&&ee.value)]),se=v(()=>{const{scale:e,deg:u,offsetX:c,offsetY:$,enableTransition:P}=r.value;let S=c/e,A=$/e;const W=u*Math.PI/180,Ie=Math.cos(W),Ce=Math.sin(W);S=S*Ie+A*Ce,A=A*Ie-c/e*Ce;const pe={transform:`scale(${e}) rotate(${u}deg) translate(${S}px, ${A}px)`,transition:P?"transform .3s":""};return H.value.name===m.CONTAIN.name&&(pe.maxWidth=pe.maxHeight="100%"),pe}),te=v(()=>`${w.value+1} / ${l.urlList.length}`);function F(){de(),V==null||V(),document.body.style.overflow=_,t("close")}function ue(){const e=ye(c=>{switch(ia(c)){case K.esc:l.closeOnPressEscape&&F();break;case K.space:fe();break;case K.left:ve();break;case K.up:x("zoomIn");break;case K.right:me();break;case K.down:x("zoomOut");break}}),u=ye(c=>{const $=c.deltaY||c.deltaX;x($<0?"zoomIn":"zoomOut",{zoomRate:l.zoomRate,enableTransition:!1})});D.run(()=>{J(document,"keydown",e),J(document,"wheel",u)})}function de(){D.stop()}function s(){T.value=!1}function C(e){z.value=!0,T.value=!1,t("error",e),e.target.alt=I("el.image.error")}function b(e){if(T.value||e.button!==0||!L.value)return;r.value.enableTransition=!1;const{offsetX:u,offsetY:c}=r.value,$=e.pageX,P=e.pageY,S=ye(W=>{r.value=ne(Z({},r.value),{offsetX:u+W.pageX-$,offsetY:c+W.pageY-P})}),A=J(document,"mousemove",S);J(document,"mouseup",()=>{A()}),e.preventDefault()}function X(){r.value={scale:O.value,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function fe(){if(T.value||z.value)return;const e=ra(m),u=Object.values(m),c=H.value.name,P=(u.findIndex(S=>S.name===c)+1)%e.length;H.value=m[e[P]],X()}function oe(e){z.value=!1;const u=l.urlList.length;w.value=(e+u)%u}function ve(){j.value&&!l.infinite||oe(w.value-1)}function me(){ee.value&&!l.infinite||oe(w.value+1)}function x(e,u={}){if(T.value||z.value)return;const{minScale:c,maxScale:$}=l,{zoomRate:P,rotateDeg:S,enableTransition:A}=Z({zoomRate:l.zoomRate,rotateDeg:90,enableTransition:!0},u);switch(e){case"zoomOut":r.value.scale>c&&(r.value.scale=Number.parseFloat((r.value.scale/P).toFixed(3)));break;case"zoomIn":r.value.scale<$&&(r.value.scale=Number.parseFloat((r.value.scale*P).toFixed(3)));break;case"clockwise":r.value.deg+=S,t("rotate",r.value.deg);break;case"anticlockwise":r.value.deg-=S,t("rotate",r.value.deg);break}r.value.enableTransition=A}function Be(e){var u;((u=e.detail)==null?void 0:u.focusReason)==="pointer"&&e.preventDefault()}function De(){l.closeOnPressEscape&&F()}function Fe(e){if(e.ctrlKey){if(e.deltaY<0)return e.preventDefault(),!1;if(e.deltaY>0)return e.preventDefault(),!1}}return le(()=>O.value,e=>{r.value.scale=e}),le(q,()=>{Ve(()=>{const e=Y.value;e!=null&&e.complete||(T.value=!0)})}),le(w,e=>{X(),t("switch",e)}),Ae(()=>{ue(),V=J("wheel",Fe,{passive:!1}),_=document.body.style.overflow,document.body.style.overflow="hidden"}),i({setActiveItem:oe}),(e,u)=>(k(),he(a(pa),{to:"body",disabled:!e.teleported},{default:g(()=>[f(Qe,{name:"viewer-fade",appear:""},{default:g(()=>[h("div",{ref_key:"wrapper",ref:L,tabindex:-1,class:p(a(n).e("wrapper")),style:Ne({zIndex:ie.value})},[f(a(ma),{loop:"",trapped:"","focus-trap-el":L.value,"focus-start-el":"container",onFocusoutPrevented:Be,onReleaseRequested:De},{default:g(()=>[h("div",{class:p(a(n).e("mask")),onClick:Ue(c=>e.hideOnClickModal&&F(),["self"])},null,10,["onClick"]),E(" CLOSE "),h("span",{class:p([a(n).e("btn"),a(n).e("close")]),onClick:F},[f(a(M),null,{default:g(()=>[f(a(ea))]),_:1})],2),E(" ARROW "),a(U)?E("v-if",!0):(k(),R(ke,{key:0},[h("span",{class:p(a(ce)),onClick:ve},[f(a(M),null,{default:g(()=>[f(a(aa))]),_:1})],2),h("span",{class:p(a(ae)),onClick:me},[f(a(M),null,{default:g(()=>[f(a(sa))]),_:1})],2)],64)),e.$slots.progress||e.showProgress?(k(),R("div",{key:1,class:p([a(n).e("btn"),a(n).e("progress")])},[N(e.$slots,"progress",{activeIndex:w.value,total:e.urlList.length},()=>[ba(Me(a(te)),1)])],2)):E("v-if",!0),E(" ACTIONS "),h("div",{class:p([a(n).e("btn"),a(n).e("actions")])},[h("div",{class:p(a(n).e("actions__inner"))},[N(e.$slots,"toolbar",{actions:x,prev:ve,next:me,reset:fe,activeIndex:w.value,setActiveItem:oe},()=>[f(a(M),{onClick:c=>x("zoomOut")},{default:g(()=>[f(a(ta))]),_:1},8,["onClick"]),f(a(M),{onClick:c=>x("zoomIn")},{default:g(()=>[f(a(oa))]),_:1},8,["onClick"]),h("i",{class:p(a(n).e("actions__divider"))},null,2),f(a(M),{onClick:fe},{default:g(()=>[(k(),he(ha(a(H).icon)))]),_:1}),h("i",{class:p(a(n).e("actions__divider"))},null,2),f(a(M),{onClick:c=>x("anticlockwise")},{default:g(()=>[f(a(na))]),_:1},8,["onClick"]),f(a(M),{onClick:c=>x("clockwise")},{default:g(()=>[f(a(la))]),_:1},8,["onClick"])])],2)],2),E(" CANVAS "),h("div",{class:p(a(n).e("canvas"))},[z.value&&e.$slots["viewer-error"]?N(e.$slots,"viewer-error",{key:0,activeIndex:w.value,src:a(q)}):(k(),R("img",{ref_key:"imgRef",ref:Y,key:a(q),src:a(q),style:Ne(a(se)),class:p(a(n).e("img")),crossorigin:e.crossorigin,onLoad:s,onError:C,onMousedown:b},null,46,["src","crossorigin"]))],2),N(e.$slots,"default")]),_:3},8,["focus-trap-el"])],6)]),_:3})]),_:3},8,["disabled"]))}}));var Ra=Re($a,[["__file","image-viewer.vue"]]);const Ta=Pe(Ra),xa=Oe({hideOnClickModal:Boolean,src:{type:String,default:""},fit:{type:String,values:["","contain","cover","fill","none","scale-down"],default:""},loading:{type:String,values:["eager","lazy"]},lazy:Boolean,scrollContainer:{type:Q([String,Object])},previewSrcList:{type:Q(Array),default:()=>$e([])},previewTeleported:Boolean,zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},scale:{type:Number,default:1},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},showProgress:Boolean,crossorigin:{type:Q(String)}}),Pa={load:o=>o instanceof Event,error:o=>o instanceof Event,switch:o=>be(o),close:()=>!0,show:()=>!0},Aa=re({name:"ElImage",inheritAttrs:!1}),Ma=re(ne(Z({},Aa),{props:xa,emits:Pa,setup(o,{expose:i,emit:t}){const d=o,{t:l}=Te(),m=xe("image"),V=ka(),_=v(()=>ca(Object.entries(V).filter(([s])=>/^(data-|on[A-Z])/i.test(s)||["id","style"].includes(s)))),I=La({excludeListeners:!0,excludeKeys:v(()=>Object.keys(_.value))}),n=y(),B=y(!1),L=y(!0),Y=y(!1),D=y(),O=y(),T=G&&"loading"in HTMLImageElement.prototype;let z;const w=v(()=>[m.e("inner"),r.value&&m.e("preview"),L.value&&m.is("loading")]),H=v(()=>{const{fit:s}=d;return G&&s?{objectFit:s}:{}}),r=v(()=>{const{previewSrcList:s}=d;return Ia(s)&&s.length>0}),ie=v(()=>{const{previewSrcList:s,initialIndex:C}=d;let b=C;return C>s.length-1&&(b=0),b}),U=v(()=>d.loading==="eager"?!1:!T&&d.loading==="lazy"||d.lazy),j=()=>{G&&(L.value=!0,B.value=!1,n.value=d.src)};function ee(s){L.value=!1,B.value=!1,t("load",s)}function q(s){L.value=!1,B.value=!0,t("error",s)}function ce(s){s&&(j(),te())}const ae=va(ce,200,!0);function se(){return ze(this,null,function*(){var s;if(!G)return;yield Ve();const{scrollContainer:C}=d;if(ua(C))O.value=C;else if(Ea(C)&&C!=="")O.value=(s=document.querySelector(C))!=null?s:void 0;else if(D.value){const X=za(D.value);O.value=da(X)?void 0:X}const{stop:b}=fa(D,([X])=>{ae(X.isIntersecting)},{root:O});z=b})}function te(){!G||!ae||(z==null||z(),O.value=void 0,z=void 0)}function F(){r.value&&(Y.value=!0,t("show"))}function ue(){Y.value=!1,t("close")}function de(s){t("switch",s)}return le(()=>d.src,()=>{U.value?(L.value=!0,B.value=!1,te(),se()):j()}),Ae(()=>{U.value?se():j()}),i({showPreview:F}),(s,C)=>(k(),R("div",_e({ref_key:"container",ref:D},a(_),{class:[a(m).b(),s.$attrs.class]}),[B.value?N(s.$slots,"error",{key:0},()=>[h("div",{class:p(a(m).e("error"))},Me(a(l)("el.image.error")),3)]):(k(),R(ke,{key:1},[n.value!==void 0?(k(),R("img",_e({key:0},a(I),{src:n.value,loading:s.loading,style:a(H),class:a(w),crossorigin:s.crossorigin,onClick:F,onLoad:ee,onError:q}),null,16,["src","loading","crossorigin"])):E("v-if",!0),L.value?(k(),R("div",{key:1,class:p(a(m).e("wrapper"))},[N(s.$slots,"placeholder",{},()=>[h("div",{class:p(a(m).e("placeholder"))},null,2)])],2)):E("v-if",!0)],64)),a(r)?(k(),R(ke,{key:2},[Y.value?(k(),he(a(Ta),{key:0,"z-index":s.zIndex,"initial-index":a(ie),infinite:s.infinite,"zoom-rate":s.zoomRate,"min-scale":s.minScale,"max-scale":s.maxScale,"show-progress":s.showProgress,"url-list":s.previewSrcList,scale:s.scale,crossorigin:s.crossorigin,"hide-on-click-modal":s.hideOnClickModal,teleported:s.previewTeleported,"close-on-press-escape":s.closeOnPressEscape,onClose:ue,onSwitch:de},Ca({toolbar:g(b=>[N(s.$slots,"toolbar",ge(we(b)))]),default:g(()=>[s.$slots.viewer?(k(),R("div",{key:0},[N(s.$slots,"viewer")])):E("v-if",!0)]),_:2},[s.$slots.progress?{name:"progress",fn:g(b=>[N(s.$slots,"progress",ge(we(b)))])}:void 0,s.$slots["viewer-error"]?{name:"viewer-error",fn:g(b=>[N(s.$slots,"viewer-error",ge(we(b)))])}:void 0]),1032,["z-index","initial-index","infinite","zoom-rate","min-scale","max-scale","show-progress","url-list","scale","crossorigin","hide-on-click-modal","teleported","close-on-press-escape"])):E("v-if",!0)],64)):E("v-if",!0)],16))}}));var Va=Re(Ma,[["__file","image.vue"]]);const qa=Pe(Va);export{qa as E};
