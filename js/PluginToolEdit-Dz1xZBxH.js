import{as as Y,a9 as ee,M as x,$ as a,a7 as te,bZ as ie,aG as S,V as R,ax as b,bQ as z,R as ae,_ as le}from"./bootstrap-Bf65uz2I.js";import"./css-gf8D6QlL.js";/* empty css                */import{a as k,E as oe}from"./el-form-item-8FQp7Cs4.js";import"./css-C9o_OfXA.js";/* empty css                  *//* empty css               *//* empty css                     *//* empty css                  */import G from"./PluginInputAndOutParams-C3Bu1HeO.js";import se from"./PluginRunTestModal-Cd41ArPc.js";import{ElButton as g}from"./index-oBOAcXl-.js";import{ElInput as T}from"./index-BjDsryRX.js";import{E as ne,a as ue}from"./index-DcZY4wgD.js";import{k as re,r as p,o as de,G as pe,m as L,n as f,q as i,J as s,E as r,L as v,y as o,u as e,s as E,B as _,p as h,I as A,F as me,N as ce}from"../jse/index-index-D3Xb8oT_.js";import"./use-form-common-props-IzjzSHax.js";import"./castArray-BBset58W.js";import"./index-Bxb6QITi.js";import"./_baseClone-trfKWgGN.js";import"./css-DCrZaNHy.js";import"./el-table-JPhh2aff.js";import"./index-CbSmxnRE.js";import"./util-B2mB0_6C.js";import"./index-bT9OJj6t.js";import"./_overRest-Bb9G3v08.js";import"./index-CMBjNRIa.js";import"./index-B3qAv2kq.js";import"./aria-DEUWDJ1E.js";import"./merge-BysAs727.js";import"./isArrayLikeObject-j3RaJGb0.js";import"./_baseSlice-DZe_dRSe.js";import"./_baseIteratee-rJjBrWyx.js";import"./debounce-AsHllEOy.js";import"./toNumber-CvayJyp9.js";import"./index-p7kg-xKH.js";import"./event-BB_Ol6Sd.js";import"./use-form-item-DVWmmqeW.js";import"./index-Dg3fRnQE.js";import"./omit-CbyqVLxv.js";import"./index-pv0R11Cf.js";import"./raf-BVBe43_O.js";import"./css-_QzOlLq8.js";/* empty css                   *//* empty css                        */import"./index-CHf9SThW.js";import"./validator-D2YZey62.js";import"./index-C33Sf0pH.js";import"./index-m1ZP1zbM.js";import"./index-DGdiZ7pE.js";import"./useProps-DNCnrLfW.js";import"./_baseFindIndex-D7XfJLKM.js";import"./strings-CGsg9AfI.js";import"./scroll-C2492Iw_.js";import"./clamp-CeuJyDnc.js";import"./vnode-DysYOGZN.js";import"./el-dialog-CAR1-R4U.js";import"./el-overlay-Zuw8glOl.js";import"./refs-D6FW0B1r.js";import"./vue3-json-viewer-B3eBxIfC.js";import"./PluginRunParams-Bsgpaq87.js";import"./index-DF0dk4ce.js";const ve={class:"accordion-container"},ge={class:"controls-header"},fe={class:"accordion-list"},be={class:"column-header-container"},Ee={class:"accordion-title"},_e={class:"accordion-content-inner"},he={class:"plugin-tool-info-edit-container"},ke={class:"plugin-tool-info-view-container"},Pe={class:"plugin-tool-view-item"},ye={class:"view-item-title"},Oe={class:"plugin-tool-view-item"},Ie={class:"view-item-title"},Te={class:"plugin-tool-view-item"},Ce={class:"view-item-title"},Ve={class:"plugin-tool-view-item"},we={class:"view-item-title"},qe={class:"plugin-tool-view-item"},Me={class:"view-item-title"},Ne={class:"column-header-container"},$e={class:"accordion-title"},Se={class:"accordion-content-inner"},Re={class:"column-header-container"},De={class:"accordion-title"},Ue={class:"accordion-content-inner"},Be=re({__name:"PluginToolEdit",setup(Fe){const H=Y(),Q=ee(),P=p(H.query.id||"");de(()=>{P.value&&D()});const n=p({name:"",englishName:"",description:"",basePath:"",requestMethod:""}),C=p({}),y=p([]),O=p([]);function D(){x.post("/api/v1/pluginItem/tool/search",{aiPluginToolId:P.value}).then(u=>{u.errorCode===0&&(n.value=u.data.data,C.value=u.data.aiPlugin,y.value=JSON.parse(u.data.data.inputData||"[]"),O.value=JSON.parse(u.data.data.outputData||"[]"))})}const I=p(!1),V=p(!1),d=p({title:a("pluginItem.pluginToolEdit.basicInfo"),isOpen:!0,isEdit:!1}),m=p({title:a("pluginItem.pluginToolEdit.configureInputParameters"),isOpen:!1,isEdit:!1}),c=p({title:a("pluginItem.pluginToolEdit.configureOutputParameters"),isOpen:!1,isEdit:!1}),U=p(),B=p(),w=u=>{switch(u){case 1:{d.value.isOpen=!d.value.isOpen;break}case 2:{m.value.isOpen=!m.value.isOpen;break}case 3:{c.value.isOpen=!c.value.isOpen;break}}},Z=()=>{Q.back()},j=pe({name:[{required:!0,message:a("message.required"),trigger:"blur"}],requestMethod:[{required:!0,message:a("message.required"),trigger:"blur"}],basePath:[{required:!0,message:a("message.required"),trigger:"blur"}],englishName:[{required:!0,message:a("message.required"),trigger:"blur"}],description:[{required:!0,message:a("message.required"),trigger:"blur",whiteSpace:!0}]}),q=p(),K=u=>{if(u===1){if(!q.value)return;q.value.validate(t=>{t&&F(u)})}else F(u)},F=u=>{x.post("/api/v1/pluginItem/tool/update",{id:P.value,name:n.value.name,englishName:n.value.englishName,description:n.value.description,basePath:n.value.basePath,requestMethod:n.value.requestMethod,inputData:JSON.stringify(y.value),outputData:JSON.stringify(O.value)}).then(t=>{if(t.errorCode===0)switch(ae.success(a("message.updateOkMessage")),u){case 1:{d.value.isEdit=!1;break}case 2:{m.value.isEdit=!1;break}case 3:{c.value.isEdit=!1;break}}})},M=u=>{switch(u){case 1:{d.value.isEdit=!0;break}case 2:{m.value.isEdit=!0,m.value.isOpen=!0,I.value=!0;break}case 3:{c.value.isEdit=!0,c.value.isOpen=!0,V.value=!0;break}}},N=u=>{if(u===2)try{U.value.handleSubmitParams()}catch(t){console.error("校验失败:",t);return}if(u===3)try{B.value.handleSubmitParams()}catch(t){console.error("校验失败:",t);return}I.value=!1,K(u)},$=u=>{switch(D(),u){case 1:{d.value.isEdit=!1;break}case 2:{m.value.isEdit=!1,I.value=!1;break}case 3:{c.value.isEdit=!1,V.value=!1;break}}},W=[{label:"POST",value:"POST"},{label:"GET",value:"GET"},{label:"PUT",value:"PUT"},{label:"DELETE",value:"DELETE"},{label:"PATCH",value:"PATCH"}],J=p(),X=()=>{J.value.openDialog()};return(u,t)=>(f(),L("div",ve,[i("div",ge,[s(e(g),{onClick:Z,icon:e(te)},{default:r(()=>[v(o(e(a)("button.back")),1)]),_:1},8,["icon"]),s(e(g),{type:"primary",icon:e(ie),onClick:X},{default:r(()=>[v(o(e(a)("pluginItem.pluginToolEdit.trialRun")),1)]),_:1},8,["icon"])]),i("div",fe,[i("div",{class:E(["accordion-item",{"accordion-item--active":d.value.isOpen}])},[i("div",{class:"accordion-header",onClick:t[3]||(t[3]=l=>w(1))},[i("div",be,[i("div",{class:E(["accordion-icon",{"accordion-icon--rotated":d.value.isOpen}])},[s(e(R),{size:"16"},{default:r(()=>[s(e(S))]),_:1})],2),i("h3",Ee,o(d.value.title),1)]),i("div",null,[d.value.isEdit?h("",!0):(f(),_(e(g),{key:0,onClick:t[0]||(t[0]=b(l=>M(1),["stop"])),type:"primary"},{default:r(()=>[v(o(e(a)("button.edit")),1)]),_:1})),d.value.isEdit?(f(),_(e(g),{key:1,onClick:t[1]||(t[1]=b(l=>$(1),["stop"]))},{default:r(()=>[v(o(e(a)("button.cancel")),1)]),_:1})):h("",!0),d.value.isEdit?(f(),_(e(g),{key:2,onClick:t[2]||(t[2]=b(l=>N(1),["stop"])),type:"primary"},{default:r(()=>[v(o(e(a)("button.save")),1)]),_:1})):h("",!0)])]),i("div",{class:E(["accordion-content",{"accordion-content--open":d.value.isOpen}])},[i("div",_e,[A(i("div",null,[i("div",he,[s(e(oe),{ref_key:"saveForm",ref:q,model:n.value,"label-width":"80px","status-icon":"",rules:j},{default:r(()=>[s(e(k),{label:e(a)("pluginItem.name"),prop:"name"},{default:r(()=>[s(e(T),{modelValue:n.value.name,"onUpdate:modelValue":t[4]||(t[4]=l=>n.value.name=l),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1},8,["label"]),s(e(k),{label:e(a)("pluginItem.englishName"),prop:"englishName"},{default:r(()=>[s(e(T),{modelValue:n.value.englishName,"onUpdate:modelValue":t[5]||(t[5]=l=>n.value.englishName=l),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1},8,["label"]),s(e(k),{label:e(a)("pluginItem.pluginToolEdit.toolPath"),prop:"basePath"},{default:r(()=>[s(e(T),{modelValue:n.value.basePath,"onUpdate:modelValue":t[6]||(t[6]=l=>n.value.basePath=l),modelModifiers:{trim:!0}},{prepend:r(()=>[v(o(C.value.baseUrl),1)]),_:1},8,["modelValue"])]),_:1},8,["label"]),s(e(k),{label:e(a)("pluginItem.description"),prop:"description"},{default:r(()=>[s(e(T),{modelValue:n.value.description,"onUpdate:modelValue":t[7]||(t[7]=l=>n.value.description=l),modelModifiers:{trim:!0},type:"textarea",rows:4},null,8,["modelValue"])]),_:1},8,["label"]),s(e(k),{label:e(a)("pluginItem.pluginToolEdit.requestMethod"),prop:"requestMethod"},{default:r(()=>[s(e(ne),{modelValue:n.value.requestMethod,"onUpdate:modelValue":t[8]||(t[8]=l=>n.value.requestMethod=l),placeholder:e(a)("ui.placeholder.select")},{default:r(()=>[(f(),L(me,null,ce(W,l=>s(e(ue),{key:l.value,label:l.label,value:l.value},null,8,["label","value"])),64))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1},8,["model","rules"])])],512),[[z,d.value.isEdit]]),A(i("div",ke,[i("div",Pe,[i("div",ye,o(e(a)("pluginItem.name"))+":",1),i("div",null,o(n.value.name),1)]),i("div",Oe,[i("div",Ie,o(e(a)("pluginItem.englishName"))+": ",1),i("div",null,o(n.value.englishName),1)]),i("div",Te,[i("div",Ce,o(e(a)("pluginItem.description"))+": ",1),i("div",null,o(n.value.description),1)]),i("div",Ve,[i("div",we,o(e(a)("pluginItem.pluginToolEdit.toolPath"))+": ",1),i("div",null,o(C.value.baseUrl)+o(n.value.basePath),1)]),i("div",qe,[i("div",Me,o(e(a)("pluginItem.pluginToolEdit.requestMethod"))+": ",1),i("div",null,o(n.value.requestMethod),1)])],512),[[z,!d.value.isEdit]])])],2)],2),i("div",{class:E(["accordion-item",{"accordion-item--active":m.value.isOpen}])},[i("div",{class:"accordion-header",onClick:t[12]||(t[12]=l=>w(2))},[i("div",Ne,[i("div",{class:E(["accordion-icon",{"accordion-icon--rotated":m.value.isOpen}])},[s(e(R),{size:"16"},{default:r(()=>[s(e(S))]),_:1})],2),i("h3",$e,o(m.value.title),1)]),i("div",null,[m.value.isEdit?h("",!0):(f(),_(e(g),{key:0,onClick:t[9]||(t[9]=b(l=>M(2),["stop"])),type:"primary"},{default:r(()=>[v(o(e(a)("button.edit")),1)]),_:1})),m.value.isEdit?(f(),_(e(g),{key:1,onClick:t[10]||(t[10]=b(l=>$(2),["stop"]))},{default:r(()=>[v(o(e(a)("button.cancel")),1)]),_:1})):h("",!0),m.value.isEdit?(f(),_(e(g),{key:2,onClick:t[11]||(t[11]=b(l=>N(2),["stop"])),type:"primary"},{default:r(()=>[v(o(e(a)("button.save")),1)]),_:1})):h("",!0)])]),i("div",{class:E(["accordion-content",{"accordion-content--open":m.value.isOpen}])},[i("div",Se,[s(G,{ref_key:"pluginInputParamsRef",ref:U,modelValue:y.value,"onUpdate:modelValue":t[13]||(t[13]=l=>y.value=l),editable:I.value,"is-edit-output":!1},null,8,["modelValue","editable"])])],2)],2),i("div",{class:E(["accordion-item",{"accordion-item--active":c.value.isOpen}])},[i("div",{class:"accordion-header",onClick:t[17]||(t[17]=l=>w(3))},[i("div",Re,[i("div",{class:E(["accordion-icon",{"accordion-icon--rotated":c.value.isOpen}])},[s(e(R),{size:"16"},{default:r(()=>[s(e(S))]),_:1})],2),i("h3",De,o(c.value.title),1)]),i("div",null,[c.value.isEdit?h("",!0):(f(),_(e(g),{key:0,onClick:t[14]||(t[14]=b(l=>M(3),["stop"])),type:"primary"},{default:r(()=>[v(o(e(a)("button.edit")),1)]),_:1})),c.value.isEdit?(f(),_(e(g),{key:1,onClick:t[15]||(t[15]=b(l=>$(3),["stop"]))},{default:r(()=>[v(o(e(a)("button.cancel")),1)]),_:1})):h("",!0),c.value.isEdit?(f(),_(e(g),{key:2,onClick:t[16]||(t[16]=b(l=>N(3),["stop"])),type:"primary"},{default:r(()=>[v(o(e(a)("button.save")),1)]),_:1})):h("",!0)])]),i("div",{class:E(["accordion-content",{"accordion-content--open":c.value.isOpen}])},[i("div",Ue,[s(G,{modelValue:O.value,"onUpdate:modelValue":t[18]||(t[18]=l=>O.value=l),ref_key:"pluginOutputParamsRef",ref:B,editable:V.value,"is-edit-output":!0},null,8,["modelValue","editable"])])],2)],2)]),s(se,{ref_key:"runTestRef",ref:J,"plugin-tool-id":P.value},null,8,["plugin-tool-id"])]))}}),Qt=le(Be,[["__scopeId","data-v-66a04bfe"]]);export{Qt as default};
