var m=(a,u,r)=>new Promise((l,c)=>{var p=t=>{try{s(r.next(t))}catch(n){c(n)}},d=t=>{try{s(r.throw(t))}catch(n){c(n)}},s=t=>t.done?l(t.value):Promise.resolve(t.value).then(p,d);s((r=r.apply(a,u)).next())});import{$ as g,R as E,M as w,_ as T}from"./bootstrap-Bf65uz2I.js";/* empty css                  *//* empty css               *//* empty css                     *//* empty css                  */import{E as $,a as k}from"./index-DcZY4wgD.js";import{k as V,c as O,r as v,w as L,o as q,B as b,n as h,u as y,a7 as M,E as B,q as A,y as F,m as I,F as N,N as P}from"../jse/index-index-D3Xb8oT_.js";const R={class:"dict-select__prefix"},U=V({__name:"DictSelect",props:{modelValue:{},dictCode:{},placeholder:{default:void 0},clearable:{type:Boolean,default:!0},filterable:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},multiple:{type:Boolean,default:!1},collapseTags:{type:Boolean,default:!1},collapseTagsTooltip:{type:Boolean,default:!1},showCode:{type:Boolean,default:!1},immediate:{type:Boolean,default:!0},extraOptions:{default:()=>[]}},emits:["update:modelValue","change","blur","dictLoaded"],setup(a,{expose:u,emit:r}){const l=a,c=r,p=O(()=>l.placeholder!==void 0?l.placeholder:g("dictSelect.placeholder")),d=v([]),s=v(!1),t=v(new Set),n=e=>{c("update:modelValue",e);const i=l.multiple&&Array.isArray(e)?e.map(o=>d.value.find(S=>S.value===o)).filter(Boolean):d.value.find(o=>o.value===e);c("change",e,i)},C=()=>{c("blur")},f=e=>m(null,null,function*(){if(!t.value.has(e)){s.value=!0;try{const i=yield x(e);d.value=[...l.extraOptions,...i],t.value.add(e),c("dictLoaded",i)}catch(i){console.error(`${g("dictSelect.getError")}: ${e}`,i),E.error(`${g("dictSelect.getError")}: ${e}`),d.value=[]}finally{s.value=!1}}}),x=e=>m(null,null,function*(){return(yield w.get(`/api/v1/dict/items/${e}`)).data}),D=()=>{l.dictCode&&f(l.dictCode)};return L(()=>l.dictCode,e=>{e&&f(e)}),q(()=>{l.immediate&&l.dictCode&&f(l.dictCode)}),u({reloadDict:D,getOptions:()=>d.value}),(e,i)=>(h(),b(y($),{"model-value":a.modelValue,"onUpdate:modelValue":n,onBlur:C,placeholder:p.value,clearable:a.clearable,filterable:a.filterable,disabled:a.disabled||s.value,loading:s.value,multiple:a.multiple,"collapse-tags":a.collapseTags,"collapse-tags-tooltip":a.collapseTagsTooltip},M({default:B(()=>[(h(!0),I(N,null,P(d.value,o=>(h(),b(y(k),{key:o.value,label:o.label,value:o.value,disabled:o.disabled},null,8,["label","value","disabled"]))),128))]),_:2},[a.showCode&&a.dictCode?{name:"prefix",fn:B(()=>[A("span",R,F(a.dictCode),1)]),key:"0"}:void 0]),1032,["model-value","placeholder","clearable","filterable","disabled","loading","multiple","collapse-tags","collapse-tags-tooltip"]))}}),X=T(U,[["__scopeId","data-v-07a5f960"]]);export{X as D};
