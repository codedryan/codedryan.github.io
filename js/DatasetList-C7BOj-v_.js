var M=Object.defineProperty;var h=Object.getOwnPropertySymbols;var F=Object.prototype.hasOwnProperty,Q=Object.prototype.propertyIsEnumerable;var b=(m,i,a)=>i in m?M(m,i,{enumerable:!0,configurable:!0,writable:!0,value:a}):m[i]=a,T=(m,i)=>{for(var a in i||(i={}))F.call(i,a)&&b(m,a,i[a]);if(h)for(var a of h(i))Q.call(i,a)&&b(m,a,i[a]);return m};import{$ as o,a8 as R,aJ as A,Y as J,aI as H,Z as U,M as C,R as _}from"./bootstrap-Bf65uz2I.js";import"./css-gf8D6QlL.js";import{E as j}from"./el-dialog-CAR1-R4U.js";import"./el-overlay-Zuw8glOl.js";import{E as z}from"./el-message-box-B8o3mhYx.js";import"./css-C9o_OfXA.js";import"./css-BA5xAVBz.js";import{d as O}from"./dataset-BwduqZ0C.js";import{D as P}from"./DictSelect-DdOvS-6R.js";import{H as W}from"./HeaderSearch-Dj9rqjlr.js";import{C as Y}from"./CardList-DOl2PmFc.js";import{_ as Z}from"./PageData.vue_vue_type_script_setup_true_lang-DfbAOXk_.js";import{u as G}from"./dict-CsbZy8Qf.js";import{_ as X}from"./DatasetModal.vue_vue_type_script_setup_true_lang-BPuQ__WY.js";import{ElButton as w}from"./index-oBOAcXl-.js";import{a as tt}from"./index-e0qsk5Ci.js";import{k as et,o as ot,r as d,S as at,W as it,m as st,n as rt,J as l,q as v,E as u,u as r,L as S,y as p}from"../jse/index-index-D3Xb8oT_.js";import"./index-B3qAv2kq.js";import"./aria-DEUWDJ1E.js";import"./refs-D6FW0B1r.js";import"./event-BB_Ol6Sd.js";import"./index-Bxb6QITi.js";import"./index-Dg3fRnQE.js";import"./vnode-DysYOGZN.js";import"./scroll-C2492Iw_.js";import"./index-BjDsryRX.js";import"./index-bT9OJj6t.js";import"./_overRest-Bb9G3v08.js";import"./index-C33Sf0pH.js";import"./use-form-item-DVWmmqeW.js";import"./use-form-common-props-IzjzSHax.js";import"./index-m1ZP1zbM.js";import"./validator-D2YZey62.js";/* empty css                  *//* empty css               *//* empty css                     *//* empty css                  */import"./index-DcZY4wgD.js";import"./index-CMBjNRIa.js";import"./index-CbSmxnRE.js";import"./util-B2mB0_6C.js";import"./index-DGdiZ7pE.js";import"./useProps-DNCnrLfW.js";import"./_baseFindIndex-D7XfJLKM.js";import"./_baseIteratee-rJjBrWyx.js";import"./strings-CGsg9AfI.js";import"./castArray-BBset58W.js";import"./clamp-CeuJyDnc.js";import"./toNumber-CvayJyp9.js";import"./index-pv0R11Cf.js";import"./el-dropdown-menu-v2KdT220.js";import"./hasPermission-CIdLHqw4.js";import"./el-avatar-BVPcm0Px.js";import"./el-card-DGd_zL6P.js";import"./css-CLrSDUNG.js";/* empty css                */import"./index-Bpv3aWiu.js";import"./index-Ce9mjW49.js";import"./el-empty-CDAlv280.js";import"./el-pagination-W2lJTIgw.js";/* empty css                */import"./el-form-item-8FQp7Cs4.js";import"./_baseClone-trfKWgGN.js";import"./UploadAvatar-a3x1lqjM.js";import"./el-image-viewer-DlaFkWIK.js";import"./debounce-AsHllEOy.js";import"./cloneDeep-Orislllf.js";const nt={class:"flex h-full flex-col gap-6 p-6"},lt={class:"mt-[-20px] text-[12px] text-[#75808D]"},mt={class:"mt-[10px] text-[12px] text-[#75808D]"},pt={class:"mb-[-15px] mt-[10px]"},be=et({__name:"DatasetList",setup(m){const i=[{icon:R,text:o("button.edit"),className:"",permission:"/api/v1/dataset/save",onClick:t=>{y(t)}},{icon:A,text:o("button.view"),className:"",permission:"",onClick:t=>{H.push({name:"QAList",query:{id:t.id}})}},{icon:J,text:o("button.delete"),className:"item-danger",permission:"/api/v1/dataset/remove",onClick:t=>{K(t)}},{icon:"merge",text:o("dataset.MergeIntoKnowledge"),className:"",permission:"/api/v1/dataset/save",onClick:t=>{E(t)}},{icon:"merge",text:o("dataset.ExportSFTTrainingFile"),className:"",permission:"/api/v1/dataset/save",onClick:t=>{L(t)}}];ot(()=>{$()});const a=d(),D=d(),V=G(),N=[{key:"create",text:o("dataset.CreateDataset"),icon:at(U),type:"primary",data:{action:"create"},permission:"/api/v1/dataset/save"}],c=d(null),f=d(!1),g=d(!1),k=d();function L(t){C.download("/api/v1/dataset/exportJsonl",{params:{id:t.id}}).then(e=>{it({fileName:`${t.name}.jsonl`,source:e})})}function $(){V.fetchDictionary("dataStatus")}const I=t=>{a.value.setQuery({name:t,isQueryOr:!0})};function x(t){t==null||t.resetFields(),a.value.setQuery({})}function y(t){D.value.openDialog(T({},t))}function K(t){z.confirm(o("message.deleteAlert"),o("message.noticeTitle"),{confirmButtonText:o("message.ok"),cancelButtonText:o("message.cancel"),type:"warning",beforeClose:(e,s,n)=>{e==="confirm"?(s.confirmButtonLoading=!0,C.post("/api/v1/dataset/remove",{id:t.id}).then(B=>{s.confirmButtonLoading=!1,B.errorCode===0&&(_.success(B.message),x(),n())}).catch(()=>{s.confirmButtonLoading=!1})):n()}}).catch(()=>{})}function q(){if(!c.value){_.error(o("message.selectKnowledge"));return}const t={dcId:c.value,datasetId:k.value};g.value=!0,C.get("/api/v1/dataset/saveToDocumentCollection",{params:t}).then(e=>{e.errorCode===0&&(_.success(e.message),x(),g.value=!1,f.value=!1)})}function E(t){k.value=t.id,c.value=null,f.value=!0}return(t,e)=>(rt(),st("div",nt,[l(r(j),{title:r(o)("dataset.MergeIntoKnowledge"),modelValue:f.value,"onUpdate:modelValue":e[3]||(e[3]=s=>f.value=s)},{footer:u(()=>[l(r(w),{onClick:e[1]||(e[1]=s=>f.value=!1)},{default:u(()=>[S(p(r(o)("button.cancel")),1)]),_:1}),l(r(w),{type:"primary",loading:g.value,onClick:e[2]||(e[2]=s=>q())},{default:u(()=>[S(p(r(o)("button.confirm")),1)]),_:1},8,["loading"])]),default:u(()=>[l(P,{modelValue:c.value,"onUpdate:modelValue":e[0]||(e[0]=s=>c.value=s),"dict-code":"aiDocumentCollection"},null,8,["modelValue"])]),_:1},8,["title","modelValue"]),l(X,{ref_key:"saveDialog",ref:D,onReload:x},null,512),l(W,{buttons:N,onSearch:I,onButtonClick:e[4]||(e[4]=s=>y({}))}),v("div",null,[l(Z,{ref_key:"pageDataRef",ref:a,"page-url":"/api/v1/dataset/page","page-size":10},{default:u(({pageList:s})=>[l(Y,{"title-field":"name","default-icon":r(O),data:s,actions:i},{extra:u(({row:n})=>[v("div",lt,p(r(o)("dataset.TotalQA"))+"："+p(n.qaCount),1),v("div",mt,p(r(o)("dataset.TotalAudits"))+"："+p(n.auditCount)+"/"+p(n.qaCount),1),v("div",pt,[l(r(tt),{percentage:n.qaCount===0?0:n.auditCount/n.qaCount*100,"show-text":!1},null,8,["percentage"])])]),_:1},8,["default-icon","data"])]),_:1},512)])]))}});export{be as default};
