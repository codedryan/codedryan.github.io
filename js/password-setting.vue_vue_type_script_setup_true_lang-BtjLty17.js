var d=(r,i,o)=>new Promise((n,u)=>{var a=t=>{try{c(o.next(t))}catch(l){u(l)}},s=t=>{try{c(o.throw(t))}catch(l){u(l)}},c=t=>t.done?n(t.value):Promise.resolve(t.value).then(a,s);c((o=o.apply(r,i)).next())});import{av as y,aw as h,$ as e,aF as b,M as _,R as A}from"./bootstrap-Bf65uz2I.js";import{k as f,G as x,c as g,m as v,n as P,J as p,u as m,E as S,L as F,y as k,r as w,B as I}from"../jse/index-index-D3Xb8oT_.js";const B={class:"mx-auto max-w-[360px] pt-12"},C=f({__name:"password-setting",props:{formSchema:{default:()=>[]},buttonText:{default:"更新密码"},buttonLoading:{type:Boolean,default:!1}},emits:["submit"],setup(r,{expose:i,emit:o}){const n=r,u=o,[a,s]=y(x({commonConfig:{componentProps:{class:"w-full"}},layout:"vertical",schema:g(()=>n.formSchema),showDefaultActions:!1}));function c(){return d(this,null,function*(){const{valid:t}=yield s.validate(),l=yield s.getValues();t&&u("submit",l)})}return i({getFormApi:()=>s}),(t,l)=>(P(),v("div",B,[p(m(a)),p(m(h),{loading:r.buttonLoading,type:"submit",class:"mx-auto mt-4 block h-8 w-[106px] p-0",onClick:c},{default:S(()=>[F(k(r.buttonText),1)]),_:1},8,["loading"])]))}}),T=f({__name:"password-setting",setup(r){const i=w(),o=g(()=>[{fieldName:"password",label:e("sysAccount.oldPwd"),component:"AIFlowyInputPassword",componentProps:{placeholder:e("sysAccount.oldPwd")+e("common.isRequired")}},{fieldName:"newPassword",label:e("sysAccount.newPwd"),component:"AIFlowyInputPassword",componentProps:{passwordStrength:!0,placeholder:e("sysAccount.newPwd")+e("common.isRequired")}},{fieldName:"confirmPassword",label:e("sysAccount.confirmPwd"),component:"AIFlowyInputPassword",componentProps:{passwordStrength:!0,placeholder:e("sysAccount.repeatPwd")},dependencies:{rules(a){const{newPassword:s}=a;return b({required_error:e("sysAccount.repeatPwd")}).min(1,{message:e("sysAccount.repeatPwd")}).refine(c=>c===s,{message:e("sysAccount.notSamePwd")})},triggerFields:["newPassword"]}}]),n=w(!1);function u(a){n.value=!0,_.post("/api/v1/sysAccount/updatePassword",a).then(s=>{n.value=!1,s.errorCode===0&&A.success(e("message.success"))})}return(a,s)=>(P(),I(m(C),{"button-loading":n.value,"button-text":m(e)("button.update"),ref_key:"profilePasswordSettingRef",ref:i,class:"w-1/3","form-schema":o.value,onSubmit:u},null,8,["button-loading","button-text","form-schema"]))}});export{T as _};
