var Z=Object.defineProperty;var M=Object.getOwnPropertySymbols;var j=Object.prototype.hasOwnProperty,G=Object.prototype.propertyIsEnumerable;var T=(n,l,a)=>l in n?Z(n,l,{enumerable:!0,configurable:!0,writable:!0,value:a}):n[l]=a,$=(n,l)=>{for(var a in l||(l={}))j.call(l,a)&&T(n,a,l[a]);if(M)for(var a of M(l))G.call(l,a)&&T(n,a,l[a]);return n};var S=(n,l,a)=>new Promise((_,d)=>{var g=s=>{try{v(a.next(s))}catch(y){d(y)}},b=s=>{try{v(a.throw(s))}catch(y){d(y)}},v=s=>s.done?_(s.value):Promise.resolve(s.value).then(g,b);v((a=a.apply(n,l)).next())});import{a9 as X,$ as t,a8 as I,bU as ee,bV as oe,Y as K,M as k,R as N,Z as U,Q as te,_ as ae}from"./bootstrap-Bf65uz2I.js";import"./css-gf8D6QlL.js";import{E as re}from"./el-dialog-CAR1-R4U.js";import"./el-overlay-Zuw8glOl.js";/* empty css                */import{E as le,a as ie}from"./el-form-item-8FQp7Cs4.js";import"./css-C9o_OfXA.js";import"./css-B4xXAc0m.js";import{E as F}from"./el-message-box-B8o3mhYx.js";import{d as ne}from"./book-c2nb1mZV.js";import{H as se}from"./HeaderSearch-Dj9rqjlr.js";import{C as me}from"./CardList-DOl2PmFc.js";import{_ as ce}from"./PageData.vue_vue_type_script_setup_true_lang-DfbAOXk_.js";import{P as pe}from"./PageSide-wLZhy9Oh.js";import{_ as ue}from"./DocumentCollectionModal.vue_vue_type_script_setup_true_lang-C7sNB5kW.js";import{ElInput as de}from"./index-BjDsryRX.js";import{ElInputNumber as fe}from"./index-9UPoHQm1.js";import{ElButton as Q}from"./index-oBOAcXl-.js";import{k as ge,r as u,o as ve,c as ye,m as W,n as h,q as V,J as p,E as f,u as i,F as Ce,N as he,B as E,p as ke,L as z,y as A}from"../jse/index-index-D3Xb8oT_.js";import"./index-B3qAv2kq.js";import"./aria-DEUWDJ1E.js";import"./refs-D6FW0B1r.js";import"./event-BB_Ol6Sd.js";import"./index-Bxb6QITi.js";import"./index-Dg3fRnQE.js";import"./vnode-DysYOGZN.js";import"./scroll-C2492Iw_.js";import"./use-form-common-props-IzjzSHax.js";import"./castArray-BBset58W.js";import"./_baseClone-trfKWgGN.js";import"./validator-D2YZey62.js";import"./el-dropdown-menu-v2KdT220.js";import"./index-CMBjNRIa.js";import"./index-bT9OJj6t.js";import"./_overRest-Bb9G3v08.js";import"./index-CbSmxnRE.js";import"./util-B2mB0_6C.js";/* empty css                  *//* empty css                     */import"./hasPermission-CIdLHqw4.js";import"./el-avatar-BVPcm0Px.js";import"./el-card-DGd_zL6P.js";import"./css-CLrSDUNG.js";/* empty css                */import"./index-Bpv3aWiu.js";import"./index-Ce9mjW49.js";import"./el-empty-CDAlv280.js";import"./el-pagination-W2lJTIgw.js";import"./index-DcZY4wgD.js";import"./index-DGdiZ7pE.js";import"./useProps-DNCnrLfW.js";import"./_baseFindIndex-D7XfJLKM.js";import"./_baseIteratee-rJjBrWyx.js";import"./strings-CGsg9AfI.js";import"./use-form-item-DVWmmqeW.js";import"./index-m1ZP1zbM.js";import"./clamp-CeuJyDnc.js";import"./toNumber-CvayJyp9.js";import"./index-pv0R11Cf.js";/* empty css               *//* empty css                  */import"./css-DCrZaNHy.js";/* empty css                   */import"./DictSelect-DdOvS-6R.js";import"./UploadAvatar-a3x1lqjM.js";import"./el-image-viewer-DlaFkWIK.js";import"./debounce-AsHllEOy.js";import"./index-C33Sf0pH.js";import"./css-BA5xAVBz.js";import"./index-e0qsk5Ci.js";import"./cloneDeep-Orislllf.js";import"./index-CHf9SThW.js";import"./index-BKzCwxYe.js";const _e={class:"flex h-full flex-col gap-6 p-6"},be={class:"knowledge-header"},xe={class:"flex max-h-[calc(100vh-191px)] flex-1 gap-6"},we={class:"h-full flex-1 overflow-auto"},Be=ge({__name:"DocumentCollection",setup(n){const l=X(),a=[{icon:I,text:t("button.edit"),className:"",permission:"/api/v1/documentCollection/save",onClick(e){g.value.openDialog(e)}},{icon:ee,text:t("documentCollection.actions.knowledge"),className:"",permission:"/api/v1/documentCollection/save",onClick(e){l.push({path:"/ai/documentCollection/document",query:{id:e.id,pageKey:"/ai/documentCollection"}})}},{icon:oe,text:t("documentCollection.actions.retrieve"),className:"",permission:"",onClick(e){l.push({path:"/ai/documentCollection/document",query:{id:e.id,pageKey:"/ai/documentCollection",activeMenu:"knowledgeSearch"}})}},{text:t("button.delete"),icon:K,className:"item-danger",permission:"/api/v1/documentCollection/remove",onClick(e){_(e)}}];ve(()=>{w()});const _=e=>{F.confirm(t("message.deleteAlert"),t("message.noticeTitle"),{confirmButtonText:t("message.ok"),cancelButtonText:t("message.cancel"),type:"warning"}).then(()=>{k.post("/api/v1/documentCollection/remove",{id:e.id}).then(r=>{r.errorCode===0&&(N.success(t("message.deleteOkMessage")),d.value.setQuery({}))})}).catch(()=>{})},d=u(),g=u(),b=[{key:"add",text:t("documentCollection.actions.addKnowledge"),icon:U,type:"primary",data:{action:"add"},permission:"/api/v1/documentCollection/save"}],v=(e,r)=>{switch(e.key){case"add":{g.value.openDialog({});break}}},s=u([{prop:"categoryName",label:t("aiWorkflowCategory.categoryName"),type:"input",required:!0,placeholder:t("aiWorkflowCategory.categoryName")},{prop:"sortNo",label:t("aiWorkflowCategory.sortNo"),type:"number",required:!1,placeholder:t("aiWorkflowCategory.sortNo")}]),y=ye(()=>{const e={};return s.value.forEach(r=>{const o=[];r.required&&o.push({required:!0,message:`${t("message.required")}`,trigger:"blur"}),o.length>0&&(e[r.prop]=o)}),e}),D=e=>{d.value.setQuery({title:e,isQueryOr:!0})},m=u({}),C=u(!1),x=u();function R(e){var r;(r=x.value)==null||r.resetFields(),m.value=$({},e),C.value=!0}const q=u([]),w=()=>S(null,null,function*(){const[,e]=yield te(k.get)("/api/v1/documentCollectionCategory/list",{params:{sortKey:"sortNo",sortType:"asc"}});e&&e.errorCode===0&&(q.value=[{id:"",categoryName:t("common.allCategories")},...e.data])});function H(e){F.confirm(t("message.deleteAlert"),t("message.noticeTitle"),{confirmButtonText:t("message.ok"),cancelButtonText:t("message.cancel"),type:"warning",beforeClose:(r,o,c)=>{r==="confirm"?(o.confirmButtonLoading=!0,k.post("/api/v1/documentCollectionCategory/remove",{id:e.id}).then(L=>{o.confirmButtonLoading=!1,L.errorCode===0&&(N.success(L.message),c(),w())}).catch(()=>{o.confirmButtonLoading=!1})):c()}}).catch(()=>{})}const O=[{icon:I,label:t("button.edit"),onClick(e){R(e)}},{type:"danger",icon:K,label:t("button.delete"),onClick(e){H(e)}}],P={icon:U,label:t("button.add"),onClick(){R({})}},B=u(!1);function J(){var e;(e=x.value)==null||e.validate(r=>{if(r){B.value=!0;const o=m.value.id?"/api/v1/documentCollectionCategory/update":"/api/v1/documentCollectionCategory/save";k.post(o,m.value).then(c=>{B.value=!1,c.errorCode===0&&(w(),N.success(c.message),C.value=!1)})}})}function Y(e){d.value.setQuery({categoryId:e.id})}return(e,r)=>(h(),W("div",_e,[V("div",be,[p(se,{buttons:b,onSearch:D,onButtonClick:v})]),V("div",xe,[p(pe,{"label-key":"categoryName","value-key":"id",menus:q.value,"control-btns":O,"footer-button":P,onChange:Y},null,8,["menus"]),V("div",we,[p(ce,{ref_key:"pageDataRef",ref:d,"page-url":"/api/v1/documentCollection/page","page-size":12,"page-sizes":[12,24,36,48],"init-query-params":{status:1}},{default:f(({pageList:o})=>[p(me,{"default-icon":i(ne),"title-key":"title","avatar-key":"icon","description-key":"description",data:o,actions:a},null,8,["default-icon","data"])]),_:1},512)])]),p(i(re),{modelValue:C.value,"onUpdate:modelValue":r[1]||(r[1]=o=>C.value=o),title:m.value.id?`${i(t)("button.edit")}`:`${i(t)("button.add")}`,"close-on-click-modal":!1},{footer:f(()=>[p(i(Q),{onClick:r[0]||(r[0]=o=>C.value=!1)},{default:f(()=>[z(A(i(t)("button.cancel")),1)]),_:1}),p(i(Q),{type:"primary",onClick:J,loading:B.value},{default:f(()=>[z(A(i(t)("button.confirm")),1)]),_:1},8,["loading"])]),default:f(()=>[p(i(le),{ref_key:"formRef",ref:x,model:m.value,rules:y.value,"label-width":"120px"},{default:f(()=>[(h(!0),W(Ce,null,he(s.value,o=>(h(),E(i(ie),{key:o.prop,label:o.label,prop:o.prop},{default:f(()=>[!o.type||o.type==="input"?(h(),E(i(de),{key:0,modelValue:m.value[o.prop],"onUpdate:modelValue":c=>m.value[o.prop]=c,placeholder:o.placeholder},null,8,["modelValue","onUpdate:modelValue","placeholder"])):o.type==="number"?(h(),E(i(fe),{key:1,modelValue:m.value[o.prop],"onUpdate:modelValue":c=>m.value[o.prop]=c,placeholder:o.placeholder,style:{width:"100%"}},null,8,["modelValue","onUpdate:modelValue","placeholder"])):ke("",!0)]),_:2},1032,["label","prop"]))),128))]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"]),p(ue,{ref_key:"aiKnowledgeModalRef",ref:g,onReload:D},null,512)]))}}),Po=ae(Be,[["__scopeId","data-v-9cc246b8"]]);export{Po as default};
